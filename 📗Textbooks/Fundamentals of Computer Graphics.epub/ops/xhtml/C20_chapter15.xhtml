<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" xmlns:m="http://www.w3.org/1998/Math/MathML" xmlns:svg="http://www.w3.org/2000/svg" dir="ltr" lang="en" xml:lang="en">
<head>
<meta charset="UTF-8"/>
<title>15 Curves</title>
<link href="../styles/9781000426359.css" rel="stylesheet" type="text/css"/>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
jax: ["input/TeX","input/MathML","output/SVG"],
extensions: ["tex2jax.js","mml2jax.js","MathEvents.js"],
TeX: {
extensions: ["noErrors.js","noUndefined.js","autoload-all.js"]
},
MathMenu: {
showRenderer: false
},
menuSettings: {
zoom: "Click"
},
messageStyle: "none"
});
</script>
<script src="../mathjax/MathJax.js" type="text/javascript"/>
<meta content="urn:uuid:e0000000-0000-0000-0000-000006665500" name="Adept.expected.resource"/>
</head>
<body epub:type="bodymatter">
<section epub:type="chapter" role="doc-chapter">
<header>
<p class="chap-auz"><span class="green">Michael Gleicher</span></p>
<h1 class="chapz1" id="c15"><a id="term-807"/><span aria-label="383" epub:type="pagebreak" id="pg_383" role="doc-pagebreak"/><a epub:type="backlink" href="C02a_toc.xhtml#rc15" role="doc-backlink"><span class="green"><span class="big1">15</span><br/>Curves</span></a></h1>
</header>
<section>
<h2 id="sec15_1"><a epub:type="backlink" href="C02a_toc.xhtml#rsec15_1" role="doc-backlink"><span class="green">15.1 Curves</span></a></h2>
<p>Intuitively, think of a <em>curve</em> as something you can draw with a pen. The curve is the set of points that the pen traces over an interval of time. While we usually think of a pen writing on paper (e.g., a curve that is in a 2D space), the pen could move in 3D to generate a <em><a id="index_term1101"/>space curve</em>, or you could imagine the pen moving in some other kind of space.</p>
<p>Mathematically, definitions of curve can be seen in at least two ways:</p>
<ol class="list-order">
<li>
<p class="list">the continuous image of some interval in an <em>n</em>-dimensional space;</p>
</li>
<li>
<p class="list">a continuous map from a one-dimensional space to an <em>n</em>-dimensional space.</p>
</li>
</ol>
<p>Both of these definitions start with the idea of an interval range (the time over which the pen traces the curve). However, there is a significant difference: in the first definition, the curve is the set of points the pen traces (the image), while in the second definition, the curve is the mapping between time and that set of points. For this chapter, we use the first definition.</p>
<p>A curve is an infinitely large set of points. The points in a curve have the property that any point has two neighbors, except for a small number of points that have one neighbor (these are the endpoints). Some curves have no endpoints, either because they are infinite (like a line) or they are <em>closed</em> (loop around and connect to themselves).</p>
<p><a id="term-250"/><a id="term-253"/><a id="term-298"/><a id="term-335"/><a id="term-419"/><a id="term-641"/><span aria-label="384" epub:type="pagebreak" id="pg_384" role="doc-pagebreak"/>Because the “pen” of the curve is thin (infinitesimally), it is difficult to create filled regions. While space-filling curves are possible (by having them fold over themselves infinitely many times), we do not consider such mathematical oddities here. Generally, we think of curves as the outlines of things, not the “insides.”</p>
<p>The problem that we need to address is how to specify a curve–to give a name or representation to a curve so that we can represent it on a computer. For some curves, the problem of naming them is easy since they have known shapes: line segments, circles, elliptical arcs, etc. A general curve that does not have a “named” shape is sometimes called a <em>free-form</em> curve. Because a <a id="index_term381"/>free-form curve can take on just about any shape, they are much harder to specify.</p>
<p>There are three main ways to specify curves mathematically:</p>
<ol class="list-order">
<li>
<p class="list"><strong><span class="green">Implicit</span></strong> curve representations define the set of points on a curve by giving a procedure that can test to see if a point in on the curve. Usually, an <a id="index_term568"/>implicit curve representation is defined by an <em>implicit function</em> of the form</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mi mathvariant="italic">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">x</m:mi><m:mi mathvariant="normal">,</m:mi><m:mi mathvariant="normal"/><m:mi mathvariant="italic">y</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal">0</m:mi><m:mi mathvariant="normal">,</m:mi></m:mrow></m:math>
</div>
<p>so that the curve is the set of points for which this equation is true. Note that the implicit function <em>f</em> is a scalar function (it returns a single real number).</p>
</li>
<li>
<p class="list"><strong><span class="green">Parametric</span></strong> curve representations provide a mapping from a <em>free parameter</em> to the set of points on the curve. That is, this free parameter provides an index to the points on the curve. The parametric form of a curve is a function that assigns positions to values of the free parameter. Intuitively, if you think of a curve as something you can draw with a pen on a piece of paper, the free parameter is time, ranging over the interval from the time that we began drawing the curve to the time that we finish. The <em>parametric function</em>of this curve tells us where the pen is at any instant in time:</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">x</m:mi><m:mi mathvariant="normal">,</m:mi><m:mi mathvariant="normal"/><m:mi mathvariant="italic">y</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">t</m:mi><m:mi mathvariant="normal">)</m:mi><m:mn>.</m:mn></m:mrow></m:math>
</div>
<p>Note that the parametric function is a vector-valued function. This example is a 2D curve, so the output of the function is a 2-vector; in 3D it would be a 3-vector.</p>
</li>
<li>
<p class="list"><strong><span class="green">Generative or procedural</span></strong> curve representations provide procedures that can generate the points on the curve that do not fall into the first two categories. Examples of <a id="index_term432"/>generative curve descriptions include subdivision schemes and fractals.</p>
</li>
</ol>
<p>Remember that a curve is a set of points. These representations give us ways to specify those sets. Any curve has many possible representations. For this <span aria-label="385" epub:type="pagebreak" id="pg_385" role="doc-pagebreak"/>reason, mathematicians typically are careful to distinguish between a curve and its representations. In computer graphics we are often sloppy, since we usually only refer to the representation, not the actual curve itself. So when someone says “an implicit curve,” they are either referring to the curve that is represented by some implicit function or to the implicit function that is one of the representations of some curve. Such distinctions are not usually important, unless we need to consider different representations of the same curve. We will consider different curve representations in this chapter, so we will be more careful. When we use a term like “polynomial curve,” we will mean the curve that can be represented by the polynomial.</p>
<p>By the definition given at the beginning of this chapter, for something to be a curve it must have a parametric representation. However, many curves have other representations. For example, a circle in 2D with its center at the origin and radius equal to 1 can be written in implicit form as</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mi mathvariant="italic">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">x</m:mi><m:mi mathvariant="normal">,</m:mi><m:mi mathvariant="normal"/><m:mi mathvariant="italic">y</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:msup><m:mrow><m:mi mathvariant="italic">x</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:mi mathvariant="normal">+</m:mi><m:msup><m:mrow><m:mi mathvariant="italic">y</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:mo>−</m:mo><m:mi mathvariant="normal">1</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal">0</m:mi><m:mi mathvariant="normal">,</m:mi></m:mrow></m:math>
</div>
<p>or in parametric form as</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">x</m:mi><m:mi mathvariant="normal">,</m:mi><m:mi mathvariant="normal"/><m:mi mathvariant="italic">y</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">t</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">cos</m:mi><m:mi mathvariant="italic">t</m:mi><m:mi mathvariant="normal">,</m:mi><m:mi mathvariant="normal"/><m:mi mathvariant="normal">sin</m:mi><m:mi mathvariant="italic">t</m:mi><m:mi mathvariant="normal">)</m:mi><m:mi mathvariant="normal"/><m:mi mathvariant="normal">,</m:mi><m:mi mathvariant="normal"/><m:mi mathvariant="italic">t</m:mi><m:mo>∈</m:mo><m:mi mathvariant="normal">[</m:mi><m:mi mathvariant="normal">0</m:mi><m:mi mathvariant="normal">,</m:mi><m:mi mathvariant="normal">2</m:mi><m:mi>π</m:mi><m:mi mathvariant="normal">)</m:mi><m:mn>.</m:mn></m:mrow></m:math>
</div>
<p>The parametric form need not be the most convenient representation for a given curve. In fact, it is possible to have curves with simple implicit or generative representations for which it is difficult to find a parametric representation.</p>
<p>Different representations of curves have advantages and disadvantages. For example, <a id="index_term825"/><a id="index_term301"/>parametric curves are much easier to draw, because we can sample the free parameter. Generally, parametric forms are the most commonly used in computer graphics since they are easier to work with. Our focus will be on parametric representations of curves.</p>
<section>
<h3 id="sec15_1_1"><a id="index_term822"/><a id="index_term989"/><span class="green">15.1.1 Parameterizations and Reparameterizations</span></h3>
<p>A <em>parametric curve</em> refers to the curve that is given by a specific parametric function over some particular interval. To be more precise, a parametric curve has a given function that is a mapping from an interval of the parameters. It is often convenient to have the parameter run over the unit interval from 0 to 1. When the free parameter varies over the unit interval, we often denote the parameter as <em>u</em>.</p>
<p>If we view the parametric curve to be a line drawn with a pen, we can consider <em>u</em> = 0 as the time when the pen is first set down on the paper and the unit of time to be the amount of time it takes to draw the curve (<em>u</em> = 1 is the end of the curve).</p>
<p><span aria-label="386" epub:type="pagebreak" id="pg_386" role="doc-pagebreak"/>The curve can be specified by a function that maps time (in these unit coordinates) to positions. Basically, the specification of the curve is a function that can answer the question, “Where is the pen at time <em>u</em>?”</p>
<p>If we are given a function <strong>f</strong>(<em>t</em>) that specifies a curve over interval [<em>a, b</em>],we can easily define a new function <strong>f</strong><sub>2</sub>(<em>u</em>) that specifies the same curve over the unit interval. We can first define</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mi mathvariant="italic">g</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mi mathvariant="italic">a</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">b</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">a</m:mi><m:mi mathvariant="normal">)</m:mi><m:mi mathvariant="italic">u</m:mi><m:mo>,</m:mo></m:mrow></m:math>
</div>
<p>and then</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:msub><m:mrow><m:mi mathvariant="normal">f</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">g</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mi mathvariant="normal">)</m:mi><m:mn>.</m:mn></m:mrow></m:math>
</div>
<p>The two functions, <strong>f</strong> and <strong>f</strong><sub>2</sub> both represent the same curve; however, they provide different <em>parameterizations</em> of the curve. The process of creating a new parameterization for an existing curve is called <em>reparameterization</em>, and the mapping from old parameters to the new ones (<em>g</em>, in this example) is called the <em>reparameterization function.</em></p>
<p>If we have defined a curve by some parameterization, infinitely many others exist (because we can always reparameterize). Being able to have multiple parameterizations of a curve is useful, because it allows us to create parameterizations that are convenient. However, it can also be problematic, because it makes it difficult to compare two functions to see if they represent the same curve.</p>
<p>The essence of this problem is more general: the existence of the free parameter (or the element of time) adds an invisible, potentially unknown element to our representation of the curves. When we look at the curve after it is drawn, we don’t necessarily know the timing. The pen might have moved at a constant speed over the entire time interval, or it might have started slowly and sped up. For example, while <em>u</em> = 0.5 is halfway through the parameter space, it may not be halfway along the curve if the motion of the pen starts slowly and speeds up at the end. Consider the following representations of a very simple curve:</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mtable><m:mtr><m:mtd><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>,</m:mo><m:mi>y</m:mi><m:mo>)</m:mo></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo><m:mtext>f</m:mtext><m:mrow><m:mo>(</m:mo><m:mi>u</m:mi><m:mo>)</m:mo><m:mo>=</m:mo></m:mrow></m:mtd><m:mtd><m:mrow><m:mo>(</m:mo><m:mi>u</m:mi><m:mo>,</m:mo><m:mi>u</m:mi><m:mo>)</m:mo><m:mo>,</m:mo></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>,</m:mo><m:mi>y</m:mi><m:mo>)</m:mo></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo><m:mtext>f</m:mtext><m:mrow><m:mo>(</m:mo><m:mi>u</m:mi><m:mo>)</m:mo><m:mo>=</m:mo></m:mrow></m:mtd><m:mtd><m:mrow><m:mo>(</m:mo><m:msup><m:mrow><m:mi>u</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>,</m:mo><m:msup><m:mrow><m:mi>u</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>)</m:mo><m:mo>,</m:mo></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>,</m:mo><m:mi>y</m:mi><m:mo>)</m:mo></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo><m:mtext>f</m:mtext><m:mrow><m:mo>(</m:mo><m:mi>u</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo></m:mtd><m:mtd><m:mrow><m:mo>(</m:mo><m:msup><m:mrow><m:mi>u</m:mi></m:mrow><m:mrow><m:mn>5</m:mn></m:mrow></m:msup><m:mo>,</m:mo><m:msup><m:mrow><m:mi>u</m:mi></m:mrow><m:mrow><m:mn>5</m:mn></m:mrow></m:msup><m:mo>)</m:mo><m:mn>.</m:mn></m:mrow></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>All three functions represent the same curve on the unit interval; however when <em>u</em> is not 0 or 1, <strong>f</strong>(<em>u</em>) refers to a different point depending on the representation of the curve.</p>
<p>If we are given a parameterization of a curve, we can use it directly as our specification of the curve, or we can develop a more convenient parameterization.</p>
<p>Usually, the <em>natural parameterization</em> is created in a way that is convenient (or <span aria-label="387" epub:type="pagebreak" id="pg_387" role="doc-pagebreak"/>natural) for specifying the curve, so we don’t have to know about how the speed changes along the curve.</p>
<p>If we know that the pen moves at a constant velocity, then the values of the free parameters have more meaning. Halfway through parameter space is halfway along the curve. Rather than measuring time, the parameter can be thought to measure length along the curve. Such parameterizations are called <em>arc-length</em>parameterizations because they define curves by functions that map from the distance along the curve (known as the arc length) to positions. We often use the variable <em>s</em> to denote an arc-length parameter.</p>
<p>Technically, a parameterization is an arc-length parameterization if the magnitude of its <em>tangent</em> (that is, the derivative of the parameterization with respect to the parameter) has constant magnitude. Expressed as an equation,</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:msup><m:mrow><m:mrow><m:mo>|</m:mo><m:mfrac><m:mrow><m:mi mathvariant="italic">d</m:mi><m:mi mathvariant="normal">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">s</m:mi><m:mi mathvariant="normal">)</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">d</m:mi><m:mi mathvariant="italic">s</m:mi></m:mrow></m:mfrac><m:mo>|</m:mo></m:mrow></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:mo>=</m:mo><m:mi mathvariant="italic">c</m:mi><m:mi mathvariant="normal">.</m:mi></m:mrow></m:math>
</div>
<p>Computing the length along a curve can be tricky. In general, it is defined by the integral of the magnitude of the derivative (intuitively, the magnitude of the derivative is the velocity of the pen as it moves along the curve). So, given a value for the parameter <em>v</em>, you can compute <em>s</em> (the arc-length distance along the curve from the point <strong>f</strong>(0) to the point <strong>f</strong>(<em>v</em>))as</p>
<div class="disp-formula" id="equ15_1">
<m:math display="block"><m:mrow><m:mi mathvariant="italic">s</m:mi><m:mo>=</m:mo><m:msubsup><m:mrow><m:mstyle displaystyle="true" mathvariant="normal"><m:mi>∫</m:mi></m:mstyle></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">v</m:mi></m:mrow></m:msubsup><m:msup><m:mrow><m:mrow><m:mo>|</m:mo><m:mfrac><m:mrow><m:mi mathvariant="italic">d</m:mi><m:mi mathvariant="normal">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">t</m:mi><m:mi mathvariant="normal">)</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">d</m:mi><m:mi mathvariant="italic">t</m:mi></m:mrow></m:mfrac><m:mo>|</m:mo></m:mrow></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:mi mathvariant="italic">d</m:mi><m:mi mathvariant="italic">t</m:mi><m:mo>,</m:mo></m:mrow><m:mspace width="3em"/><m:mo>(15.1)</m:mo></m:math>
</div>
<p>where <strong>f</strong>(<em>t</em>) is a function that defines the curve with a natural parameterization.</p>
<p>Using the arc-length parameterization requires being able to solve Equation (15.1) for <em>t</em>,given <em>s</em>. For many of the kinds of curves we examine, it cannot be done in a closed-form (simple) manner and must be done numerically.</p>
<p>Generally, we use the variable <em>u</em> to denote free parameters that range over the unit interval, <em>s</em> to denote arc-length free parameters, and <em>t</em> to represent parameters that aren’t one of the other two.</p>
</section>
<section>
<h3 id="sec15_1_2"><a id="index_term864"/><span class="green">15.1.2 Piecewise Parametric Representations</span></h3>
<p>For some curves, defining a parametric function that represents their shape is easy. For example, lines, circles, and ellipses all have simple functions that define the points they contain in terms of a parameter. For many curves, finding a function that specifies their shape can be hard. The main strategy that we use to create complex curves is divide-and-conquer: we break the curve into a number of simpler smaller pieces, each of which has a simple description.</p>
<p><a id="term-249"/><a id="term-585"/><a id="term-586"/><span aria-label="388" epub:type="pagebreak" id="pg_388" role="doc-pagebreak"/>For example, consider the curves in <a href="C20_chapter15.xhtml#f15_1">Figure 15.1</a>. The first two curves are easily specified in terms of two pieces. In the case of the curve in <a href="C20_chapter15.xhtml#f15_1">Figure 15.1(b)</a>, we need two different kinds of pieces: a line segment and a circle.</p>
<figure id="f15_1" tabindex="0">
<img alt="" src="../images/fig15_1.jpg"/>
<figcaption><p><span class="blue">Figure 15.1.</span> (a) A curve that can be easily represented as two lines; (b) a curve that can be easily represented as a line and a circular arc; (c) a curve approximating curve (b) with five line segments.</p></figcaption>
</figure>
<p>To create a parametric representation of a compound curve (like the curve in <a href="C20_chapter15.xhtml#f15_1">Figure 15.1(b)</a>), we need to have our parametric function switch between the functions that represent the pieces. If we define our parametric functions over the range 0 ≤ <em>u</em> ≤ 1, then the curve in <a href="C20_chapter15.xhtml#f15_1">Figures 15.1(a)</a> or <a href="C20_chapter15.xhtml#f15_1">(b)</a> might be defined as</p>
<div class="disp-formula" id="equ15_2">
<m:math display="block"><m:mrow><m:mi mathvariant="normal">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mrow><m:mo>{</m:mo><m:mtable><m:mtr><m:mtd columnalign="left"><m:msub><m:mrow><m:mi mathvariant="normal">f</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">2</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi></m:mtd><m:mtd><m:mi mathvariant="normal">i</m:mi><m:mi mathvariant="normal">f</m:mi><m:mi mathvariant="normal"/><m:mi mathvariant="italic">u</m:mi><m:mo>≤</m:mo><m:mi mathvariant="normal">0</m:mi><m:mi mathvariant="normal">.</m:mi><m:mi mathvariant="normal">5</m:mi><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd columnalign="left"><m:msub><m:mrow><m:mi mathvariant="normal">f</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">2</m:mi><m:mi mathvariant="italic">u</m:mi><m:mo>−</m:mo><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal">)</m:mi></m:mtd><m:mtd><m:mi mathvariant="normal">i</m:mi><m:mi mathvariant="normal">f</m:mi><m:mi mathvariant="normal"/><m:mi mathvariant="italic">u</m:mi><m:mo>&gt;</m:mo><m:mi mathvariant="normal">0</m:mi><m:mi mathvariant="normal">.</m:mi><m:mi mathvariant="normal">5</m:mi><m:mo>,</m:mo></m:mtd></m:mtr></m:mtable></m:mrow></m:mrow><m:mspace width="3em"/><m:mo>(15.2)</m:mo></m:math>
</div>
<p>where <strong>f</strong><sub>1</sub> is a parameterization of the first piece, <strong>f</strong><sub>2</sub> is a parameterization of the second piece, and both of these functions are defined over the unit interval.</p>
<p>We need to be careful in defining the functions <strong>f</strong><sub>1</sub> and <strong>f</strong><sub>2</sub> to make sure that the pieces of the curve fit together. If<strong>f</strong><sub>1</sub>(1) ≠ <strong>f</strong><sub>2</sub>(0)<em>,</em> then our curve pieces will not connect and will not form a single continuous curve.</p>
<p>To represent the curve in <a href="C20_chapter15.xhtml#f15_1">Figure 15.1(b)</a>, we needed to use two different types of pieces: a line segment and a circular arc. For simplicity’s sake, we may prefer to use a single type of piece. If we try to represent the curve in <a href="C20_chapter15.xhtml#f15_1">Figure 15.1(b)</a> with only one type of piece (line segments), we cannot exactly re-create the curve (unless we use an infinite number of pieces). While the new curve made of line segments (as in <a href="C20_chapter15.xhtml#f15_1">Figure 15.1(c)</a>) may not be exactly the same shape as in <a href="C20_chapter15.xhtml#f15_1">Figure 15.1(b)</a>, it might be close enough for our use. In such a case, we might prefer the simplicity of using the simpler line segment pieces to having a curve that more accurately represents the shape.</p>
<p>Also, notice that as we use an increasing number of pieces, we can get a better approximation. In the limit (using an infinite number of pieces), we can exactly represent the original shape.</p>
<p><span aria-label="389" epub:type="pagebreak" id="pg_389" role="doc-pagebreak"/>One advantage to using a piecewise representation is that it allows us to make a tradeoff between</p>
<ol class="list-order">
<li>
<p class="list">how well our represented curve approximates the real shape we are trying to represent;</p>
</li>
<li>
<p class="list">how complicated the pieces that we use are;</p>
</li>
<li>
<p class="list">how many pieces we use.</p>
</li>
</ol>
<p>So, if we are trying to represent a complicated shape, we might decide that a crude approximation is acceptable and use a small number of simple pieces. To improve the approximation, we can choose between using more pieces and using more complicated pieces.</p>
<p>In computer graphics practice, we tend to prefer using relatively simple curve pieces (either line segments, arcs, or polynomial segments).</p>
</section>
<section>
<h3 id="sec15_1_3"><span class="green">15.1.3 Splines</span></h3>
<p>Before computers, when draftsmen wanted to draw a smooth curve, one tool they employed was a stiff piece of metal that they would bend into the desired shape for tracing. Because the metal would bend, not fold, it would have a smooth shape. The stiffness meant that the metal would bend as little as possible to make the desired shape. This stiff piece of metal was called a <em>spline.</em></p>
<p>Mathematicians found that they could represent the curves created by a draft-man’s spline with piecewise polynomial functions. Initially, they used the term spline to mean a smooth, piecewise polynomial function. More recently, the term spline has been used to describe any piecewise polynomial function. We prefer this latter definition.</p>
<p>For us, a <em><a id="index_term1125"/>spline</em> is a piecewise polynomial function. Such functions are very useful for representing curves.</p>
</section>
</section>
<section>
<h2 id="sec15_2"><a id="index_term303"/><a epub:type="backlink" href="C02a_toc.xhtml#rsec15_2" role="doc-backlink"><span class="green">15.2 Curve Properties</span></a></h2>
<p>To describe a curve, we need to give some facts about its properties. For “named” curves, the properties are usually specific according to the type of curve. For example, to describe a circle, we might provide its radius and the position of its center. For an ellipse, we might also provide the orientation of its major axis and the ratio of the lengths of the axes. For free-form curves however, we need to have a more general set of properties to describe individual curves.</p>
<p><span aria-label="390" epub:type="pagebreak" id="pg_390" role="doc-pagebreak"/>Some properties of curves are attributed to only a single location on the curve, while other properties require knowledge of the whole curve. For an intuition of the difference, imagine that the curve is a train track. If you are standing on the track on a foggy day, you can tell that the track is straight or curved and whether or not you are at an endpoint. These are <em>local</em> properties. You cannot tell whether or not the track is a closed curve, or crosses itself, or how long it is. We call this type of property, a <em>global</em> property.</p>
<p>The study of local properties of geometric objects (curves and surfaces) is known as <em>differential geometry.</em> Technically, to be a differential property, there are some mathematical restrictions about the properties (roughly speaking, in the train-track analogy, you would not be able to have a GPS or a compass). Rather than worry about this distinction, we will use the term <em>local</em> property rather than differential property.</p>
<p>Local properties are important tools for describing curves because they do not require knowledge about the whole curve. Local properties include</p>
<ul class="list-bullet">
<li>
<p class="list"><a id="index_term291"/>continuity,</p>
</li>
<li>
<p class="list">position at a specificplaceonthecurve,</p>
</li>
<li>
<p class="list">direction at a specific place on the curve,</p>
</li>
<li>
<p class="list">curvature (and other derivatives).</p>
</li>
</ul>
<p>Often, we want to specify that a curve includes a particular point. A curve is said to <em>interpolate</em> a point if that point is part of the curve. A function <em>f</em> interpolates a value <em>v</em> if there is some value of the parameter <em>u</em> for which <em>f</em> (<em>t</em>) = <em>v.</em> We call the place of interpolation, that is the value of <em>t,</em> the <em>site.</em></p>
<section>
<h3 id="sec15_2_1"><span class="green">15.2.1 Continuity</span></h3>
<p>It will be very important to understand the local properties of a curve where two parametric pieces come together. If a curve is defined using an equation like Equation (15.2), then we need to be careful about how the pieces are defined. If <strong>f</strong><sub>1</sub>(1) <em/> = <strong>f</strong><sub>2</sub>(0)<em>,</em> then the curve will be “broken”–we would not be able to draw the curve in a continuous stroke of a pen. We call the condition that the curve pieces fit together <em>continuity</em> conditions because if they hold, the curve can be drawn as a continuous piece. Because our definition of ”curve” at the beginning of this chapter requires a curve to be continuous, technically a ”broken curve” is not a curve.</p>
<p><a id="term-243"/><span aria-label="391" epub:type="pagebreak" id="pg_391" role="doc-pagebreak"/>In addition to the positions, we can also check that the derivatives of the pieces match correctly. If <span class="inline-formula"><m:math display="inline"><m:mrow><m:msubsup><m:mrow><m:mi mathvariant="normal">f</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mo>′</m:mo></m:mrow></m:msubsup><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">0</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>≠</m:mo><m:msubsup><m:mrow><m:mi mathvariant="normal">f</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow><m:mrow><m:mo>′</m:mo></m:mrow></m:msubsup><m:mrow><m:mo>(</m:mo><m:mn>0</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:math></span>, then the combined curve will have an abrupt change in its first derivative at the switching point; the first derivative will not be continuous. In general, we say that a curve is <em>C<sup>n</sup></em> continuous if all of its derivatives up to <em>n</em> match across pieces. We denote the position itself as the zeroth derivative, so that the <em>C</em><sup>0</sup> continuity condition means that the positions of the curve are continuous, and <em>C</em><sup>1</sup> continuity means that positions and first derivatives are continuous. The definition of curve requires the curve to be <em>C</em><sup>0</sup>.</p>
<p>An illustration of some continuity conditions is shown in <a href="C20_chapter15.xhtml#f15_2">Figure 15.2</a>. A discontinuity in the first derivative (the curve is <em>C</em><sup>0</sup> but not <em>C</em><sup>1</sup>) is usually noticeable because it displays a sharp corner. A discontinuity in the second derivative is sometimes visually noticeable. Discontinuities in higher derivatives might matter, depending on the application. For example, if the curve represents a motion, an abrupt change in the second derivative is noticeable, so third derivative continuity is often useful. If the curve is going to have a fluid flowing over it (for example, if it is the shape for an airplane wing or boat hull), a discontinuity in the fourth or fifth derivative might cause turbulence.</p>
<figure id="f15_2" tabindex="0">
<img alt="" src="../images/fig15_2.jpg"/>
<figcaption><p><span class="blue">Figure 15.2.</span> An illustration of various types of continuity between two curve segments.</p></figcaption>
</figure>
<p>The type of continuity we have just introduced (<em>C<sup>n</sup></em>) is commonly referred to as <em>parametric continuity</em> as it depends on the parameterization of the two curve pieces. If the “speed” of each piece is different, then they will not be continuous. For cases where we care about the shape of the curve, and not its parameterization, we define <em>geometric continuity</em> that requires that the derivatives of the curve pieces match when the curves are parameterized equivalently (for example, using an arc-length parameterization). Intuitively, this means that the corresponding derivatives must have the same direction, even if they have different magnitudes.</p>
<p class="noindent1"><span aria-label="392" epub:type="pagebreak" id="pg_392" role="doc-pagebreak"/>So, if the <em>C</em><sup>1</sup> continuity condition is</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:msubsup><m:mrow><m:mi mathvariant="normal">f</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mo>′</m:mo></m:mrow></m:msubsup><m:mi mathvariant="normal">(</m:mi><m:mn>1</m:mn><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:msubsup><m:mrow><m:mi mathvariant="normal">f</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow><m:mrow><m:mo>′</m:mo></m:mrow></m:msubsup><m:mrow><m:mo>(</m:mo><m:mn>0</m:mn><m:mo>)</m:mo></m:mrow><m:mo>,</m:mo></m:mrow></m:math>
</div>
<p>the <em>G</em><sup>1</sup> continuity condition would be</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:msubsup><m:mrow><m:mi mathvariant="normal">f</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mo>′</m:mo></m:mrow></m:msubsup><m:mi mathvariant="normal">(</m:mi><m:mn>1</m:mn><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mi>k</m:mi><m:mtext> </m:mtext><m:msubsup><m:mrow><m:mi mathvariant="normal">f</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow><m:mrow><m:mo>′</m:mo></m:mrow></m:msubsup><m:mrow><m:mo>(</m:mo><m:mn>0</m:mn><m:mo>)</m:mo></m:mrow><m:mo>,</m:mo></m:mrow></m:math>
</div>
<p>for some value of scalar <em>k</em>. Generally, geometric continuity is less restrictive than parametric continuity. A <em>C<sup>n</sup></em> curve is also <em>G<sup>n</sup></em> except when the parametric derivatives vanish.</p>
</section>
</section>
<section>
<h2 id="sec15_3"><a id="index_term887"/><a epub:type="backlink" href="C02a_toc.xhtml#rsec15_3" role="doc-backlink"><span class="green">15.3 Polynomial Pieces</span></a></h2>
<p>The most widely used representations of curves in computer graphics is done by piecing together basic elements that are defined by polynomials and called polynomial pieces. For example, a line element is given by a linear polynomial. In <a href="C20_chapter15.xhtml#sec15_3_1">Section 15.3.1</a>, we give a formal definition and explain how to put pieces of polynomial together.</p>
<section>
<h3 id="sec15_3_1"><span class="green">15.3.1 Polynomial Notation</span></h3>
<p>Polynomials are functions of the form</p>
<div class="disp-formula" id="equ15_3">
<m:math display="block"><m:mrow><m:mi mathvariant="italic">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">t</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:msub><m:mrow><m:mi mathvariant="italic">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:msub><m:mrow><m:mi mathvariant="italic">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mi mathvariant="italic">t</m:mi><m:mo>+</m:mo><m:msub><m:mrow><m:mi mathvariant="italic">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:msup><m:mrow><m:mi mathvariant="italic">t</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:mo>+</m:mo><m:mi mathvariant="normal">…</m:mi><m:mo>+</m:mo><m:msub><m:mrow><m:mi mathvariant="italic">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">n</m:mi></m:mrow></m:msub><m:msup><m:mrow><m:mi mathvariant="italic">t</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">n</m:mi></m:mrow></m:msup><m:mn>.</m:mn></m:mrow><m:mspace width="3em"/><m:mo>(15.3)</m:mo></m:math>
</div>
<p>The <em>a<sub>i</sub></em> are called the <em>coefficients</em>,and <em>n</em> is called the degree of the polynomial if <em>a<sub>n</sub></em> ≠ 0. We also write Equation (15.3) in the form</p>
<div class="disp-formula" id="equ15_4">
<m:math display="block"><m:mrow><m:mi mathvariant="normal">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">t</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:munderover><m:mrow><m:mstyle displaystyle="true" mathvariant="normal"><m:mo>∑</m:mo></m:mstyle></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal">0</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">n</m:mi></m:mrow></m:munderover><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi></m:mrow></m:msub><m:msup><m:mrow><m:mi mathvariant="italic">t</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi></m:mrow></m:msup><m:mn>.</m:mn></m:mrow><m:mspace width="3em"/><m:mo>(15.4)</m:mo></m:math>
</div>
<p>We call this the <em>canonical</em> form of the polynomial.</p>
<p>We can generalize the canonical form to</p>
<div class="disp-formula" id="equ15_5">
<m:math display="block"><m:mrow><m:mi mathvariant="normal">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">t</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:munderover><m:mrow><m:mstyle displaystyle="true" mathvariant="normal"><m:mo>∑</m:mo></m:mstyle></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal">0</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">n</m:mi></m:mrow></m:munderover><m:msub><m:mrow><m:mi mathvariant="normal">c</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">t</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>,</m:mo></m:mrow><m:mspace width="3em"/><m:mo>(15.5)</m:mo></m:math>
</div>
<p>where <em>b<sub>i</sub></em>(<em>t</em>) is a polynomial. We can choose these polynomials in a convenient form for different applications, and we call them <em>basis functions</em> or <em>blending functions</em> (see <a href="C20_chapter15.xhtml#sec15_3_5">Section 15.3.5</a>). In Equation (15.4), the <em>t<sup>i</sup></em> are the <em>b<sub>i</sub></em>(<em>t</em>) of Equation (15.5). If the set of basis functions is chosen correctly, any polynomial of degree <em>n</em> +1 can be represented by an appropriate choice of <strong>c</strong>.</p>
<p><span aria-label="393" epub:type="pagebreak" id="pg_393" role="doc-pagebreak"/>The canonical form does not always have convenient coefficients. For practical purposes, throughout this chapter, we will find sets of basis functions such that the coefficients are convenient ways to control the curves represented by the polynomial functions.</p>
<p>To specify a curve embedded in two dimensions, one can either specify two polynomials in <em>t</em>: one for how <em>x</em> varies with <em>t</em> and one for how <em>y</em> varies with <em>t</em>; or specify a single polynomial where each of the <strong>a</strong><em><sub>i</sub></em> is a 2D point. An analogous situation exists for any curve in an <em>n</em>-dimensional space.</p>
</section>
<section>
<h3 id="sec15_3_2"><a id="index_term678"/><span class="green">15.3.2 A Line Segment</span></h3>
<p>To introduce the concepts of piecewise polynomial curve representations, we will discuss line segments. In practice, line segments are so simple that the mathematical derivations will seem excessive. However, by understanding this simple case, things will be easier when we move on to more complicated polynomials.</p>
<p>Consider a line segment that connects point <strong>p</strong><sub>0</sub> to <strong>p</strong><sub>1</sub>. We could write the parametric function over the unit domain for this line segment as</p>
<div class="disp-formula" id="equ15_6">
<m:math display="block"><m:mrow><m:mi mathvariant="normal">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">1</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:msub><m:mrow><m:mi mathvariant="normal">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:mi mathvariant="italic">u</m:mi><m:msub><m:mrow><m:mi mathvariant="normal">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mn>.</m:mn></m:mrow><m:mspace width="3em"/><m:mo>(15.6)</m:mo></m:math>
</div>
<p>By writing this in vector form, we have hidden the dimensionality of the points and the fact that we are dealing with each dimension separately. For example, were we working in 2D, we could have created separate equations:</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="italic">f</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">x</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal"/><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">1</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:msub><m:mrow><m:mi mathvariant="italic">x</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:mi mathvariant="italic">u</m:mi><m:msub><m:mrow><m:mi mathvariant="italic">x</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="italic">f</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">y</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal"/><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">1</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:msub><m:mrow><m:mi mathvariant="italic">y</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:mi mathvariant="italic">u</m:mi><m:msub><m:mrow><m:mi mathvariant="italic">y</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">.</m:mi></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>The line that we specify is determined by the two endpoints, but from now on we will stick to vector notation since it is cleaner. We will call the vector of control parameters, <strong>p</strong>,the <em>control points</em>, and each element of <strong>p</strong>,a <em>control point</em>.</p>
<p>While describing a line segment by the positions of its endpoints is obvious and usually convenient, there are other ways to describe a line segment. For example,</p>
<ol class="list-order">
<li>
<p class="list">the position of the center of the line segment, the orientation, and the length;</p>
</li>
<li>
<p class="list">the position of one endpoint and the position of the second point relative to the first;</p>
</li>
<li>
<p class="list">the position of the middle of the line segment and one endpoint.</p>
</li>
</ol>
<p><a id="term-632"/><span aria-label="394" epub:type="pagebreak" id="pg_394" role="doc-pagebreak"/>It is obvious that given one kind of a description of a line segment, we can switch to another one.</p>
<p>A different way to describe a line segment is using the canonical form of the polynomial (as discussed in <a href="C20_chapter15.xhtml#sec15_3_1">Section 15.3.1</a>),</p>
<div class="disp-formula" id="equ15_7">
<m:math display="block"><m:mrow><m:mi mathvariant="normal">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:mi mathvariant="italic">u</m:mi><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mn>.</m:mn></m:mrow><m:mspace width="3em"/><m:mo>(15.7)</m:mo></m:math>
</div>
<p>Any line segment can be represented either by specifying <strong>a</strong><sub>0</sub> and <strong>a</strong><sub>1</sub> or the endpoints (<strong>p</strong><sub>0</sub> and <strong>p</strong><sub>1</sub>). It is usually more convenient to specify the endpoints, because we can compute the other parameters from the endpoints.</p>
<p>To write the canonical form as a vector expression, we defineavector <strong>u</strong> that is a vector of the powers of <em>u</em>:</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mi mathvariant="normal">u</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal">[</m:mi><m:mi mathvariant="normal">1</m:mi><m:mtext> </m:mtext><m:mi mathvariant="italic">u</m:mi><m:mtext> </m:mtext><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:mtext> </m:mtext><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msup><m:mi mathvariant="normal"/><m:mi mathvariant="normal">.</m:mi><m:mi mathvariant="normal"/><m:mi mathvariant="normal">.</m:mi><m:mi mathvariant="normal"/><m:mi mathvariant="normal">.</m:mi><m:mi mathvariant="normal"/><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">n</m:mi></m:mrow></m:msup><m:mi mathvariant="normal">]</m:mi><m:mo>,</m:mo></m:mrow></m:math>
</div>
<p>so that Equation (15.4) can be written as</p>
<div class="disp-formula" id="equ15_8">
<m:math display="block"><m:mrow><m:mi mathvariant="normal">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal">u</m:mi><m:mo>⋅</m:mo><m:mi mathvariant="normal">a</m:mi><m:mn>.</m:mn></m:mrow><m:mspace width="3em"/><m:mo>(15.8)</m:mo></m:math>
</div>
<p>This vector notation will make transforming between different forms of the curve easier.</p>
<p>Equation (15.8) describes a curve segment by the set of polynomial coefficients for the simple form of the polynomial. We call such a representation the <em>canonical</em> form. We will denote the parameters of the canonical form by <strong>a</strong>.</p>
<p>While it is mathematically simple, the canonical form is not always the most convenient way to specify curves. For example, we might prefer to specify a line segment by the positions of its endpoints. If we want to define <strong>p</strong><sub>0</sub> to be the beginning of the segment (where the segment is when <em>u</em> = 0)and <strong>p</strong><sub>1</sub> to be the end of the line segment (where the line segment is at <em>u</em> = 1), we can write</p>
<div class="disp-formula" id="equ15_9">
<m:math display="block"><m:mrow><m:mtable columnalign="left"><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">P</m:mi></m:mrow><m:mrow><m:mn>0</m:mn></m:mrow></m:msub><m:mo>=</m:mo><m:mi mathvariant="normal">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">0</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mrow><m:mo>[</m:mo><m:mn>1</m:mn><m:mtext> </m:mtext><m:mn>0</m:mn><m:mo>]</m:mo></m:mrow><m:mo>⋅</m:mo><m:mi mathvariant="normal">[</m:mi><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mtext> </m:mtext><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">]</m:mi><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">P</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub><m:mo>=</m:mo><m:mi mathvariant="normal">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mn>1</m:mn><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mrow><m:mo>[</m:mo><m:mn>1</m:mn><m:mtext>1</m:mtext><m:mo>]</m:mo></m:mrow><m:mo>⋅</m:mo><m:mi mathvariant="normal">[</m:mi><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mtext> </m:mtext><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">]</m:mi><m:mn>.</m:mn></m:mtd></m:mtr></m:mtable></m:mrow><m:mspace width="3em"/><m:mo>(15.9)</m:mo></m:math>
</div>
<p>We can solve these equations for <strong>a</strong><sub>0</sub> and <strong>a</strong><sub>1</sub>:</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mo>=</m:mo></m:mtd><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">p</m:mi></m:mrow><m:mrow><m:mn>0</m:mn></m:mrow></m:msub><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mo>=</m:mo></m:mtd><m:mtd><m:mi mathvariant="normal"/><m:msub><m:mrow><m:mi mathvariant="normal">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi mathvariant="normal">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">.</m:mi></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<section>
<h4 id="sec58"><span class="blue">Matrix Form for Polynomials</span></h4>
<p>While this first example was easy enough to solve, for more complicated examples it will be easier to write Equation (15.9) in the form</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow><m:mo>=</m:mo><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mi mathvariant="normal">1</m:mi></m:mtd><m:mtd><m:mi mathvariant="normal">0</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:mi mathvariant="normal">1</m:mi></m:mtd><m:mtd><m:mi mathvariant="normal">1</m:mi></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow><m:mn>.</m:mn></m:mrow></m:math>
</div>
<p><span aria-label="395" epub:type="pagebreak" id="pg_395" role="doc-pagebreak"/>Alternatively, we can write</p>
<div class="disp-formula" id="equ15_10">
<m:math display="block"><m:mrow><m:mi mathvariant="normal">p</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal">C</m:mi><m:mtext> </m:mtext><m:mi mathvariant="normal">a</m:mi><m:mo>,</m:mo></m:mrow><m:mspace width="3em"/><m:mo>(15.10)</m:mo></m:math>
</div>
<p>where we call <strong>C</strong>, the <em><a id="index_term233"/>constraint matrix</em>.<a epub:type="noteref" href="C20_chapter15.xhtml#fn15_1" id="rfn15_1" role="doc-noteref"><sup>1</sup></a> If having vectors of points bothers you, you can consider each dimension independently (so that <strong>p</strong> is [<em>x</em><sub>0</sub> <em>x</em><sub>1</sub>] or [<em>y</em><sub>0</sub> <em>y</em><sub>1</sub>] and <strong>a</strong> is handled correspondingly).</p>
<p>We can solve Equation (15.10) for <strong>a</strong> by finding the inverse of <strong>C</strong>. This inverse matrix which we will denote by <strong>B</strong> is called the <em>basis</em> matrix. The <a id="index_term76"/>basis matrix is very handy since it tells us how to convert between the convenient parameters <strong>p</strong> and the canonical form <strong>a</strong><em><sub>,</sub></em> and, therefore, gives us an easy way to evaluate the curve</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mi mathvariant="normal">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal">u</m:mi><m:mtext> </m:mtext><m:mi mathvariant="normal">B</m:mi><m:mtext> </m:mtext><m:mi mathvariant="normal">p</m:mi><m:mi mathvariant="normal">.</m:mi></m:mrow></m:math>
</div>
<p>We can find a basis matrix for whatever form of the curve that we want, providing that there are no nonlinearities in the definition of the parameters. Examples of nonlinearly defined parameters include the length and angle of the line segment.</p>
<p>Now, suppose we want to parameterize the line segment so that <strong>p</strong><sub>0</sub> is the halfway point (<em>u</em> = 0.5), and <strong>p</strong><sub>1</sub> is the ending point (<em>u</em> = 1). To derive the basis matrix for this parameterization, we set</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mo>=</m:mo><m:mi mathvariant="normal"/></m:mtd><m:mtd><m:mi mathvariant="normal">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">0</m:mi><m:mi mathvariant="normal">.</m:mi><m:mi mathvariant="normal">5</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal"/><m:mi mathvariant="normal">1</m:mi><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:mi mathvariant="normal">0</m:mi><m:mi mathvariant="normal">.</m:mi><m:mi mathvariant="normal">5</m:mi><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mo>=</m:mo><m:mi mathvariant="normal"/></m:mtd><m:mtd><m:mi mathvariant="normal">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal">1</m:mi><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mspace/><m:mo>⁢</m:mo><m:mi mathvariant="normal">.</m:mi></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>So</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mi mathvariant="normal">C</m:mi><m:mo>=</m:mo><m:mrow><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mi mathvariant="normal">1</m:mi></m:mtd><m:mtd><m:mi mathvariant="normal">5</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:mi mathvariant="normal">1</m:mi></m:mtd><m:mtd><m:mi mathvariant="normal">1</m:mi></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow></m:mrow><m:mo>,</m:mo></m:mrow></m:math>
</div>
<p>and therefore</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mi mathvariant="normal">B</m:mi><m:mo>=</m:mo><m:msup><m:mrow><m:mi mathvariant="normal">C</m:mi></m:mrow><m:mrow><m:mo>−</m:mo><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msup><m:mo>=</m:mo><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd columnalign="right"><m:mi mathvariant="normal">2</m:mi></m:mtd><m:mtd columnalign="right"><m:mo>−</m:mo><m:mi mathvariant="normal">1</m:mi></m:mtd></m:mtr><m:mtr><m:mtd columnalign="right"><m:mo>−</m:mo><m:mi mathvariant="normal">2</m:mi></m:mtd><m:mtd columnalign="right"><m:mi mathvariant="normal">2</m:mi></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow><m:mn>.</m:mn></m:mrow></m:math>
</div>
</section>
</section>
<section>
<h3 id="sec15_3_3"><span class="green">15.3.3 Beyond Line Segments</span></h3>
<p>Line segments are so simple that finding a basis matrix is trivial. However, it was good practice for curves of higher degree. First, let’s consider quadratics (curves of degree two). The advantage of the canonical form (Equation (15.4)) is that it works for these more complicated curves, just by letting <em>n</em> be a larger number.</p>
<aside class="footnote" epub:type="footnote" role="doc-footnote"><p><a href="#rfn15_1" id="fn15_1"><sup>1</sup></a> We assume the form of a vector (row or column) is obvious from the context, and we will skip all of the transpose symbols for vectors.</p></aside>
<p class="indent"><span aria-label="396" epub:type="pagebreak" id="pg_396" role="doc-pagebreak"/>A quadratic (a degree-two polynomial) has three coefficients, <strong>a</strong><sub>0</sub>, <strong>a</strong><sub>1</sub>,and <strong>a</strong><sub>2</sub>. These coefficients are not convenient for describing the shape of the curve. However, we can use the same basis matrix method to devise more convenient parameters. If we know the value of <em>u,</em> Equation (15.4) becomes a linear equation in the parameters, and the linear algebra from the last section still works.</p>
<p>Suppose that we wanted to describe our curves by the position of the beginning (<em>u</em> = 0), middle<a epub:type="noteref" href="C20_chapter15.xhtml#fn15_2" id="rfn15_2" role="doc-noteref"><sup>2</sup></a> (<em>u</em> = 0.5), and end (<em>u</em> = 1). Entering the appropriate values into Equation (15.4):</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">p</m:mi></m:mrow><m:mrow><m:mn>0</m:mn></m:mrow></m:msub></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo><m:mi mathvariant="normal">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">0</m:mi><m:mi mathvariant="normal">)</m:mi><m:mi mathvariant="normal"/></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:msup><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msup></m:mtd><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mi mathvariant="normal"/></m:mtd><m:mtd columnalign="left"><m:mo>+</m:mo><m:msup><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup></m:mtd><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">p</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo><m:mi mathvariant="normal">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">0</m:mi><m:mo>,</m:mo><m:mn>5</m:mn><m:mi mathvariant="normal">)</m:mi></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:msup><m:mrow><m:mi mathvariant="normal">0</m:mi><m:mn>.5</m:mn></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msup></m:mtd><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub></m:mtd><m:mtd columnalign="left"><m:mo>+</m:mo><m:msup><m:mrow><m:mi mathvariant="normal">0</m:mi><m:mn>.5</m:mn></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup></m:mtd><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">p</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msub></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo><m:mi mathvariant="normal">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mn>1</m:mn><m:mi mathvariant="normal">)</m:mi></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:msup><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msup></m:mtd><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub></m:mtd><m:mtd columnalign="left"><m:mo>+</m:mo><m:msup><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup></m:mtd><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mn>.</m:mn></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>So the constraint matrix is</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mtext>C</m:mtext><m:mo>=</m:mo><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mn>1</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>1</m:mn></m:mtd><m:mtd><m:mn>.5</m:mn></m:mtd><m:mtd><m:mn>.25</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>1</m:mn></m:mtd><m:mtd><m:mn>1</m:mn></m:mtd><m:mtd><m:mn>1</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow><m:mo>,</m:mo></m:mrow></m:math>
</div>
<p>and the basis matrix is</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mi mathvariant="normal">B</m:mi><m:mo>=</m:mo><m:msup><m:mrow><m:mi mathvariant="normal">C</m:mi></m:mrow><m:mrow><m:mo>−</m:mo><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msup><m:mo>=</m:mo><m:mrow><m:mo>[</m:mo><m:mtable columnalign="right"><m:mtr><m:mtd><m:mn>1</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mo>−</m:mo><m:mn>3</m:mn></m:mtd><m:mtd><m:mn>4</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>1</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>2</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>4</m:mn></m:mtd><m:mtd><m:mn>2</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow><m:mn>.</m:mn></m:mrow></m:math>
</div>
<p>There is an additional type of constraint (or parameter) that is sometimes convenient to specify: the derivative of the curve (with respect to its free parameter) at a particular value. Intuitively, the derivatives tell us how the curve is changing, so that the first derivative tells us what direction the curve is going, the second derivative tells us how quickly the curve is changing direction, etc. We will see examples of why it is useful to specify derivatives later.</p>
<p>For the quadratic,</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mi mathvariant="normal">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mi mathvariant="italic">u</m:mi><m:mo>+</m:mo><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:mo>,</m:mo></m:mrow></m:math>
</div>
<p>the derivatives are simple:</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mi mathvariant="normal">f</m:mi><m:mi>′</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mfrac><m:mrow><m:mi mathvariant="italic">d</m:mi><m:mi mathvariant="normal">f</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">d</m:mi><m:mi mathvariant="italic">u</m:mi></m:mrow></m:mfrac><m:mo>=</m:mo><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:mi mathvariant="normal">2</m:mi><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mi mathvariant="italic">u</m:mi><m:mo>,</m:mo></m:mrow></m:math>
</div>
<p>and</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mi mathvariant="normal">f</m:mi><m:mi>′</m:mi><m:mi>′</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mfrac><m:mrow><m:msup><m:mrow><m:mi mathvariant="italic">d</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:mi mathvariant="normal">f</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">d</m:mi><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup></m:mrow></m:mfrac><m:mo>=</m:mo><m:mfrac><m:mrow><m:mi mathvariant="italic">d</m:mi><m:mi mathvariant="normal">f</m:mi><m:mi>′</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">d</m:mi><m:mi mathvariant="italic">u</m:mi></m:mrow></m:mfrac><m:mo>=</m:mo><m:mi mathvariant="normal">2</m:mi><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">.</m:mi></m:mrow></m:math>
</div>
<aside class="footnote" epub:type="footnote" role="doc-footnote"><p><a href="#rfn15_2" id="fn15_2"><sup>2</sup></a> Notice that this is the middle of the parameter space, which might not be the middle of the curve itself.</p></aside>
<p class="noindent1"><span aria-label="397" epub:type="pagebreak" id="pg_397" role="doc-pagebreak"/>Or, more generally,</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mtable><m:mtr><m:mtd><m:mi mathvariant="normal">f</m:mi><m:mi>′</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo></m:mtd><m:mtd><m:msubsup><m:mrow><m:mstyle displaystyle="true" mathvariant="normal"><m:mrow><m:mo>∑</m:mo></m:mrow></m:mstyle></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">n</m:mi></m:mrow></m:msubsup><m:mi mathvariant="italic">i</m:mi><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>−</m:mo><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi></m:mrow></m:msub><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mi mathvariant="normal">f</m:mi><m:mi>′</m:mi><m:mi>′</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal"/></m:mtd><m:mtd><m:msubsup><m:mrow><m:mstyle displaystyle="true" mathvariant="normal"><m:mrow><m:mo>∑</m:mo></m:mrow></m:mstyle></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal">2</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">n</m:mi></m:mrow></m:msubsup><m:mi mathvariant="italic">i</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">i</m:mi><m:mo>−</m:mo><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal">)</m:mi><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>−</m:mo><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">.</m:mi></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>For example, consider a case where we want to specify a quadratic curve segment by the position, first, and second derivative at its middle (<em>u</em> = 0.5).</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mtext>p</m:mtext></m:mrow><m:mrow><m:mn>0</m:mn></m:mrow></m:msub></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo><m:mi mathvariant="normal">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">0</m:mi><m:mi mathvariant="normal">.</m:mi><m:mi mathvariant="normal">5</m:mi><m:mi mathvariant="normal">)</m:mi></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mo>+</m:mo></m:mtd><m:mtd><m:mi mathvariant="normal">0</m:mi><m:mi mathvariant="normal">.</m:mi><m:msup><m:mrow><m:mi mathvariant="normal">5</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msup></m:mtd><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mo>+</m:mo></m:mtd><m:mtd/><m:mtd columnalign="left"><m:mi mathvariant="normal">0</m:mi><m:mi mathvariant="normal">.</m:mi><m:msup><m:mrow><m:mi mathvariant="normal">5</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup></m:mtd><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mtext>p</m:mtext></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo><m:msup><m:mrow><m:mi mathvariant="normal">f</m:mi></m:mrow><m:mrow><m:mo>′</m:mo></m:mrow></m:msup><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">0</m:mi><m:mi mathvariant="normal">.</m:mi><m:mi mathvariant="normal">5</m:mi><m:mi mathvariant="normal">)</m:mi></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo></m:mtd><m:mtd/><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mo>+</m:mo></m:mtd><m:mtd><m:mn>2</m:mn></m:mtd><m:mtd columnalign="left"><m:mn>0.5</m:mn></m:mtd><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mtext>p</m:mtext></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msub></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo><m:msup><m:mrow><m:mi mathvariant="normal">f</m:mi></m:mrow><m:mrow><m:mo>"</m:mo></m:mrow></m:msup><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">0</m:mi><m:mi mathvariant="normal">.</m:mi><m:mi mathvariant="normal">5</m:mi><m:mi mathvariant="normal">)</m:mi></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo></m:mtd><m:mtd/><m:mtd/><m:mtd><m:mn>2</m:mn></m:mtd><m:mtd/><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mn>.</m:mn></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>The constraint matrix is</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mtext>C</m:mtext><m:mo>=</m:mo><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mn>1</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>.5</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>.25</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>1</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>1</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>0</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>2</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow><m:mo>,</m:mo></m:mrow></m:math>
</div>
<p>and the basis matrix is</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mi mathvariant="normal">B</m:mi><m:mo>=</m:mo><m:msup><m:mrow><m:mi mathvariant="normal">C</m:mi></m:mrow><m:mrow><m:mo>−</m:mo><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msup><m:mo>=</m:mo><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mn>1</m:mn></m:mtd><m:mtd columnalign="right"><m:mo>−</m:mo><m:mn>5.</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>.125</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>1</m:mn></m:mtd><m:mtd columnalign="right"><m:mo>−</m:mo><m:mn>.5</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>0</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>.5</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow><m:mn>.</m:mn></m:mrow></m:math>
</div>
</section>
<section>
<h3 id="sec15_3_4"><a id="index_term75"/><a id="index_term283"/><span class="green">15.3.4 Basis Matrices for Cubics</span></h3>
<p>Cubic polynomials are popular in graphics (See <a href="C20_chapter15.xhtml#sec15_5">Section 15.5</a>). The derivations for the various forms of cubics are just like the derivations we’ve seen already in this section. We will work through one more example for practice.</p>
<p>A very useful form of a cubic polynomial is the <em>Hermite</em> form, where we specify the position and first derivative at the beginning and end, that is,</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mo>=</m:mo><m:mi mathvariant="normal"/></m:mtd><m:mtd><m:mi mathvariant="normal">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">0</m:mi><m:mi mathvariant="normal">)</m:mi><m:mi mathvariant="normal"/></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mo>+</m:mo></m:mtd><m:mtd columnalign="left"><m:msup><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msup><m:mi mathvariant="normal"/><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub></m:mtd><m:mtd columnalign="left"><m:mo>+</m:mo></m:mtd><m:mtd columnalign="left"><m:msup><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:mi mathvariant="normal"/><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mo>+</m:mo></m:mtd><m:mtd columnalign="left"/><m:mtd columnalign="left"><m:msup><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">p</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub><m:mo>=</m:mo></m:mtd><m:mtd><m:mi mathvariant="normal">f</m:mi><m:mo>′</m:mo><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">0</m:mi><m:mi mathvariant="normal">)</m:mi><m:mi mathvariant="normal"/></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub></m:mtd><m:mtd columnalign="left"><m:mo>+</m:mo><m:mn>2</m:mn></m:mtd><m:mtd columnalign="left"><m:msup><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msup><m:mi mathvariant="normal"/><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mo>+</m:mo></m:mtd><m:mtd columnalign="left"><m:mn>3</m:mn></m:mtd><m:mtd columnalign="left"><m:msup><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">p</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msub><m:mo>=</m:mo></m:mtd><m:mtd><m:mi mathvariant="normal">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mn>1</m:mn><m:mi mathvariant="normal">)</m:mi><m:mi mathvariant="normal"/></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mo>+</m:mo></m:mtd><m:mtd columnalign="left"><m:msup><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msup><m:mi mathvariant="normal"/><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub></m:mtd><m:mtd columnalign="left"><m:mo>+</m:mo><m:mn>2</m:mn></m:mtd><m:mtd columnalign="left"><m:msup><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mi mathvariant="normal"/><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mo>+</m:mo></m:mtd><m:mtd columnalign="left"/><m:mtd columnalign="left"><m:msup><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>3</m:mn></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">p</m:mi></m:mrow><m:mrow><m:mn>3</m:mn></m:mrow></m:msub><m:mo>=</m:mo></m:mtd><m:mtd><m:mi mathvariant="normal">f</m:mi><m:mo>′</m:mo><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">0</m:mi><m:mi mathvariant="normal">)</m:mi><m:mi mathvariant="normal"/></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub></m:mtd><m:mtd columnalign="left"><m:mo>+</m:mo><m:mn>2</m:mn></m:mtd><m:mtd columnalign="left"><m:msup><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msup><m:mi mathvariant="normal"/><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mo>+</m:mo></m:mtd><m:mtd columnalign="left"><m:mn>3</m:mn></m:mtd><m:mtd columnalign="left"><m:msup><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="normal">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:mo>,</m:mo></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p><a id="term-633"/><span aria-label="398" epub:type="pagebreak" id="pg_398" role="doc-pagebreak"/> Thus, the constraint matrix is</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mtext mathvariant="bold">C</m:mtext><m:mo>=</m:mo><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mn>1</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>1</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>1</m:mn></m:mtd><m:mtd><m:mn>1</m:mn></m:mtd><m:mtd><m:mn>1</m:mn></m:mtd><m:mtd><m:mn>1</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>1</m:mn></m:mtd><m:mtd><m:mn>2</m:mn></m:mtd><m:mtd><m:mn>3</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow><m:mo>,</m:mo></m:mrow></m:math>
</div>
<p>and the basis matrix is</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mi mathvariant="bold">B</m:mi><m:mo>=</m:mo><m:msup><m:mrow><m:mi mathvariant="bold">C</m:mi></m:mrow><m:mrow><m:mo>−</m:mo><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msup><m:mo>=</m:mo><m:mrow><m:mo>[</m:mo><m:mtable columnalign="right"><m:mtr><m:mtd><m:mn>1</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>1</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mo>−</m:mo><m:mn>3</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>2</m:mn></m:mtd><m:mtd><m:mn>3</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>1</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>2</m:mn></m:mtd><m:mtd><m:mn>1</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>2</m:mn></m:mtd><m:mtd><m:mn>1</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow><m:mn>.</m:mn></m:mrow></m:math>
</div>
<p>We will discuss <a id="index_term519"/>Hermite cubic splines in <a href="C20_chapter15.xhtml#sec15_5_2">Section 15.5.2</a>.</p>
</section>
<section>
<h3 id="sec15_3_5"><span class="green">15.3.5 Blending Functions</span></h3>
<p>If we know the basis matrix, <strong>B</strong>, we can multiply it by the parameter vector, <strong>u</strong>,to get a vector of functions</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mi mathvariant="bold">b</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mi mathvariant="bold">u</m:mi><m:mtext mathvariant="bold">B</m:mtext><m:mn>.</m:mn></m:mrow></m:math>
</div>
<p>Notice that we denote this vector by <strong>b</strong>(<em>u</em>) to emphasize the fact that its value depends on the free parameter <em>u.</em> We call the elements of <strong>b</strong>(<em>u</em>) the <em>blending functions</em>, because they specify how to blend the values of the control point vector together:</p>
<div class="disp-formula" id="equ15_11">
<m:math display="block"><m:mrow><m:mi mathvariant="bold">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:munderover><m:mrow><m:mstyle displaystyle="true" mathvariant="normal"><m:mo>∑</m:mo></m:mstyle></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal">0</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">n</m:mi></m:mrow></m:munderover><m:msub><m:mrow><m:mi mathvariant="bold">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi></m:mrow></m:msub><m:mn>.</m:mn></m:mrow><m:mspace width="3em"/><m:mo>(15.11)</m:mo></m:math>
</div>
<p>It is important to note that for a chosen value of <em>u</em>, Equation (15.11) is a <em>linear</em>equation specifying a <em><a id="index_term688"/>linear blend</em> (or weighted average) of the control points. This is true no matter what degree polynomials are “hidden” inside of the <strong>b</strong><em><sub>i</sub></em>functions.</p>
<p><a id="index_term87"/>Blending functions provide a nice abstraction for describing curves. Any type of curve can be represented as a linear combination of its control points, where those weights are computed as some arbitrary functions of the free parameter.</p>
</section>
<section>
<h3 id="sec15_3_6"><a id="index_term629"/><span class="green">15.3.6 Interpolating Polynomials</span></h3>
<p>In general, a polynomial of degree <em>n</em> can interpolate a set of <em>n</em> + 1 values. If we are given a vector <strong>p</strong> = (<em>p</em><sub>0</sub><em>,...,p<sub>n</sub></em>) of points to interpolate and a vector <strong>t</strong> = (<em>t</em><sub>0</sub><em>,...,t<sub>n</sub></em>) of increasing parameter values, <em>t<sub>i</sub></em> ≠ <em>t<sub>j</sub></em>, we can use the methods <a id="term-230"/><a id="term-471"/><a id="term-634"/><span aria-label="399" epub:type="pagebreak" id="pg_399" role="doc-pagebreak"/>described in the previous sections to determine an <em>n</em> + 1 × <em>n</em> + 1 basis matrix that gives us a function <em>f</em>(<em>t</em>) such that <em>f</em>(<em>t<sub>i</sub></em>) = <em>p<sub>i</sub></em>. For any given vector <strong>t</strong>,weneed to set up and solve an <em>n</em> = 1 × <em>n</em> + 1 linear system. This provides us with a set of <em>n</em> + 1 basis functions that perform interpolation:</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mi mathvariant="bold">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">t</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:munderover><m:mrow><m:mstyle displaystyle="true" mathvariant="normal"><m:mo>∑</m:mo></m:mstyle></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal">0</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">n</m:mi></m:mrow></m:munderover><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">t</m:mi><m:mi mathvariant="normal">)</m:mi><m:mn>.</m:mn></m:mrow></m:math>
</div>
<p>These interpolating basis functions can be derived in other ways. One particularly elegant way to define them is the <em>Lagrange form:</em></p>
<div class="disp-formula" id="equ15_12">
<m:math display="block"><m:mrow><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi></m:mrow></m:msub><m:mo>=</m:mo><m:munderover><m:mrow><m:mstyle displaystyle="true" mathvariant="normal"><m:mo>∏</m:mo></m:mstyle></m:mrow><m:mrow><m:mi mathvariant="italic">j</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal">0</m:mi><m:mo>,</m:mo><m:mi mathvariant="italic">j</m:mi><m:mo>≠</m:mo><m:mi mathvariant="italic">i</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">n</m:mi></m:mrow></m:munderover><m:mfrac><m:mrow><m:mi mathvariant="italic">x</m:mi><m:mo>−</m:mo><m:msub><m:mrow><m:mi mathvariant="italic">t</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">j</m:mi></m:mrow></m:msub></m:mrow><m:mrow><m:msub><m:mrow><m:mi mathvariant="italic">t</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi mathvariant="italic">t</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">j</m:mi></m:mrow></m:msub></m:mrow></m:mfrac><m:mn>.</m:mn></m:mrow><m:mspace width="3em"/><m:mo>(15.12)</m:mo></m:math>
</div>
<p>There are more computationally efficient ways to express the interpolating basis functions than the <a id="index_term655"/>Lagrange form (see De Boor (1978) for details).</p>
<p>Interpolating polynomials provide a mechanism for defining curves that interpolate a set of points. <a href="C20_chapter15.xhtml#f15_3">Figure 15.3</a> shows some examples. While it is possible to create a single polynomial to interpolate any number of points, we rarely use high-order polynomials to represent curves in computer graphics. Instead, interpolating splines (piecewise polynomial functions) are preferred. Some reasons for this are considered in <a href="C20_chapter15.xhtml#sec15_5_3">Section 15.5.3</a>.</p>
<figure id="f15_3" tabindex="0">
<img alt="" src="../images/fig15_3.jpg"/>
<figcaption><p><span class="blue">Figure 15.3.</span> Interpolating polynomials through multiple points. In (a) and (b), the curve contains extra wiggles and over-shooting between points. And when the sixth point is added in (c), it completely changes the shape of the curve due to the non-local nature of interpolating polynomials.</p></figcaption>
</figure>
</section>
</section>
<section>
<h2 id="sec15_4"><a epub:type="backlink" href="C02a_toc.xhtml#rsec15_4" role="doc-backlink"><span class="green">15.4 Putting Pieces Together</span></a></h2>
<p>Now that we’ve seen how to make individual pieces of polynomial curves, we can consider how to put these pieces together.</p>
<section>
<h3 id="sec15_4_1"><span class="green">15.4.1 Knots</span></h3>
<p>The basic idea of a piecewise parametric function is that each piece is only used over some parameter range. For example, if we want to define a function that has two piecewise linear segments that connect three points (as shown in <a href="C20_chapter15.xhtml#f15_4">Figure 15.4(a)</a>), we might define</p>
<div class="disp-formula" id="equ15_13">
<m:math display="block"><m:mrow><m:mi mathvariant="bold">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mrow><m:mo>{</m:mo><m:mtable><m:mtr><m:mtd columnalign="left"><m:msub><m:mrow><m:mi mathvariant="bold">f</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">2</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi></m:mtd><m:mtd><m:mi mathvariant="normal">i</m:mi><m:mi mathvariant="normal">f</m:mi><m:mi mathvariant="normal"/><m:mi mathvariant="normal">0</m:mi><m:mo>≤</m:mo><m:mi mathvariant="italic">u</m:mi><m:mo>&lt;</m:mo><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:mfrac><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd columnalign="left"><m:msub><m:mrow><m:mi mathvariant="bold">f</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">2</m:mi><m:mi mathvariant="italic">u</m:mi><m:mo>−</m:mo><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal">)</m:mi></m:mtd><m:mtd><m:mi mathvariant="normal">i</m:mi><m:mi mathvariant="normal">f</m:mi><m:mi mathvariant="normal"/><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:mfrac><m:mo>≤</m:mo><m:mi mathvariant="italic">u</m:mi><m:mo>&lt;</m:mo><m:mi mathvariant="normal">1</m:mi><m:mo>,</m:mo></m:mtd></m:mtr></m:mtable></m:mrow></m:mrow><m:mspace width="3em"/><m:mo>(15.13)</m:mo></m:math>
</div>
<figure id="f15_4" tabindex="0">
<img alt="" src="../images/fig15_4.jpg"/>
<figcaption><p><span class="blue">Figure 15.4.</span> <a id="term-501"/><span aria-label="400" epub:type="pagebreak" id="pg_400" role="doc-pagebreak"/>(a) Two line segments connect three points; (b) the blending functions for each of the points are graphed at right.</p></figcaption>
</figure>
<p class="noindent1">where <strong>f</strong><sub>1</sub> and <strong>f</strong><sub>2</sub> are functions for each of the two line segments. Notice that we have rescaled the parameter for each of the pieces to facilitate writing their equations as</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:msub><m:mrow><m:mi mathvariant="bold">f</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">1</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:mi mathvariant="italic">u</m:mi><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">.</m:mi></m:mrow></m:math>
</div>
<p>For each polynomial in our piecewise function, there is a site (or parameter value) where it starts and ends. Sites where a piece function begins or ends are called <em><a id="index_term298"/><a id="index_term651"/>knots.</em> For the example in Equation (15.13), the values of the knots are 0, 0.5, and 1.</p>
<p>We may also write piecewise polynomial functions as the sum of basis functions, each scaled by a coefficient. For example, we can rewrite the two line segments of Equation (15.13) as</p>
<div class="disp-formula" id="equ15_14">
<m:math display="block"><m:mrow><m:mi mathvariant="bold">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>+</m:mo><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>+</m:mo><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>,</m:mo></m:mrow><m:mspace width="3em"/><m:mo>(15.14)</m:mo></m:math>
</div>
<p>where the function <em>b</em><sub>1</sub>(<em>u</em>) is defined as</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mrow><m:mo>{</m:mo><m:mtable columnalign="left"><m:mtr><m:mtd><m:mi mathvariant="normal">1</m:mi><m:mo>−</m:mo><m:mi mathvariant="normal">2</m:mi><m:mi mathvariant="italic">u</m:mi></m:mtd><m:mtd><m:mi mathvariant="normal">i</m:mi><m:mi mathvariant="normal">f</m:mi><m:mi mathvariant="normal"/><m:mi mathvariant="normal">0</m:mi><m:mo>≤</m:mo><m:mi mathvariant="italic">u</m:mi><m:mo>&lt;</m:mo><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:mfrac><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mi mathvariant="normal">0</m:mi></m:mtd><m:mtd><m:mi mathvariant="normal">o</m:mi><m:mi mathvariant="normal">t</m:mi><m:mi mathvariant="normal">h</m:mi><m:mi mathvariant="normal">e</m:mi><m:mi mathvariant="normal">r</m:mi><m:mi mathvariant="normal">w</m:mi><m:mi mathvariant="normal">i</m:mi><m:mi mathvariant="normal">s</m:mi><m:mi mathvariant="normal">e</m:mi><m:mo>,</m:mo></m:mtd></m:mtr></m:mtable></m:mrow></m:mrow></m:math>
</div>
<p>and <em>b</em><sub>2</sub> and <em>b</em><sub>3</sub> are defined similarly. These functions are plotted in <a href="C20_chapter15.xhtml#f15_4">Figure 15.4(b)</a>.</p>
<p><span aria-label="401" epub:type="pagebreak" id="pg_401" role="doc-pagebreak"/>The knots of a polynomial function are the combination of the knots of all of the pieces that are used to create it. The <em>knot vector</em> is a vector that stores all of the knot values in ascending order.</p>
<p>Notice that in this section we have used two different mechanisms for combining polynomial pieces: using independent polynomial pieces for different ranges of the parameter and blending together piecewise polynomial functions.</p>
</section>
<section>
<h3 id="sec15_4_2"><a id="index_term618"/><span class="green">15.4.2 Using Independent Pieces</span></h3>
<p>In <a href="C20_chapter15.xhtml#sec15_3">Section 15.3</a>, we defined pieces of polynomials over the unit parameter range. If we want to assemble these pieces, we need to convert from the parameter of the overall function to the value of the parameter for the piece. The simplest way to do this is to define the overall curve over the parameter range [0<em>,n</em>] where <em>n</em> is the number of segments. Depending on the value of the parameter, we can shift it to the required range.</p>
</section>
<section>
<h3 id="sec15_4_3"><span class="green">15.4.3 Putting Segments Together</span></h3>
<p>If we want to make a single curve from two <a id="index_term679"/>line segments, we need to make sure that the end of the first line segment is at the same location as the beginning of the next. There are three ways to connect the two segments (in order of simplicity):</p>
<ol class="list-order">
<li>
<p class="list">Represent the line segment as its two endpoints, and then use the same point for both. We call this a <em>shared-point</em> scheme.</p>
</li>
<li>
<p class="list">Copy the value of the end of the first segment to the beginning of the second segment every time that the parameters of the first segment change. We call this a <em>dependency</em> scheme.</p>
</li>
<li>
<p class="list">Write an explicit equation for the connection, and enforce it through numerical methods as the other parameters are changed.</p>
</li>
</ol>
<p>While the simpler schemes are preferable since they require less work, they also place more restrictions on the way the line segments are parameterized. For example, if we want to use the center of the line segment as a parameter (so that the user can specify it directly), we will use the beginning of each line segment and the center of the line segment as their parameters. This will force us to use the dependency scheme.</p>
<p>Notice that if we use a shared-point or dependency scheme, the total number of control points is less than <em>n</em> * <em>m,</em> where <em>n</em> is the number of segments and <em>m</em> <span aria-label="402" epub:type="pagebreak" id="pg_402" role="doc-pagebreak"/>is the number of control points for each segment; many of the control points of the independent pieces will be computed as functions of other pieces. Notice that if we use either the shared-point scheme for lines (each segment uses its two endpoints as parameters and shares interior points with its neighbors), or if we use the dependency scheme (such as the example one with the first endpoint and midpoint), we end up with <em>n</em> + 1 controls for an <em>n</em>-segment curve.</p>
<p>Dependency schemes have a more serious problem. A change in one place in the curve can propagate through the entire curve. This is called a lack of <em>locality.</em>Locality means that if you move a point on a curve it will only affect a local region. The local region might be big, but it will be finite. If a curve’s controls do not have locality, changing a control point may affect points infinitely far away.</p>
<p>To see locality, and the lack thereof, in action, consider two chains of line segments, as shown in <a href="C20_chapter15.xhtml#f15_5">Figure 15.5</a>. One chain has its pieces parameterized by their endpoints and uses point-sharing to maintain continuity. The other has its pieces parameterized by an endpoint and midpoint and uses dependency propagation to keep the segments together. The two segment chains can represent the same curves: they are both a set of <em>n</em> connected line segments. However, because of locality issues, the endpoint-shared form is likely to be more convenient for the user. Consider changing the position of the first control point in each chain. For the endpoint-shared version, only the first segment will change, while all of the segments will be affected in the midpoint version, as in <a href="C20_chapter15.xhtml#f15_5">Figure 15.5</a>. In fact, for any point moved in the endpoint-shared version, at most two line segments will change. In the midpoint version, all segments after the control point that is moved will change, even if the chain is infinitely long.</p>
<figure id="f15_5" tabindex="0">
<img alt="" src="../images/fig15_5.jpg"/>
<figcaption><p><span class="blue">Figure 15.5.</span> A chain of line segments with local control and one with non-local control.</p></figcaption>
</figure>
<p>In this example, the dependency propagation scheme was the one that did not have local control. This is not always true. There are direct sharing schemes that are not local and propagation schemes that are local.</p>
<p>We emphasize that locality is a convenience of control issue. While it is inconvenient to have the entire curve change every time, the same changes can be made to the curve. It simply requires moving several points in unison.</p>
</section>
</section>
<section>
<h2 id="sec15_5"><a id="index_term284"/><a epub:type="backlink" href="C02a_toc.xhtml#rsec15_5" role="doc-backlink"><span class="green">15.5 Cubics</span></a></h2>
<p>In graphics, when we represent curves using piecewise polynomials, we usually use either line segments or cubic polynomials for the pieces. There are a number of reasons why cubics are popular in computer graphics:</p>
<ul class="list-bullet">
<li>
<p class="list">Piecewise cubic polynomials allow for <em>C</em><sup>2</sup> continuity, which is generally sufficient for most visual tasks. The <em>C</em><sup>1</sup> smoothness that quadratics offer is <a id="term-502"/><span aria-label="403" epub:type="pagebreak" id="pg_403" role="doc-pagebreak"/>often insufficient. The greater smoothness offered by higher-order polynomials is rarely important.</p>
</li>
<li>
<p class="list">Cubic curves provide the minimum-curvature interpolants to a set of points. That is, if you have a set of <em>n</em> +3 points and define the “smoothest” curve that passes through them (that is the curve that has the minimum curvature over its length), this curve can be represented as a piecewise cubic with <em>n</em>segments.</p>
</li>
<li>
<p class="list"><span aria-label="404" epub:type="pagebreak" id="pg_404" role="doc-pagebreak"/>Cubic polynomials have a nice symmetry where position and derivative can be specified at the beginning and end.</p>
</li>
<li>
<p class="list">Cubic polynomials have a nice tradeoff between the numerical issues in computation and the smoothness.</p>
</li>
</ul>
<p>Notice that we do not have to use cubics; they just tend to be a good tradeoff between the amount of smoothness and complexity. Different applications may have different tradeoffs. We focus on cubics since they are the most commonly used.</p>
<p>The canonical form of a cubic polynomial is</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mi mathvariant="bold">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mi mathvariant="italic">u</m:mi><m:mo>+</m:mo><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:mo>+</m:mo><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msup><m:mn>.</m:mn></m:mrow></m:math>
</div>
<p>As we discussed in <a href="C20_chapter15.xhtml#sec15_3">Section 15.3</a>, these canonical form coefficients are not a convenient way to describe a cubic segment.</p>
<p>We seek forms of cubic polynomials for which the coefficients are a convenient way to control the resulting curve represented by the cubic. One of the main conveniences will be to provide ways to ensure the connectedness of the pieces and the continuity between the segments.</p>
<p>Each cubic polynomial piece requires four coefficients or control points. That means for a piecewise polynomial with <em>n</em> pieces, we may require up to 4<em>n</em> control points if no sharing between segments is done or dependencies used. More often, some part of each segment is either shared or depends on an adjacent segment, so the total number of control points is much lower. Also, note that a control point might be a position or a derivative of the curve.</p>
<p>Unfortunately, there is no single “best” representation for a piecewise cubic. It is not possible to have a piecewise polynomial curve representation that has all of the following desirable properties:</p>
<ol class="list-order">
<li>
<p class="list">each piece of the curve is a cubic;</p>
</li>
<li>
<p class="list">the curve interpolates the control points;</p>
</li>
<li>
<p class="list">the curve has local control;</p>
</li>
<li>
<p class="list">the curve has <em>C</em><sup>2</sup> continuity.</p>
</li>
</ol>
<p>We can have any three of these properties, but not all four; there are representations that have any combination of three. In this book, we will discuss cubic B-splines that do not interpolate their control points (but have local control and are <em>C</em><sup>2</sup>); Cardinal splines and Catmull-Rom splines that interpolate their control <span aria-label="405" epub:type="pagebreak" id="pg_405" role="doc-pagebreak"/>points and offer local control, but are not <em>C</em><sup>2</sup>; and <a id="index_term772"/>natural cubics that interpolate and are <em>C</em><sup>2</sup>, but do not have local control.</p>
<p>The continuity properties of cubics refer to the continuity between the segments (at the knot points). The cubic pieces themselves have infinite continuity in their derivatives (the way we have been talking about continuity so far). Note that if you have a lot of control points (or knots), the curve can be wiggly, which might not seem “smooth.”</p>
<section>
<h3 id="sec15_5_1"><span class="green">15.5.1 Natural Cubics</span></h3>
<p>With a piecewise cubic curve, it is possible to create a <em>C</em><sup>2</sup> curve. To do this, we need to specify the position and first and second derivative at the beginning of each segment (so that we can make sure that it is the same as at the end of the previous segment). Notice that each curve segment receives three out of its four parameters from the previous curve in the chain. These <em>C</em><sup>2</sup> continuous chains of cubics are sometimes referred to as <em>natural</em> cubic splines.</p>
<p>For one segment of the natural cubic, we need to parameterize the cubic by the positions of its endpoints and the first and second derivative at the beginning point. The control points are therefore</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mi mathvariant="bold">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">0</m:mi><m:mi mathvariant="normal">)</m:mi></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub></m:mtd><m:mtd columnalign="left"><m:mo>+</m:mo></m:mtd><m:mtd columnalign="left"><m:msup><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub></m:mtd><m:mtd columnalign="right"><m:mo>+</m:mo></m:mtd><m:mtd columnalign="left"><m:msup><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub></m:mtd><m:mtd columnalign="left"><m:mo>+</m:mo></m:mtd><m:mtd columnalign="left"><m:msup><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">p</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mi mathvariant="bold">f</m:mi><m:mo>′</m:mo><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">0</m:mi><m:mi mathvariant="normal">)</m:mi></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"/><m:mtd columnalign="left"><m:msup><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub></m:mtd><m:mtd columnalign="right"><m:mo>+</m:mo><m:mn>2</m:mn></m:mtd><m:mtd columnalign="left"><m:msup><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub></m:mtd><m:mtd columnalign="left"><m:mo>+</m:mo><m:mn>3</m:mn></m:mtd><m:mtd columnalign="left"><m:msup><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">p</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msub><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mi mathvariant="bold">f</m:mi><m:mo>"</m:mo><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">0</m:mi><m:mi mathvariant="normal">)</m:mi></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"/><m:mtd columnalign="left"/><m:mtd columnalign="right"><m:mn>2</m:mn></m:mtd><m:mtd columnalign="left"><m:msup><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub></m:mtd><m:mtd columnalign="left"><m:mo>+</m:mo><m:mn>6</m:mn></m:mtd><m:mtd columnalign="left"><m:msup><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">p</m:mi></m:mrow><m:mrow><m:mn>3</m:mn></m:mrow></m:msub><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mi mathvariant="bold">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mn>1</m:mn><m:mi mathvariant="normal">)</m:mi></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mo>+</m:mo></m:mtd><m:mtd columnalign="left"><m:msup><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub></m:mtd><m:mtd columnalign="right"><m:mo>+</m:mo></m:mtd><m:mtd columnalign="left"><m:msup><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub></m:mtd><m:mtd columnalign="left"><m:mo>+</m:mo></m:mtd><m:mtd columnalign="left"><m:msup><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:mn>.</m:mn></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>Therefore, the constraint matrix is</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mtext>C</m:mtext><m:mo>=</m:mo><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mn>1</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>1</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>2</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>1</m:mn></m:mtd><m:mtd><m:mn>1</m:mn></m:mtd><m:mtd><m:mn>1</m:mn></m:mtd><m:mtd><m:mn>1</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow><m:mo>,</m:mo></m:mrow></m:math>
</div>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mi mathvariant="bold">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">0</m:mi><m:mi mathvariant="normal">)</m:mi></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub></m:mtd><m:mtd columnalign="left"><m:mo>+</m:mo></m:mtd><m:mtd columnalign="left"><m:msup><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub></m:mtd><m:mtd columnalign="right"><m:mo>+</m:mo></m:mtd><m:mtd columnalign="left"><m:msup><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub></m:mtd><m:mtd columnalign="left"><m:mo>+</m:mo></m:mtd><m:mtd columnalign="left"><m:msup><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">p</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mi mathvariant="bold">f</m:mi><m:mo>′</m:mo><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">0</m:mi><m:mi mathvariant="normal">)</m:mi></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"/><m:mtd columnalign="left"><m:msup><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub></m:mtd><m:mtd columnalign="right"><m:mo>+</m:mo><m:mn>2</m:mn></m:mtd><m:mtd columnalign="left"><m:msup><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub></m:mtd><m:mtd columnalign="left"><m:mo>+</m:mo><m:mn>3</m:mn></m:mtd><m:mtd columnalign="left"><m:msup><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">p</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msub><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mi mathvariant="bold">f</m:mi><m:mo>"</m:mo><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">0</m:mi><m:mi mathvariant="normal">)</m:mi></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"/><m:mtd columnalign="left"/><m:mtd columnalign="right"><m:mn>2</m:mn></m:mtd><m:mtd columnalign="left"><m:msup><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub></m:mtd><m:mtd columnalign="left"><m:mo>+</m:mo><m:mn>6</m:mn></m:mtd><m:mtd columnalign="left"><m:msup><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="normal">p</m:mi></m:mrow><m:mrow><m:mn>3</m:mn></m:mrow></m:msub><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mi mathvariant="bold">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mn>1</m:mn><m:mi mathvariant="normal">)</m:mi></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mo>+</m:mo></m:mtd><m:mtd columnalign="left"><m:msup><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub></m:mtd><m:mtd columnalign="right"><m:mo>+</m:mo></m:mtd><m:mtd columnalign="left"><m:msup><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub></m:mtd><m:mtd columnalign="left"><m:mo>+</m:mo></m:mtd><m:mtd columnalign="left"><m:msup><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:mn>.</m:mn></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>and the basis matrix is</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mi mathvariant="bold">B</m:mi><m:mo>=</m:mo><m:msup><m:mrow><m:mi mathvariant="bold">C</m:mi></m:mrow><m:mrow><m:mo mathvariant="bold">−</m:mo><m:mn mathvariant="bold">1</m:mn></m:mrow></m:msup><m:mo>=</m:mo><m:mrow><m:mo>[</m:mo><m:mtable columnalign="right"><m:mtr><m:mtd><m:mn>1</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>1</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>.5</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mo>−</m:mo><m:mn>1</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>1</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>.5</m:mn></m:mtd><m:mtd><m:mn>1</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow><m:mn>.</m:mn></m:mrow></m:math>
</div>
<p>Given a set of <em>n</em> control points, a natural cubic spline has <em>n</em> − 1 cubic segments. The first segment uses the control points to define its beginning position, ending position, and first and second derivative at the beginning. A dependency scheme <a id="term-229"/><a id="term-396"/><span aria-label="406" epub:type="pagebreak" id="pg_406" role="doc-pagebreak"/> copies the position, and first and second derivative of the end of the first segment for use in the second segment.</p>
<p>A disadvantage of natural cubic splines is that they are not local. Any change in any segment may require the entire curve to change (at least the part after the change was made). To make matters worse, natural cubic splines tend to be ill-conditioned: a small change at the beginning of the curve can lead to large changes later. Another issue is that we only have control over the derivatives of the curve at its beginning. Segments after the beginning of the curve determine their derivatives from their beginning point.</p>
</section>
<section>
<h3 id="sec15_5_2"><span class="green">15.5.2 Hermite Cubics</span></h3>
<p>Hermite cubic polynomials were introduced in <a href="C20_chapter15.xhtml#sec15_3_4">Section 15.3.4</a>. A segment of a cubic Hermite spline allows the positions and first derivatives of both of its endpoints to be specified. A chain of segments can be linked into a <em>C</em><sup>1</sup> spline by using the same values for the position and derivative of the end of one segment and for the beginning of the next.</p>
<p>Given a set of <em>n</em> control points, where every other control point is a derivative value, a cubic Hermite spline contains (<em>n</em> − 2)<em>/</em>2 cubic segments. The spline interpolates the points, as shown in <a href="C20_chapter15.xhtml#f15_6">Figure 15.6</a>, but can guarantee only <em>C</em><sup>1</sup> continuity.</p>
<figure id="f15_6" tabindex="0">
<img alt="" src="../images/fig15_6.jpg"/>
<figcaption><p><span class="blue">Figure 15.6.</span> A Hermite cubic spline made up of three segments.</p></figcaption>
</figure>
<p><a id="index_term520"/>Hermite cubics are convenient because they provide local control over the shape, and provide <em>C</em><sup>1</sup> continuity. However, since the user must specify both positions and derivatives, a special interface for the derivatives must be provided. One possibility is to provide the user with points that represent where the derivative vectors would end if they were “placed” at the position point.</p>
</section>
<section>
<h3 id="sec15_5_3"><a id="index_term124"/><span class="green">15.5.3 Cardinal Cubics</span></h3>
<p>A <em>cardinal cubic spline</em> is a type of <em>C</em><sup>1</sup> interpolating spline made up of cubic polynomial segments. Given a set of <em>n</em> control points, a cardinal cubic spline uses <a id="term-80"/><a id="term-85"/><span aria-label="407" epub:type="pagebreak" id="pg_407" role="doc-pagebreak"/><em>n</em> – 2 cubic polynomial segments to interpolate all of its points except for the first and last.</p>
<p><a id="index_term125"/>Cardinal splines have a parameter called <em>tension</em> that controls how “tight” the curve is between the points it interpolates. The tension is a number in the range [0, 1) that controls how the curve bends toward the next control point. For the important special case of <em>t</em> = 0, the splines are called <em>Catmull-Rom</em> splines.</p>
<p>Each segment of the cardinal spline uses four control points. For segment <em>i</em>, the points used are <em>i</em>, <em>i</em> + 1, <em>i</em> + 2, and <em>i</em> + 3 as the segments share three points with their neighbors. Each segment begins at its second control point and ends at its third control point. The derivative at the beginning of the curve is determined by the vector between the first and third control points, while the derivative at the end of the curve is given by the vector between the second and fourth points, as shown in <a href="C20_chapter15.xhtml#f15_7">Figure 15.7</a>.</p>
<figure id="f15_7" tabindex="0">
<img alt="" src="../images/fig15_7.jpg"/>
<figcaption><p><span class="blue">Figure 15.7.</span> Asegment of a cardinal cubic spline interpolates its second and third control points (<strong>p</strong><sub>2</sub> and <strong>p</strong><sub>3</sub>), and uses its other points to determine the derivatives at the beginning and end.</p></figcaption>
</figure>
<p>The tension parameter adjusts how much the derivatives are scaled. Specifically, the derivatives are scaled by (1 − <em>t</em>)<em>/</em>2. The constraints on the cubic are therefore</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mtable><m:mtr><m:mtd><m:mi mathvariant="bold">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">0</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mi mathvariant="bold">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mi mathvariant="bold">f</m:mi><m:mo>′</m:mo><m:mi mathvariant="normal">(</m:mi><m:mn>0</m:mn><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mfrac><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>1</m:mn><m:mo>−</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mn>3</m:mn></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub><m:mo>)</m:mo></m:mrow><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mi mathvariant="bold">f</m:mi><m:mo>′</m:mo><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mfrac><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>1</m:mn><m:mo>−</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mn>4</m:mn></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msub><m:mo>)</m:mo><m:mn>.</m:mn></m:mrow></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>Solving these equations for the control points (defining <em>s</em> = (1 − <em>t</em>)<em>/</em>2)gives</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mi mathvariant="bold">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>−</m:mo><m:mfrac><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">t</m:mi></m:mrow></m:mfrac><m:mi mathvariant="bold">f</m:mi><m:mi>′</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">0</m:mi><m:mi mathvariant="normal">)</m:mi></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub></m:mtd><m:mtd columnalign="left"><m:mo>+</m:mo><m:mrow><m:mo>(</m:mo><m:mi mathvariant="normal">1</m:mi><m:mo>−</m:mo><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">s</m:mi></m:mrow></m:mfrac><m:mo>)</m:mo></m:mrow></m:mtd><m:mtd columnalign="left"><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub></m:mtd><m:mtd columnalign="left"><m:mo>+</m:mo></m:mtd><m:mtd columnalign="left"><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub></m:mtd><m:mtd columnalign="left"><m:mo>+</m:mo></m:mtd><m:mtd columnalign="left"><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mi mathvariant="bold">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">0</m:mi><m:mi mathvariant="normal">)</m:mi></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mo>,</m:mo></m:mtd><m:mtd columnalign="left"/><m:mtd columnalign="left"/><m:mtd columnalign="left"/><m:mtd columnalign="left"/><m:mtd columnalign="left"/><m:mtd columnalign="left"/></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mi mathvariant="bold">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal">)</m:mi></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub></m:mtd><m:mtd columnalign="left"><m:mo>+</m:mo></m:mtd><m:mtd columnalign="left"><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub></m:mtd><m:mtd columnalign="left"><m:mo>+</m:mo></m:mtd><m:mtd columnalign="left"><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub></m:mtd><m:mtd columnalign="left"><m:mo>+</m:mo></m:mtd><m:mtd columnalign="left"><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mn>3</m:mn></m:mrow></m:msub><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mi mathvariant="bold">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">0</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>+</m:mo><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">s</m:mi></m:mrow></m:mfrac><m:mi mathvariant="bold">f</m:mi><m:mi>′</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal">)</m:mi></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub></m:mtd><m:mtd columnalign="left"><m:mo>+</m:mo><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">s</m:mi></m:mrow></m:mfrac></m:mtd><m:mtd columnalign="left"><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub></m:mtd><m:mtd columnalign="left"><m:mo>+</m:mo><m:mi mathvariant="normal">2</m:mi><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">s</m:mi></m:mrow></m:mfrac></m:mtd><m:mtd columnalign="left"><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub></m:mtd><m:mtd columnalign="left"><m:mo>+</m:mo><m:mi mathvariant="normal">3</m:mi><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">s</m:mi></m:mrow></m:mfrac></m:mtd><m:mtd columnalign="left"><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">.</m:mi></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>This yields the cardinal matrix</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mi mathvariant="bold">B</m:mi><m:mo>=</m:mo><m:msup><m:mrow><m:mi mathvariant="bold">C</m:mi></m:mrow><m:mrow><m:mo mathvariant="bold">−</m:mo><m:mi mathvariant="bold">1</m:mi></m:mrow></m:msup><m:mo>=</m:mo><m:mrow><m:mo>[</m:mo><m:mtable columnalign="right"><m:mtr><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>1</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mo>−</m:mo><m:mi>s</m:mi></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mi>s</m:mi></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>2</m:mn><m:mi>s</m:mi></m:mtd><m:mtd><m:mi>s</m:mi><m:mo>−</m:mo><m:mn>3</m:mn></m:mtd><m:mtd><m:mn>3</m:mn><m:mo>−</m:mo><m:mn>3</m:mn><m:mi>s</m:mi></m:mtd><m:mtd><m:mo>−</m:mo><m:mi>s</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:mo>−</m:mo><m:mi>s</m:mi></m:mtd><m:mtd><m:mn>2</m:mn><m:mo>−</m:mo><m:mi>s</m:mi></m:mtd><m:mtd><m:mi>s</m:mi><m:mo>−</m:mo><m:mn>2</m:mn></m:mtd><m:mtd><m:mi>s</m:mi></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow><m:mn>.</m:mn></m:mrow></m:math>
</div>
<p>Since the third point of segment <em>i</em> is the second point of segment <em>i</em>+ 1, adjacent segments of the cardinal spline connect. Similarly, the same points are used to specify the first derivative of each segment, providing <em>C</em><sup>1</sup> continuity.</p>
<p>Cardinal splines are useful, because they provide an easy way to interpolate a set of points with <em>C</em><sup>1</sup> continuity and local control. They are only <em>C</em><sup>1</sup>, so they sometimes get “kinks” in them. The tension parameter gives some control over what happens between the interpolated points, as shown in <a href="C20_chapter15.xhtml#f15_8">Figure 15.8</a>, where a<a id="term-81"/><span aria-label="408" epub:type="pagebreak" id="pg_408" role="doc-pagebreak"/>set of cardinal splines through a set of points is shown. The curves use the same control points, but they use different values for the tension parameters. Note that the first and last control points are not interpolated.</p>
<figure id="f15_8" tabindex="0">
<img alt="" src="../images/fig15_8.jpg"/>
<figcaption><p><span class="blue">Figure 15.8.</span> Cardinal splines through seven control points with varying values of tension parameter <em>t</em>.</p></figcaption>
</figure>
<p>Given a set of <em>n</em> points to interpolate, you might wonder why we might prefer to use a cardinal cubic spline (that is a set of <em>n</em> − 2 cubic pieces) rather than a single, order <em>n</em> polynomial as described in <a href="C20_chapter15.xhtml#sec15_3_6">Section 15.3.6</a>. Some of the disadvantages of the interpolating polynomial are:</p>
<ul class="list-bullet">
<li>
<p class="list">The interpolating polynomial tends to overshoot the points, as seen in <a href="C20_chapter15.xhtml#f15_9">Figure 15.9</a>. This overshooting gets worse as the number of points grows larger. The cardinal splines tend to be well behaved in between the points.</p>
<figure id="f15_9" tabindex="0">
<img alt="" src="../images/fig15_9.jpg"/>
<figcaption><p><span class="blue">Figure 15.9.</span> Splines interpolating nine control points (marked with small crosses). The thick orange line shows an interpolating polynomial. The thin line shows a Catmull-Rom spline. The latter is made of seven cubic segments, which are each shown in alternating blue tones.</p></figcaption>
</figure>
</li>
<li>
<p class="list">Control of the interpolating polynomial is not local. Changing a point at the beginning of the spline affects the entire spline. Cardinal splines are local: any place on the spline is affected by its four neighboring points at most.</p>
</li>
<li>
<p class="list">Evaluation of the interpolating polynomial is not local. Evaluating a point on the polynomial requires access to all of its points. Evaluating a point on the piecewise cubic requires a fixed small number of computations, no matter how large the total number of points is.</p>
</li>
</ul>
<p>There are a variety of other numerical and technical issues in using interpolating splines as the number of points grows larger. See De Boor (2001) for more information.</p>
<p>A cardinal spline has the disadvantage that it does not interpolate the first or last point, which can be easily fixed by adding an extra point at either end of the sequence. The cardinal spline also is not as continuous–providing only <em>C</em><sup>1</sup> continuity at the knots.</p>
</section>
</section>
<section>
<h2 id="sec15_6"><a id="index_term286"/><a id="term-86"/><a id="term-239"/><span aria-label="409" epub:type="pagebreak" id="pg_409" role="doc-pagebreak"/><a epub:type="backlink" href="C02a_toc.xhtml#rsec15_6" role="doc-backlink"><span class="green">15.6 Approximating Curves</span></a></h2>
<p>It might seem like the easiest way to control a curve is to specify a set of points for it to interpolate. In practice, however, interpolation schemes often have undesirable properties because they have less continuity and offer no control of what happens between the points. Curve schemes that only approximate the points are often preferred. With an approximating scheme, the control points influence the shape of the curve, but do not specify it exactly. Although we give up the ability to directly specify points for the curve to pass through, we gain better behavior of the curve and local control. Should we need to interpolate a set of points, the positions of the control points can be computed such that the curve passes through these interpolation points.</p>
<p>The two most important types of approximating curves in computer graphics are <a id="index_term290"/>Bézier curves and B-spline curves.</p>
<section>
<h3 id="sec15_6_1"><span class="green">15.6.1 Bézier Curves</span></h3>
<p>Bézier curves are one of the most common representations for free-form curves in computer graphics. The curves are named for Pierre Bézier, one of the people who was instrumental in their development. Bézier curves have an interesting history where they were concurrently developed by several independent groups.</p>
<p>ABézier curve is a polynomial curve that approximates its control points. The curves can be a polynomial of any degree. A curve of degree <em>d</em> is controlled by <em>d</em> + 1 control points. The curve interpolates its first and last control points, and the shape is directly influenced by the other points.</p>
<p>Often, complex shapes are made by connecting a number of Bézier curves of low degree, and in computer graphics, cubic (<em>d</em> = 3)Bézier curves are commonly used for this purpose. Many popular illustration programs, such as Adobe Illus-trator<a id="term-42"/><a id="term-240"/><span aria-label="410" epub:type="pagebreak" id="pg_410" role="doc-pagebreak"/>, and font representation schemes, such as that used in Postscript, use cubic Bézier curves. Bézier curves are extremely popular in computer graphics because they are easy to control, have a number of useful properties, and there are very efficient algorithms for working with them.</p>
<p>Bézier curves are constructed such that:</p>
<ul class="list-bullet">
<li>
<p class="list">The curve interpolates the first and last control points, with <em>u</em> = 0 and 1, respectively.</p>
</li>
<li>
<p class="list">The first derivative of the curve at its beginning (end) is determined by the vector between the first and second (next to last and last) control points. The derivatives are given by the vectors between these points scaled by the degree of the curve.</p>
</li>
<li>
<p class="list">Higher derivatives at the beginning (end) of the curve depend on the points at the beginning (end) of the curve. The <em>n<sup>th</sup></em> derivative depends on the first (last) <em>n</em> + 1 points.</p>
</li>
</ul>
<p>For example, consider the Bézier curve of degree 3 (cubic) as in <a href="C20_chapter15.xhtml#f15_10">Figure 15.10</a>. The curve has four (<em>d</em> + 1) control points. It begins at the first control point (<strong>p</strong><sub>0</sub>) and ends at the last (<strong>p</strong><sub>1</sub>). The first derivative at the beginning is proportional to the vector between the first and second control points (<strong>p</strong><sub>1</sub> − <strong>p</strong><sub>0</sub>). Specifically, <strong>f</strong><sup>'</sup>(0) = 3(<strong>p</strong><sub>1</sub> − <strong>p</strong><sub>0</sub>). Similarly, the first derivative at the end of the curve is given by <strong>f</strong><sup>'</sup>(1) = 3(<strong>p</strong><sub>3</sub> − <strong>p</strong><sub>2</sub>). The second derivative at the beginning of the curve can be determined from control points <strong>p</strong><sub>0</sub>, <strong>p</strong><sub>1</sub> and <strong>p</strong><sub>2</sub>.</p>
<figure id="f15_10" tabindex="0">
<img alt="" src="../images/fig15_10.jpg"/>
<figcaption><p><span class="blue">Figure 15.10.</span> A cubic Bézier curve is controlled by four points. It interpolates the first and last, and the beginning and final derivatives are three times the vectors between the first two (or last two) points.</p></figcaption>
</figure>
<p>Using the facts about Bézier cubics in the preceding paragraph, we can use the methods of <a href="C20_chapter15.xhtml#sec15_5">Section 15.5</a> to create a parametric function for them. The definitions <span aria-label="411" epub:type="pagebreak" id="pg_411" role="doc-pagebreak"/>of the beginning and end interpolation and derivatives give</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mtable><m:mtr><m:mtd columnalign="right"><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mo>=</m:mo></m:mtd><m:mtd columnalign="right"><m:mi mathvariant="bold">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">0</m:mi><m:mi mathvariant="normal">)</m:mi></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:msup><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msup><m:mo>+</m:mo><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:msup><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:mo>+</m:mo><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">0</m:mi><m:mo>+</m:mo><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd columnalign="right"><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:mo>=</m:mo></m:mtd><m:mtd columnalign="right"><m:mi mathvariant="bold">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal">)</m:mi></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:msup><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msup><m:mo>+</m:mo><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:msup><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:mo>+</m:mo><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">1</m:mi><m:mo>+</m:mo><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd columnalign="right"><m:mi mathvariant="normal">3</m:mi><m:mi mathvariant="normal"/><m:mi mathvariant="normal">(</m:mi><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo></m:mtd><m:mtd columnalign="right"><m:mi mathvariant="bold">f</m:mi><m:mi>′</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">0</m:mi><m:mi mathvariant="normal">)</m:mi><m:mi mathvariant="normal"/></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo><m:mi mathvariant="normal">3</m:mi><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:msup><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:mo>+</m:mo><m:mi mathvariant="normal">2</m:mi><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">0</m:mi><m:mo>+</m:mo><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd columnalign="right"><m:mi mathvariant="normal">3</m:mi><m:mi mathvariant="normal"/><m:mi mathvariant="normal">(</m:mi><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo></m:mtd><m:mtd columnalign="right"><m:mi mathvariant="bold">f</m:mi><m:mi>′</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal">)</m:mi></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo><m:mi mathvariant="normal">3</m:mi><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:msup><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:mo>+</m:mo><m:mi mathvariant="normal">2</m:mi><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">1</m:mi><m:mo>+</m:mo><m:msub><m:mrow><m:mi mathvariant="bold">a</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">.</m:mi></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>This can be solved for the basis matrix</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mi mathvariant="bold">B</m:mi><m:mo>=</m:mo><m:msup><m:mrow><m:mi mathvariant="bold">C</m:mi></m:mrow><m:mrow><m:mo mathvariant="bold">−</m:mo><m:mi mathvariant="bold">1</m:mi></m:mrow></m:msup><m:mo>=</m:mo><m:mrow><m:mo>[</m:mo><m:mtable columnalign="right"><m:mtr><m:mtd><m:mn>1</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mo>−</m:mo><m:mn>3</m:mn></m:mtd><m:mtd><m:mn>3</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>3</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>6</m:mn></m:mtd><m:mtd><m:mn>3</m:mn></m:mtd><m:mtd><m:mo>−</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mo>−</m:mo><m:mn>1</m:mn></m:mtd><m:mtd><m:mn>3</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>3</m:mn></m:mtd><m:mtd><m:mn>1</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow><m:mo>,</m:mo></m:mrow></m:math>
</div>
<p>and then written as</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mi mathvariant="bold">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">1</m:mi><m:mo>−</m:mo><m:mi mathvariant="normal">3</m:mi><m:mi mathvariant="italic">u</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">3</m:mi><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:mo>−</m:mo><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msup><m:mi mathvariant="normal">)</m:mi><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">3</m:mi><m:mi mathvariant="italic">u</m:mi><m:mo>−</m:mo><m:mi mathvariant="normal">6</m:mi><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:mo>+</m:mo><m:mi mathvariant="normal">3</m:mi><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msup><m:mi mathvariant="normal">)</m:mi><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">3</m:mi><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:mo>−</m:mo><m:mi mathvariant="normal">3</m:mi><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msup><m:mi mathvariant="normal">)</m:mi><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:mi mathvariant="normal">(</m:mi><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msup><m:mi mathvariant="normal">)</m:mi><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:mo>,</m:mo></m:mrow></m:math>
</div>
<p>or</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mi mathvariant="bold">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:munderover><m:mrow><m:mstyle displaystyle="true" mathvariant="normal"><m:mo>∑</m:mo></m:mstyle></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal">0</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">d</m:mi></m:mrow></m:munderover><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi></m:mrow></m:msub><m:mo>,</m:mo></m:mrow></m:math>
</div>
<p>where the <em>b</em><sub><em>i,</em>3</sub> are the Bézier blending functions of degree 3:</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">1</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">u</m:mi><m:msup><m:mrow><m:mi mathvariant="normal">)</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msup><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mi mathvariant="normal"/><m:mi mathvariant="normal">3</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">1</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">u</m:mi><m:msup><m:mrow><m:mi mathvariant="normal">)</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mi mathvariant="normal">3</m:mi><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">1</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msup><m:mi mathvariant="normal">.</m:mi></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>Fortunately, the blending functions for Bézier curves have a special form that works for all degrees. These functions are known as the <em>Bernstein basis polynomials</em> and have the general form</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">k</m:mi><m:mo>,</m:mo><m:mi mathvariant="italic">n</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mi mathvariant="italic">C</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">n</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal"/><m:mi mathvariant="italic">k</m:mi><m:mi mathvariant="normal">)</m:mi><m:mtext> </m:mtext><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">k</m:mi></m:mrow></m:msup><m:mtext> </m:mtext><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">1</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">u</m:mi><m:msup><m:mrow><m:mi mathvariant="normal">)</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">n</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">k</m:mi><m:mi mathvariant="normal">)</m:mi></m:mrow></m:msup><m:mo>,</m:mo></m:mrow></m:math>
</div>
<p>where <em>n</em> is the order of the Bézier curve, and <em>k</em> is the blending function number between 0 and <em>n</em> (inclusive). <em>C</em>(<em>n, k</em>) are the binomial coefficients:</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mi>C</m:mi><m:mrow><m:mo>(</m:mo><m:mi>n</m:mi><m:mo>,</m:mo><m:mi>k</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mfrac><m:mrow><m:mi>n</m:mi><m:mo>!</m:mo></m:mrow><m:mrow><m:mi>k</m:mi><m:mo>!</m:mo><m:mrow><m:mo>(</m:mo><m:mi>n</m:mi><m:mo>−</m:mo><m:mi>k</m:mi><m:mo>)</m:mo></m:mrow><m:mo>!</m:mo></m:mrow></m:mfrac><m:mn>.</m:mn></m:mrow></m:math>
</div>
<p>Given the positions of the control points <strong>p</strong><em><sub>k</sub></em>, the function to evaluate the Bézier curve of order <em>n</em> (with <em>n</em> + 1 control points) is</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mi mathvariant="bold">p</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:munderover><m:mrow><m:mstyle displaystyle="true" mathvariant="normal"><m:mo>∑</m:mo></m:mstyle></m:mrow><m:mrow><m:mi mathvariant="italic">k</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal">0</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">n</m:mi></m:mrow></m:munderover><m:msub><m:mrow><m:mi mathvariant="italic">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">k</m:mi></m:mrow></m:msub><m:mi mathvariant="italic">C</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">n</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal"/><m:mi mathvariant="italic">k</m:mi><m:mi mathvariant="normal">)</m:mi><m:mtext> </m:mtext><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">k</m:mi></m:mrow></m:msup><m:mtext> </m:mtext><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">1</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">u</m:mi><m:msup><m:mrow><m:mi mathvariant="normal">)</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">n</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">k</m:mi><m:mi mathvariant="normal">)</m:mi></m:mrow></m:msup><m:mi mathvariant="normal">.</m:mi></m:mrow></m:math>
</div>
<p>Some Bézier segments are shown in <a href="C20_chapter15.xhtml#f15_11">Figure 15.11</a>.</p>
<figure id="f15_11" tabindex="0">
<img alt="" src="../images/fig15_11.jpg"/>
<figcaption><p><span class="blue">Figure 15.11.</span> <a id="term-43"/><a id="term-241"/><span aria-label="412" epub:type="pagebreak" id="pg_412" role="doc-pagebreak"/>Various Bézier segments of degree 2–6. The control points are shown with crosses, and the control polygons (line segments connecting the control points) are also shown.</p></figcaption>
</figure>
<p>Bézier segments have several useful properties:</p>
<ul class="list-bullet">
<li>
<p class="list">The curve is bounded by the convex hull of the control points.</p>
</li>
<li>
<p class="list">Any line intersects the curve no more times than it intersects the set of line segments connecting the control points. This is called the <em>variation diminishing</em> property. This property is illustrated in <a href="C20_chapter15.xhtml#f15_12">Figure 15.12</a>.</p>
<figure id="f15_12" tabindex="0">
<img alt="" src="../images/fig15_12.jpg"/>
<figcaption><p><span class="blue">Figure 15.12.</span> The <em>variation diminishing</em> property of Bézier curves means that the curve does not cross a line more than its control polygon does. Therefore, if the control polygon has no “wiggles,” the curve will not have them either. B-splines (<a href="C20_chapter15.xhtml#sec15_6_2">Section 15.6.2</a>) also have this property.</p></figcaption>
</figure>
</li>
<li>
<p class="list">The curves are symmetric: reversing the order of the control points yields the same curve, with a reversed parameterization.</p>
</li>
<li>
<p class="list">The curves are <em>affine invariant.</em> This means that translating, scaling, rotating, or skewing the control points is the same as performing those operations on the curve itself.</p>
</li>
<li>
<p class="list">There are good simple algorithms for evaluating and subdividing Bézier curves into pieces that are themselves Bézier curves. Because subdivision <a id="term-44"/><a id="term-242"/><a id="term-254"/><a id="term-255"/><span aria-label="413" epub:type="pagebreak" id="pg_413" role="doc-pagebreak"/>can be done effectively using the algorithm described later, a divide and conquer approach can be used to create effective algorithms for important tasks such as rendering Bézier curves, approximating them with line segments, and determining the intersection between two curves.</p>
</li>
</ul>
<p>When Bézier segments are connected together to make a spline, connectivity between the segments is created by sharing the endpoints. However, continuity of the derivatives must be created by positioning the other control points. This provides the user of a Bézier spline with control over the smoothness. For <em>G</em><sup>1</sup> continuity, the second-to-last point of the first curve and the second point of the second curve must be collinear with the equated endpoints. For <em>C</em><sup>1</sup> continuity, the distances between the points must be equal as well. This is illustrated in <a href="C20_chapter15.xhtml#f15_13">Figure 15.13</a>. Higher degrees of continuity can be created by properly positioning more points.</p>
<figure id="f15_13" tabindex="0">
<img alt="" src="../images/fig15_13.jpg"/>
<figcaption><p><span class="blue">Figure 15.13.</span> Two Bézier segments connect to form a <em>C</em><sup>1</sup> spline, because the vector between the last two points of the first segment is equal to the vector between the first two points of the second segment.</p></figcaption>
</figure>
<section>
<h4 id="sec59"><span class="blue">Geometric Intuition for Bézier Curves</span></h4>
<p>Bézier curves can be derived from geometric principles, as well as from the algebraic methods described above. We outline the geometric principles because they provides intuition on how Bézier curves work.</p>
<p>Imagine that we have a set of control points from which we want to create a <a id="index_term305"/>smooth curve. Simply connecting the points with lines (to form the control polygon) will lead to something that is non-smooth. It will have sharp corners. We could imagine “smoothing” this polygon by cutting off the sharp corners, yielding a new polygon that is smoother, but still not “smooth” in the mathematical sense (since the curve is still a polygon, and therefore only <em>C</em><sup>1</sup>). We can repeat this process, each time yielding a smoother polygon, as shown in <a href="C20_chapter15.xhtml#f15_14">Figure 15.14</a>. In the limit, that is if we repeated the process infinitely many times, we would obtain a <em>C</em><sup>1</sup> smooth curve.</p>
<figure id="f15_14" tabindex="0">
<img alt="" src="../images/fig15_14.jpg"/>
<figcaption><p><span class="blue">Figure 15.14.</span> Subdivision procedure for quadratic Béziers. Each line segment is divided in half and these midpoints are connected (blue points and lines). The interior control point is moved to the midpoint of the new line segment (orange point).</p></figcaption>
</figure>
<p><a id="term-252"/><span aria-label="414" epub:type="pagebreak" id="pg_414" role="doc-pagebreak"/>What we have done with corner cutting is defining a <em>subdivision</em> scheme. That is, we have defined curves by a process for breaking a simpler curve into smaller pieces (e.g., subdividing it). The resulting curve is the <em>limit curve</em> that is achieved by applying the process infinitely many times. If the subdivision scheme is defined correctly, the result will be a smooth curve, and it will have a parametric form.</p>
<p>Let us consider applying corner cutting to a single corner. Given three points (<strong>p</strong><sub>0</sub>, <strong>p</strong><sub>1</sub>, <strong>p</strong><sub>2</sub>), we repeatedly “cut off the corners” as shown in <a href="C20_chapter15.xhtml#f15_15">Figure 15.15</a>. At each step, we divide each line segment in half, connect the midpoints, and then move the corner point to the midpoint of the new line segment. Note that in this process, new points are introduced, moved once, and then remain in this position for any remaining iterations. The endpoints never move.</p>
<figure id="f15_15" tabindex="0">
<img alt="" src="../images/fig15_15.jpg"/>
<figcaption><p><span class="blue">Figure 15.15.</span> By repeatedly cutting the corners off a polygon, we approach a smooth curve.</p></figcaption>
</figure>
<p>If we compute the “new” position for <strong>p</strong><sub>2</sub> as the midpoint of the midpoints, we get the expression</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:msubsup><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow><m:mrow><m:mo>′</m:mo></m:mrow></m:msubsup><m:mo>=</m:mo><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:mfrac><m:mi mathvariant="normal">(</m:mi><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:mfrac><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:mfrac><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">)</m:mi><m:mo>+</m:mo><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:mfrac><m:mi mathvariant="normal">(</m:mi><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:mfrac><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:mfrac><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">)</m:mi><m:mn>.</m:mn></m:mrow></m:math>
</div>
<p>The construction actually works for other proportions of distance along each segment. If we let <em>u</em> be the distance between the beginning and the end of each segment where we place the middle point, we can rewrite this expression as</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mi mathvariant="bold">p</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">1</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">1</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:mi mathvariant="italic">u</m:mi><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">)</m:mi><m:mo>+</m:mo><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">1</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:mi mathvariant="italic">u</m:mi><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">)</m:mi><m:mn>.</m:mn></m:mrow></m:math>
</div>
<p>Regrouping terms gives the quadratic Bézier function:</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:msub><m:mrow><m:mi mathvariant="bold">B</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">1</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">u</m:mi><m:msup><m:mrow><m:mi mathvariant="normal">)</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">0</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:mi mathvariant="normal">2</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">1</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">.</m:mi></m:mrow></m:math>
</div>
</section>
<section>
<h4 id="sec60"><a id="index_term310"/><span class="blue">The de Casteljau Algorithm</span></h4>
<p>One nice feature of Bézier curves is that there is a very simple and general method for computing and subdividing them. The method, called the <em>de Casteljau algorithm,</em> uses a sequence of linear interpolations to compute the positions along the <a id="term-256"/><span aria-label="415" epub:type="pagebreak" id="pg_415" role="doc-pagebreak"/>Bézier curve of arbitrary order. It is the generalization of the subdivision scheme described in the previous section.</p>
<p>The de Casteljau algorithm begins by connecting every adjacent set of points with lines, and finding the point on these lines that is the <em>u</em> interpolation, giving a set of <em>n</em> − 1 points. These points are then connected with straight lines, those lines are interpolated (again by <em>u</em>), giving a set of <em>n</em> − 2 points. This process is repeated until there is one point. An illustration of this process is shown in <a href="C20_chapter15.xhtml#f15_16">Figure 15.16</a>.</p>
<figure id="f15_16" tabindex="0">
<img alt="" src="../images/fig15_16.jpg"/>
<figcaption><p><span class="blue">Figure 15.16.</span> An illustration of the de Casteljau algorithm for a cubic Bézier. The left-hand image shows the construction for <em>u</em> = 0.5. The right-hand image shows the construction for 0.25, 0.5, and 0.75.</p></figcaption>
</figure>
<p>The process of computing a point on a Bézier segment also provides a method for dividing the segment at the point. The intermediate points computed during the de Casteljau algorithm form the new control points of the new, smaller segments, as shown in <a href="C20_chapter15.xhtml#f15_17">Figure 15.17</a>.</p>
<figure id="f15_17" tabindex="0">
<img alt="" src="../images/fig15_17.jpg"/>
<figcaption><p><span class="blue">Figure 15.17.</span> The de Casteljau algorithm is used to subdivide a cubic Bézier segment. The initial points (black diamonds A, B, C, and D) are linearly interpolated to yield blue circles (AB, BC, CD), which are linearly interpolated to yield orange circles (AC, BD), which are linearly interpolated to give the point on the cubic AD. This process also has subdivided the Bézier segment with control points A,B,C,D into two Bézier segments with control points A, AB, AC, AD and AD, BD, CD, D.</p></figcaption>
</figure>
<p>The existence of a good algorithm for dividing Bézier curves makes divide-and-conquer algorithms possible. For example, when drawing a Bézier curve <a id="term-231"/><span aria-label="416" epub:type="pagebreak" id="pg_416" role="doc-pagebreak"/>segment, it is easy to check if the curve is close to being a straight line because it is bounded by its convex hull. If the control points of the curve are all close to being colinear, the curve can be drawn as a straight line. Otherwise, the curve can be divided into smaller pieces, and the process can be repeated. Similar algorithms can be used for determining the intersection between two curves. Because of the existence of such algorithms, other curve representations are often converted to Bézier form for processing.</p>
</section>
</section>
<section>
<h3 id="sec15_6_2"><a id="index_term288"/><span class="green">15.6.2 B-Splines</span></h3>
<p>B-splines provide a method for approximating a set of <em>n</em> points with a curve made up of polynomials of degree <em>d</em> that gives <em>C</em><sup>(<em>d</em>−1)</sup> continuity. Unlike the Bézier splines of the previous section, B-splines allow curves to be generated for any desired degree of continuity (almost up to the number of points). Because of this, B-splines are a preferred way to specify very smooth curves (high degrees of continuity) in computer graphics. If we want a <em>C</em><sup>2</sup> or higher curve through an arbitrary number of points, B-splines are probably the right method.</p>
<p>We can represent a curve using a linear combination of B-spline basis functions. Since these basis functions are themselves splines, we call them basis splines or B-splines for short. Each B-spline or basis function is made up of a set of <em>d</em> + 1 polynomials each of degree <em>d</em>. The methods of B-splines provide general procedures for defining these functions.</p>
<p>The term B-spline specifically refers to one of the basis functions, not the function created by the linear combination of a set of B-splines. However, there is inconsistency in how the term is used in computer graphics. Commonly, a “B-spline curve” is used to mean a curve represented by the linear combination of B-splines.</p>
<p>The idea of representing a polynomial as the linear combination of other polynomials has been discussed in <a href="C20_chapter15.xhtml#sec15_3_1">Section 15.3.1</a> and 15.3.5. Representing a spline as a linear combination of other splines was shown in <a href="C20_chapter15.xhtml#sec15_4_1">Section 15.4.1</a>. In fact, the example given is a simple case of a B-spline.</p>
<p>The general notation for representing a function as a linear combination of other functions is</p>
<div class="disp-formula" id="equ15_15">
<m:math display="block"><m:mrow><m:mi mathvariant="bold">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">t</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:munderover><m:mrow><m:mstyle displaystyle="true" mathvariant="normal"><m:mo>∑</m:mo></m:mstyle></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">n</m:mi></m:mrow></m:munderover><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">t</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>,</m:mo></m:mrow><m:mspace width="3em"/><m:mo>(15.15)</m:mo></m:math>
</div>
<p>where the <strong>p</strong><em><sub>i</sub></em> are the coefficients and the <em>b<sub>i</sub></em> are the basis functions. If the coefficients are points (e.g., 2 or 3 vectors), we refer to them as control points. The key to making such a method work is to define the <em>b<sub>i</sub></em> appropriately. B-splines provide a very general way to do this.</p>
<p><span aria-label="417" epub:type="pagebreak" id="pg_417" role="doc-pagebreak"/>A set of B-splines can be defined for a number of coefficients <em>n</em> and a parameter value <em>k.</em><a epub:type="noteref" href="C20_chapter15.xhtml#fn15_3" id="rfn15_3" role="doc-noteref"><sup>3</sup></a> The value of <em>k</em> is one more than the degree of the polynomials used to make the B-splines (<em>k</em> = <em>d</em> + 1.)</p>
<p>B-splines are important because they provide a very general method for creating functions (that will be useful for representing curves) that have a number of useful properties. A curve with <em>n</em> points made with B-splines with parameter value <em>k</em>:</p>
<ul class="list-bullet">
<li>
<p class="list">is <em>C</em><sup>(</sup><em>k</em>−2) continuous;</p>
</li>
<li>
<p class="list">is made of polynomials of degree <em>k</em> − 1;</p>
</li>
<li>
<p class="list">has local control–any site on the curve only depends on <em>k</em> of the control points;</p>
</li>
<li>
<p class="list">is bounded by the convex hull of the points;</p>
</li>
<li>
<p class="list">exhibits the variation diminishing property illustrated in <a href="C20_chapter15.xhtml#f15_12">Figure 15.12</a>.</p>
</li>
</ul>
<p>A curve created using B-splines does not necessarily interpolate its control points.</p>
<p>We will introduce B-splines by first looking at a specific, simple case to introduce the concepts. We will then generalize the methods and show why they are interesting. Because the method for computing B-splines is very general, we delay introducing it until we have shown what these generalizations are.</p>
<section>
<h4 id="sec61"><span class="blue">Uniform Linear B-Splines</span></h4>
<p>Consider a set of basis functions of the following form:</p>
<div class="disp-formula" id="equ15_16">
<m:math display="block"><m:mrow><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">t</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mrow><m:mo>{</m:mo><m:mtable columnalign="left"><m:mtr><m:mtd><m:mi mathvariant="italic">t</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">i</m:mi></m:mtd><m:mtd><m:mtext>if</m:mtext><m:mi mathvariant="normal"/><m:mi mathvariant="italic">i</m:mi><m:mo>≤</m:mo><m:mi mathvariant="italic">t</m:mi><m:mo>&lt;</m:mo><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mi mathvariant="normal">2</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">t</m:mi><m:mo>+</m:mo><m:mi mathvariant="italic">i</m:mi></m:mtd><m:mtd><m:mtext>if</m:mtext><m:mi mathvariant="normal"/><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mo>≤</m:mo><m:mi mathvariant="italic">t</m:mi><m:mo>≤</m:mo><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">2</m:mi><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mi mathvariant="normal">0</m:mi></m:mtd><m:mtd><m:mi mathvariant="normal">o</m:mi><m:mi mathvariant="normal">t</m:mi><m:mi mathvariant="normal">h</m:mi><m:mi mathvariant="normal">e</m:mi><m:mi mathvariant="normal">r</m:mi><m:mi mathvariant="normal">w</m:mi><m:mi mathvariant="normal">i</m:mi><m:mi mathvariant="normal">s</m:mi><m:mi mathvariant="normal">e</m:mi><m:mi mathvariant="normal">.</m:mi></m:mtd></m:mtr></m:mtable></m:mrow></m:mrow><m:mspace width="3em"/><m:mo>(15.16)</m:mo></m:math>
</div>
<p>Each of these functions looks like a little triangular “hat” between <em>i</em> and <em>i</em> + 2 with its peak at <em>i</em> + 1. Each is a piecewise polynomial, with knots at <em>i</em>, <em>i</em> + 1, and <em>i</em> + 2. Two of them are graphed in <a href="C20_chapter15.xhtml#f15_18">Figure 15.18</a>.</p>
<p>Each of these functions <em>b</em><sub><em>i</em>,2</sub> is a first-degree (linear) B-spline. Because we will consider B-splines of other parameter values later, we denote these with the 2 in the subscript.</p>
<figure id="f15_18" tabindex="0">
<img alt="" src="../images/fig15_18.jpg"/>
<figcaption><p><span class="blue">Figure 15.18.</span> B-splines with <em>d</em> = 1 or <em>k</em> = 2.</p></figcaption>
</figure>
<aside class="footnote" epub:type="footnote" role="doc-footnote"><p><a href="#rfn15_3" id="fn15_3"><sup>3</sup></a> The B-spline parameter is actually the <em>order</em> of the polynomials used in the B-splines. While this terminology is not uniform in the literature, the use of the B-spline parameter <em>k</em> as a value one greater than the polynomial degree is widely used, although some texts (see the chapter notes) write all of the equations in terms of polynomial degree.</p></aside>
<p class="indent"><a id="term-31"/><a id="term-232"/><span aria-label="418" epub:type="pagebreak" id="pg_418" role="doc-pagebreak"/>Notice that we have chosen to put the lower edge of the B-spline (its first knot) at <em>i</em>. Therefore, the first knot of the first B-spline (<em>i</em> = 1) is at 1. Iteration over the B-splines or elements of the coefficient vector is from 1 to <em>n</em> (see Equation 15.15). When B-splines are implemented, as well as in many other discussions of them, they often are numbered from 0 to <em>n</em> − 1.</p>
<p>We can create a function from a set of <em>n</em> control points using Equation 15.15, with these functions used for the <em>b<sub>i</sub></em> to create an “overall function” that was influenced by the coefficients. If we were to use these (<em>k</em> = 2) B-splines to define the overall function, we would define a piecewise polynomial function that linearly interpolates the coefficients <strong>p</strong><em><sub>i</sub></em> between <em>t</em> = <em>k</em> and <em>t</em> = <em>n</em> + 1. Note that while (<em>k</em> = 2) B-splines interpolate all of their coefficients, B-splines of higher degree do this under some specific conditions that we will discuss in <a href="C20_chapter15.xhtml#sec15_6_3">Section 15.6.3</a>.</p>
<p>Some properties of B-splines can be seen in this simple case. We will write these in the general form using <em>k</em>, the parameter, and <em>n</em> for the number of coefficients or control points:</p>
<ul class="list-bullet">
<li>
<p class="list">Each B-spline has <em>k</em> + 1 knots.</p>
</li>
<li>
<p class="list">Each B-spline is zero before its first knot and after its last knot.</p>
</li>
<li>
<p class="list">The overall spline has local control because each coefficient is only multiplied by one B-spline, and this B-spline is nonzero only between <em>k</em> + 1 knots.</p>
</li>
<li>
<p class="list">The overall spline has <em>n</em> + <em>k</em> knots.</p>
</li>
<li>
<p class="list">Each B-spline is <em>C</em><sup>(</sup><em>k</em> − 2) continuous, therefore the overall spline is <em>C</em><sup>(</sup><em>k</em> − 2) continuous.</p>
</li>
<li>
<p class="list">The set of B-splines sums to 1 for all parameter values between knots <em>k</em> and <em>n</em> + 1. This range is where there are <em>k</em> B-splines that are nonzero. Summing to 1 is important because it means that the B-splines are shift invariant: translating the control points will translate the entire curve.</p>
</li>
<li>
<p class="list"><a id="term-32"/><a id="term-233"/><span aria-label="419" epub:type="pagebreak" id="pg_419" role="doc-pagebreak"/>Between each of its knots, the B-spline is a single polynomial of degree <em>d</em> = <em>k</em> − 1. Therefore, the overall curve (that sums these together) can also be expressed as a single, degree <em>d</em> polynomial between any adjacent knots.</p>
</li>
</ul>
<p>In this example, we have chosen the knots to be uniformly spaced. We will consider B-splines with nonuniform spacing later. When the knot spacing is uniform, each of the B-splines is identical except for being shifted. B-splines with uniform knot spacing are sometimes called <em>uniform B-splines</em> or <em>periodic B-splines</em>.</p>
</section>
<section>
<h4 id="sec62"><span class="blue">Uniform Quadratic B-Splines</span></h4>
<p>The properties of B-splines listed in the previous section were intentionally written for arbitrary <em>n</em> and <em>k</em>. A general procedure for constructing the B-splines will be provided later, but first, lets consider another specific case with <em>k</em> = 3.</p>
<p>The B-spline <em>b</em><sub>2,3</sub> is shown in <a href="C20_chapter15.xhtml#f15_19">Figure 15.19</a>. It is made of quadratic pieces (degree 2), and has three of them. It is <em>C</em><sup>1</sup> continuous and is nonzero only within the four knots that it spans. Notice that a quadratic B-spline is made of three pieces, one between knot 1 and 2, one between knot 2 and 3, and one between knot 3 and 4. In <a href="C20_chapter15.xhtml#sec15_6_3">Section 15.6.3</a> we will see a general procedure for building these functions. For now, we simply examine these functions:</p>
<div class="disp-formula" id="equ15_17">
<m:math display="block"><m:mrow><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">t</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mrow><m:mo>{</m:mo><m:mtable columnalign="left"><m:mtr><m:mtd><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:mfrac><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup></m:mtd><m:mtd><m:mi>if</m:mi><m:mi mathvariant="normal"/><m:mi mathvariant="italic">i</m:mi><m:mo>≤</m:mo><m:mi mathvariant="italic">t</m:mi><m:mo>&lt;</m:mo><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mphantom><m:mrow><m:mn>0000</m:mn></m:mrow></m:mphantom><m:mi mathvariant="normal"/><m:mi mathvariant="italic">u</m:mi><m:mo>=</m:mo><m:mi mathvariant="italic">t</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">i</m:mi><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mo>−</m:mo><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:mo>+</m:mo><m:mi mathvariant="italic">u</m:mi><m:mo>+</m:mo><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:mfrac></m:mtd><m:mtd><m:mi>if</m:mi><m:mi mathvariant="normal"/><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mo>≤</m:mo><m:mi mathvariant="italic">t</m:mi><m:mo>&lt;</m:mo><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">2</m:mi><m:mtext> </m:mtext><m:mi mathvariant="normal"/><m:mi mathvariant="italic">u</m:mi><m:mo>=</m:mo><m:mi mathvariant="italic">t</m:mi><m:mo>−</m:mo><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal">)</m:mi><m:mi mathvariant="normal"/><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:mfrac><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">1</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">u</m:mi><m:msup><m:mrow><m:mi mathvariant="normal">)</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup></m:mtd><m:mtd><m:mi>if</m:mi><m:mi mathvariant="normal"/><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">2</m:mi><m:mo>≤</m:mo><m:mi mathvariant="italic">t</m:mi><m:mo>&lt;</m:mo><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">3</m:mi><m:mi mathvariant="normal"/><m:mtext> </m:mtext><m:mi mathvariant="italic">u</m:mi><m:mo>=</m:mo><m:mi mathvariant="italic">t</m:mi><m:mo>−</m:mo><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">2</m:mi><m:mi mathvariant="normal">)</m:mi><m:mi mathvariant="normal"/><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mi mathvariant="normal">0</m:mi></m:mtd><m:mtd><m:mi mathvariant="normal">o</m:mi><m:mi mathvariant="normal">t</m:mi><m:mi mathvariant="normal">h</m:mi><m:mi mathvariant="normal">e</m:mi><m:mi mathvariant="normal">r</m:mi><m:mi mathvariant="normal">w</m:mi><m:mi mathvariant="normal">i</m:mi><m:mi mathvariant="normal">s</m:mi><m:mi mathvariant="normal">e</m:mi><m:mi mathvariant="normal">.</m:mi></m:mtd></m:mtr></m:mtable></m:mrow></m:mrow><m:mspace width="3em"/><m:mo>(15.17)</m:mo></m:math>
</div>
<figure id="f15_19" tabindex="0">
<img alt="" src="../images/fig15_19.jpg"/>
<figcaption><p><span class="blue">Figure 15.19.</span> The B-spline <em>b</em><sub>2,3</sub> with uniform knot spacing.</p></figcaption>
</figure>
<p>In order to make the expressions simpler, we wrote the function for each part as if it applied over the range 0 to 1.</p>
<p>If we evaluate the overall function made from summing together the B-splines, at any time only <em>k</em> (3 in this case) of them are nonzero. One of them will be in the first part of Equation 15.17, one will be in the second part, and one will be in the third part. Therefore, we can think of any piece of the overall function as being <a id="term-33"/><a id="term-234"/><span aria-label="420" epub:type="pagebreak" id="pg_420" role="doc-pagebreak"/>made up of a degree <em>d</em> = <em>k</em> − 1 polynomial that depends on <em>k</em> coefficients. For the <em>k</em> = 3 case, we can write</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mi mathvariant="bold">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:mfrac><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">1</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">u</m:mi><m:msup><m:mrow><m:mi mathvariant="normal">)</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:mi mathvariant="normal">(</m:mi><m:mo>−</m:mo><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:mo>+</m:mo><m:mi mathvariant="italic">u</m:mi><m:mo>+</m:mo><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:mfrac><m:mi mathvariant="normal">)</m:mi><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:mfrac><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub></m:mrow></m:math>
</div>
<p>where <em>u</em> = <em>t</em> − <em>i.</em> This defines the piece of the overall function when <em>i</em> ≤ <em>t &lt; i</em>+ 1.</p>
<p>If we have a set of <em>n</em> points, we can use the B-splines to create a curve. If we have seven points, we will need a set of seven B-splines. A set of seven B-splines for <em>k</em> = 3 is shown in <a href="C20_chapter15.xhtml#f15_20">Figure 15.20</a>. Notice that there are <em>n</em> + <em>k</em> (10) knots, that the sum of the B-splines is 1 over the range <em>k</em> to <em>n</em> + 1 (knots 3 through 8). A curve specified using these B-splines and a set of points is shown in <a href="C20_chapter15.xhtml#f15_21">Figure 15.21</a>.</p>
<figure id="f15_20" tabindex="0">
<img alt="" src="../images/fig15_20.jpg"/>
<figcaption><p><span class="blue">Figure 15.20.</span> The set of seven B-splines with <em>k</em> = 3 and uniform knot spacing</p></figcaption>
</figure>
<figure id="f15_21" tabindex="0">
<img alt="" src="../images/fig15_21.jpg"/>
<figcaption><p><span class="blue">Figure 15.21.</span> Curve made from seven quadratic (<em>k</em> = 3) B-splines, using seven control points.</p></figcaption>
</figure>
</section>
<section>
<h4 id="sec63"><span class="blue">Uniform Cubic B-Splines</span></h4>
<p>Because cubic polynomials are so popular in computer graphics, the special case of B-splines with <em>k</em> = 4 is sufficiently important that we consider it before discussing the general case. A B-spline of third degree is defined by four cubic polynomial pieces. The general process by which these pieces are determined is <a id="term-34"/><a id="term-235"/><span aria-label="421" epub:type="pagebreak" id="pg_421" role="doc-pagebreak"/>described later, but the result is</p>
<div class="disp-formula" id="equ15_18">
<m:math display="block"><m:mrow><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">4</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">t</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mrow><m:mo>{</m:mo><m:mtable columnalign="left"><m:mtr><m:mtd><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">6</m:mi></m:mrow></m:mfrac><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msup></m:mtd><m:mtd><m:mi>if</m:mi><m:mi mathvariant="normal"/><m:mi mathvariant="italic">i</m:mi><m:mo>≤</m:mo><m:mi mathvariant="italic">t</m:mi><m:mo>&lt;</m:mo><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal"/><m:mphantom><m:mrow><m:mn>0000</m:mn></m:mrow></m:mphantom><m:mi mathvariant="italic">u</m:mi><m:mo>=</m:mo><m:mi mathvariant="italic">t</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">i</m:mi><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">6</m:mi></m:mrow></m:mfrac><m:mi mathvariant="normal">(</m:mi><m:mo>−</m:mo><m:mi mathvariant="normal">3</m:mi><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msup><m:mo>+</m:mo><m:mi mathvariant="normal">3</m:mi><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:mo>+</m:mo><m:mi mathvariant="normal">3</m:mi><m:mi mathvariant="italic">u</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal">)</m:mi></m:mtd><m:mtd><m:mi>if</m:mi><m:mi mathvariant="normal"/><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mo>≤</m:mo><m:mi mathvariant="italic">t</m:mi><m:mo>&lt;</m:mo><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">2</m:mi><m:mi mathvariant="normal"/><m:mtext> </m:mtext><m:mi mathvariant="italic">u</m:mi><m:mo>=</m:mo><m:mi mathvariant="italic">t</m:mi><m:mo>−</m:mo><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal">)</m:mi><m:mi mathvariant="normal"/><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">6</m:mi></m:mrow></m:mfrac><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">3</m:mi><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msup><m:mo>−</m:mo><m:mi mathvariant="normal">6</m:mi><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:mo>+</m:mo><m:mi mathvariant="normal">4</m:mi><m:mi mathvariant="normal">)</m:mi></m:mtd><m:mtd><m:mi>if</m:mi><m:mi mathvariant="normal"/><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">2</m:mi><m:mo>≤</m:mo><m:mi mathvariant="italic">t</m:mi><m:mo>&lt;</m:mo><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">3</m:mi><m:mi mathvariant="normal"/><m:mtext> </m:mtext><m:mi mathvariant="italic">u</m:mi><m:mo>=</m:mo><m:mi mathvariant="italic">t</m:mi><m:mo>−</m:mo><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">2</m:mi><m:mi mathvariant="normal">)</m:mi><m:mi mathvariant="normal"/><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">6</m:mi></m:mrow></m:mfrac><m:mi mathvariant="normal">(</m:mi><m:mo>−</m:mo><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msup><m:mo>+</m:mo><m:mi mathvariant="normal">3</m:mi><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:mo>−</m:mo><m:mi mathvariant="normal">3</m:mi><m:mi mathvariant="italic">u</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal">)</m:mi></m:mtd><m:mtd><m:mi>if</m:mi><m:mi mathvariant="normal"/><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">3</m:mi><m:mo>≤</m:mo><m:mi mathvariant="italic">t</m:mi><m:mo>&lt;</m:mo><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">4</m:mi><m:mtext> </m:mtext><m:mi mathvariant="normal"/><m:mi mathvariant="italic">u</m:mi><m:mo>=</m:mo><m:mi mathvariant="italic">t</m:mi><m:mo>−</m:mo><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">3</m:mi><m:mi mathvariant="normal">)</m:mi><m:mi mathvariant="normal"/><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mi mathvariant="normal">0</m:mi></m:mtd><m:mtd><m:mi mathvariant="normal">o</m:mi><m:mi mathvariant="normal">t</m:mi><m:mi mathvariant="normal">h</m:mi><m:mi mathvariant="normal">e</m:mi><m:mi mathvariant="normal">r</m:mi><m:mi mathvariant="normal">w</m:mi><m:mi mathvariant="normal">i</m:mi><m:mi mathvariant="normal">s</m:mi><m:mi mathvariant="normal">e</m:mi><m:mi mathvariant="normal">.</m:mi></m:mtd></m:mtr></m:mtable></m:mrow></m:mrow><m:mspace width="3em"/><m:mo>(15.18)</m:mo></m:math>
</div>
<p>This degree 3 B-spline is graphed for <em>i</em> = 1 in <a href="C20_chapter15.xhtml#f15_22">Figure 15.22</a>.</p>
<figure id="f15_22" tabindex="0">
<img alt="" src="../images/fig15_22.jpg"/>
<figcaption><p><span class="blue">Figure 15.22.</span> The cubic (<em>k</em> = 4) B-spline with uniform knots.</p></figcaption>
</figure>
<p>We can write the function for the overall curve between knots <em>i</em> + 3 and <em>i</em> + 4 as a function of the parameter <em>u</em> between 0 and 1 and the four control points that influence it:</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mtable><m:mtr><m:mtd><m:mi mathvariant="bold">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">6</m:mi></m:mrow></m:mfrac><m:mi mathvariant="normal">(</m:mi><m:mo>−</m:mo><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msup><m:mo>+</m:mo><m:mi mathvariant="normal">3</m:mi><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:mo>−</m:mo><m:mi mathvariant="normal">3</m:mi><m:mi mathvariant="italic">u</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal">)</m:mi><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">6</m:mi></m:mrow></m:mfrac><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">3</m:mi><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msup><m:mo>−</m:mo><m:mi mathvariant="normal">6</m:mi><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:mo>+</m:mo><m:mi mathvariant="normal">4</m:mi><m:mi mathvariant="normal">)</m:mi><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd columnalign="left"><m:mo>+</m:mo><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">6</m:mi></m:mrow></m:mfrac><m:mi mathvariant="normal">(</m:mi><m:mo>−</m:mo><m:mi mathvariant="normal">3</m:mi><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msup><m:mo>+</m:mo><m:mi mathvariant="normal">3</m:mi><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:mo>+</m:mo><m:mi mathvariant="normal">3</m:mi><m:mi mathvariant="italic">u</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal">)</m:mi><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">6</m:mi></m:mrow></m:mfrac><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msup><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">.</m:mi></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>This can be rewritten using the matrix notation of the previous sections, giving a basis matrix for cubic B-splines of</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:msub><m:mrow><m:mi mathvariant="bold">M</m:mi></m:mrow><m:mrow><m:mi mathvariant="bold">b</m:mi></m:mrow></m:msub><m:mo>=</m:mo><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">6</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd columnalign="right"><m:mo>−</m:mo><m:mn>1</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>3</m:mn></m:mtd><m:mtd columnalign="right"><m:mo>−</m:mo><m:mn>3</m:mn></m:mtd><m:mtd><m:mn>1</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>3</m:mn></m:mtd><m:mtd columnalign="right"><m:mo>−</m:mo><m:mn>6</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>3</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd></m:mtr><m:mtr><m:mtd columnalign="right"><m:mo>−</m:mo><m:mn>3</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>0</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>3</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>1</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>4</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>1</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow><m:mn>.</m:mn></m:mrow></m:math>
</div>
<p>Unlike the matrices that were derived from constraints in <a href="C20_chapter15.xhtml#sec15_5">Section 15.5</a>, this matrix is created from the polynomials that are determined by the general B-spline procedure defined in the next section.</p>
</section>
</section>
<section>
<h3 id="sec15_6_3"><a id="index_term781"/><a id="term-35"/><a id="term-236"/><span aria-label="422" epub:type="pagebreak" id="pg_422" role="doc-pagebreak"/><span class="green">15.6.3 Nonuniform B-Splines</span></h3>
<p>One nice feature of B-splines is that they can be defined for any <em>k</em> &gt; 1. So if we need a smoother curve, we can simply increase the value of <em>k</em>. This is illustrated in <a href="C20_chapter15.xhtml#f15_23">Figure 15.23</a>.</p>
<figure id="f15_23" tabindex="0">
<img alt="" src="../images/fig15_23.jpg"/>
<figcaption><p><span class="blue">Figure 15.23.</span> B-spline curves using the same uniform set of knots and the same control points, for various values of <em>k</em>. Note that as <em>k</em> increases, the valid parameter range for the curve shrinks.</p></figcaption>
</figure>
<p>So far, we have said that B-splines generalize to any <em>k &gt;</em> 1 and any <em>n</em> ≥ <em>d</em>. There is one last generalization to introduce before we show how to actually compute these B-splines. B-splines are defined for any non-decreasing knot vector.</p>
<p>For a given <em>n</em> and <em>k,</em> the set of B-splines (and the function created by their linear combination) has <em>n</em> + <em>k</em> knots. We can write the value of these knots as a vector, that we will denote as <strong>t</strong>. For the uniform B-splines, the knot vector is [1, 2, 3<em>,...,n</em> + <em>k</em>]. However, B-splines can be generated for any knot vector of length <em>n</em> + <em>k,</em> providing the values are non-decreasing (e.g., <em>t</em><sub><em>i</em>+1</sub> ≥ <em>t<sub>i</sub></em>).</p>
<p>There are two main reasons why nonuniform knot spacing is useful: it gives us control over what parameter range of the overall function each coefficient affects, and it allows us to repeat knots (e.g., create knots with no spacing in between) in order to create functions with different properties around these points. The latter will be considered later in this section.</p>
<p>The ability to specify knot values for B-splines is similar to being able to specify the interpolation sites for interpolating spline curves. It allows us to associate curve features with parameter values. By specifying a nonuniform knot vector, we specify what parameter range each coefficient of a B-spline curve affects. Remember that B-spline <em>i</em> is nonzero only between knot <em>i</em> and knot <em>i</em> + <em>k</em>. Therefore, the coefficient associated with it only affects the curve between these parameter values.</p>
<p>One place where control over knot values is particularly useful is in inserting or deleting knots near the beginning of a sequence. To illustrate this, consider a <span aria-label="423" epub:type="pagebreak" id="pg_423" role="doc-pagebreak"/>curve defined using linear B-splines (<em>k</em> = 2) as discussed in <a href="C20_chapter15.xhtml#sec15_6_2">Section 15.6.2</a>. For <em>n</em> = 4, the uniform knot vector is [1, 2, 3, 4, 5, 6]. This curve is controlled by a set of four points and spans the parameter range <em>t</em> = 2 to <em>t</em> = 5. The “end” of the curve (<em>t</em> = 5) interpolates the last control point. If we insert a new point in the middle of the point set, we would need a longer knot vector. The locality properties of the B-splines prevent this insertion from affecting the values of the curve at the ends. The longer curve would still interpolate its last control point at its end. However, if we chose to keep the uniform knot spacing, the new knot vector would be [1, 2, 3, 4, 5, 6, 7]. The end of the curve would be at <em>t</em> = 6, and the parameter value at which the last control point is interpolated will be a different parameter value than before the insertion. With nonuniform knot spacing, we can use the knot vector [1, 2, 3, 3.5, 4, 5, 6] so that the ends of the curve are unaffected by the change. The abilities to have nonuniform knot spacing makes the locality property of B-splines an algebraic property, as well as a geometric one.</p>
<p>We now introduce the general method for defining B-splines. Given values for the number of coefficients <em>n,</em> the B-spline parameter <em>k</em>, and the knot vector <strong>t</strong> (which has length <em>n</em> + <em>k</em>), the following recursive equations define the B-splines:</p>
<div class="disp-formula" id="equ15_19">
<m:math display="block"><m:mrow><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">1</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">t</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">t</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo></m:mtd><m:mtd><m:mo>{</m:mo><m:mtable columnalign="left"><m:mtr><m:mtd><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal"/><m:mtext> </m:mtext><m:mi>if</m:mi><m:mi mathvariant="normal"/><m:msub><m:mrow><m:mi mathvariant="bold">t</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi></m:mrow></m:msub><m:mo>≤</m:mo><m:mi mathvariant="italic">t</m:mi><m:mo>&lt;</m:mo><m:msub><m:mrow><m:mi mathvariant="bold">t</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mi mathvariant="normal">0</m:mi><m:mi mathvariant="normal"/><m:mtext> </m:mtext><m:mi mathvariant="normal">o</m:mi><m:mtext>t</m:mtext><m:mi mathvariant="normal">h</m:mi><m:mi mathvariant="normal">e</m:mi><m:mi mathvariant="normal">r</m:mi><m:mi mathvariant="normal">w</m:mi><m:mi mathvariant="normal">i</m:mi><m:mi mathvariant="normal">s</m:mi><m:mi mathvariant="normal">e</m:mi><m:mi mathvariant="normal">.</m:mi></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr></m:mtable></m:mrow><m:mspace width="3em"/><m:mo>(15.19)</m:mo></m:math>
</div>
<div class="disp-formula" id="equ15_20">
<m:math display="block"><m:mrow><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>,</m:mo><m:mi mathvariant="italic">k</m:mi><m:mo>,</m:mo><m:mi mathvariant="italic">t</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">t</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal"/><m:mfrac><m:mrow><m:mi mathvariant="italic">t</m:mi><m:mo>−</m:mo><m:msub><m:mrow><m:mi mathvariant="italic">t</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi></m:mrow></m:msub></m:mrow><m:mrow><m:msub><m:mrow><m:mi mathvariant="bold">t</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="italic">k</m:mi><m:mo>−</m:mo><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi mathvariant="bold">t</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi></m:mrow></m:msub></m:mrow></m:mfrac><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>,</m:mo><m:mi mathvariant="italic">k</m:mi><m:mo>−</m:mo><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">t</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>+</m:mo><m:mfrac><m:mrow><m:msub><m:mrow><m:mi mathvariant="bold">t</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="italic">k</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:mi mathvariant="italic">t</m:mi></m:mrow><m:mrow><m:msub><m:mrow><m:mi mathvariant="bold">t</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="italic">k</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi mathvariant="bold">t</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub></m:mrow></m:mfrac><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mo>,</m:mo><m:mi mathvariant="italic">k</m:mi><m:mo>−</m:mo><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">t</m:mi><m:mi mathvariant="normal">)</m:mi><m:mn>.</m:mn></m:mrow><m:mspace width="3em"/><m:mo>(15.20)</m:mo></m:math>
</div>
<p>This equation is know as the <em><a id="index_term272"/>Cox–de Boor recurrence</em>. It may be used to compute specific values for specific B-splines. However, it is more often applied algebraically to derive equations such as Equation 15.17 or 15.18.</p>
<p>As an example, consider how we would have derived Equation 15.17. Using a uniform knot vector [1, 2, 3,...], <em>t</em><sub><em>i</em></sub> = <em>i</em>, and the value <em>k</em> = 3 in Equation 15.20 yields</p>
<div class="disp-formula" id="equ15_21">
<m:math display="block"><m:mrow><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">t</m:mi><m:mi mathvariant="normal">)</m:mi></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo><m:mfrac><m:mrow><m:mi mathvariant="italic">t</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">i</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">2</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">i</m:mi></m:mrow></m:mfrac><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:mfrac><m:mrow><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">3</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">t</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">3</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>−</m:mo><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal">)</m:mi></m:mrow></m:mfrac><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd columnalign="left"><m:mo>=</m:mo><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:mfrac><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">t</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">i</m:mi><m:mi mathvariant="normal">)</m:mi><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:mfrac><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">3</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">t</m:mi><m:mi mathvariant="normal">)</m:mi><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">.</m:mi></m:mtd></m:mtr></m:mtable></m:mrow><m:mspace width="3em"/><m:mo>(15.21)</m:mo></m:math>
</div>
<p>Continuing the recurrence, we must evaluate the recursive expressions:</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">t</m:mi><m:mi mathvariant="normal">)</m:mi><m:mi mathvariant="normal"/></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo><m:mi mathvariant="normal"/><m:mfrac><m:mrow><m:mi mathvariant="italic">t</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">i</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">2</m:mi><m:mo>−</m:mo><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">i</m:mi></m:mrow></m:mfrac><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:mfrac><m:mrow><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">2</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">t</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">2</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>−</m:mo><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal">)</m:mi></m:mrow></m:mfrac><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd columnalign="left"><m:mo>=</m:mo><m:mi mathvariant="normal"/><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">t</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">i</m:mi><m:mi mathvariant="normal">)</m:mi><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">2</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">t</m:mi><m:mi mathvariant="normal">)</m:mi><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">t</m:mi><m:mi mathvariant="normal">)</m:mi><m:mi mathvariant="normal"/></m:mtd><m:mtd columnalign="left"><m:mo>=</m:mo><m:mfrac><m:mrow><m:mi mathvariant="italic">t</m:mi><m:mo>−</m:mo><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal">)</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">2</m:mi><m:mo>−</m:mo><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>−</m:mo><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal">)</m:mi></m:mrow></m:mfrac><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd><m:mphantom><m:mrow><m:mn>0</m:mn></m:mrow></m:mphantom><m:mo>+</m:mo><m:mfrac><m:mrow><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">2</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">t</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">2</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>−</m:mo><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal">)</m:mi></m:mrow></m:mfrac><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd><m:mo>=</m:mo><m:mi mathvariant="normal"/><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">t</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal">)</m:mi><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">3</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">t</m:mi><m:mi mathvariant="normal">)</m:mi><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">2</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">1</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">.</m:mi></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p><a id="term-237"/><span aria-label="424" epub:type="pagebreak" id="pg_424" role="doc-pagebreak"/>Inserting these results into Equation 15.22 gives:</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi>b</m:mi></m:mrow><m:mrow><m:mi>i</m:mi><m:mo>,</m:mo><m:mn>3</m:mn></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mfrac><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>−</m:mo><m:mi>i</m:mi><m:mo>)</m:mo><m:mrow><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>−</m:mo><m:mi>i</m:mi><m:mo>)</m:mo><m:msub><m:mrow><m:mi>b</m:mi></m:mrow><m:mrow><m:mi>i</m:mi><m:mo>,</m:mo><m:mn>1</m:mn></m:mrow></m:msub></m:mrow><m:mo>+</m:mo><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>2</m:mn><m:mo>−</m:mo><m:mi>t</m:mi><m:mo>)</m:mo><m:msub><m:mrow><m:mi>b</m:mi></m:mrow><m:mrow><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mo>+</m:mo><m:mfrac><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>3</m:mn><m:mo>−</m:mo><m:mi>t</m:mi><m:mo>)</m:mo><m:mrow><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>−</m:mo><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo><m:msub><m:mrow><m:mi>b</m:mi></m:mrow><m:mrow><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mn>1</m:mn></m:mrow></m:msub></m:mrow><m:mo>+</m:mo><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>3</m:mn><m:mo>−</m:mo><m:mi>t</m:mi><m:mo>)</m:mo><m:msub><m:mrow><m:mi>b</m:mi></m:mrow><m:mrow><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>2</m:mn><m:mo>,</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mn>.</m:mn></m:mrow></m:mrow></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>To see that this expression is equivalent to Equation 15.17, we note that each of the (<em>k</em> = 1) <a id="index_term289"/>B-splines is like a switch, turning on only for a particular parameter range. For instance, <em>b</em><sub><em>i</em>,1</sub> is only nonzero between <em>i</em> and <em>i</em> + 1. So, if <em>i</em> ≤ <em>t</em> &lt; <em>i</em> + 1, only the first of the (<em>k</em> = 1) B-splines in the expression is nonzero, so</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">3</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">t</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:mfrac><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">t</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">i</m:mi><m:msup><m:mrow><m:mi mathvariant="normal">)</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:mtext>if</m:mtext><m:mi mathvariant="italic">i</m:mi><m:mo>≤</m:mo><m:mi mathvariant="italic">t</m:mi><m:mo>&lt;</m:mo><m:mi mathvariant="italic">i</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal">.</m:mi></m:mrow></m:math>
</div>
<p>Similar manipulations give the other parts of Equation 15.17.</p>
<section>
<h4 id="sec64"><a id="index_term299"/><a id="index_term652"/><span class="blue">Repeated Knots and B-Spline Interpolation</span></h4>
<p>While B-splines have many nice properties, functions defined using them generally do not interpolate the coefficients. This can be inconvenient if we are using them to define a curve that we want to interpolate a specific point. We give a brief overview of how to interpolate a specific point using B-splines here. A more complete discussion can be found in the books listed in the chapter notes.</p>
<p>One way to cause B-splines to interpolate their coefficients is to repeat knots. If all of the interior knots for a particular B-spline have the same value, then the overall function will interpolate this B-spline’s coefficient. An example of this is shown in <a href="C20_chapter15.xhtml#f15_24">Figure 15.24</a>.</p>
<figure id="f15_24" tabindex="0">
<img alt="" src="../images/fig15_24.jpg"/>
<figcaption><p><span class="blue">Figure 15.24.</span> A curve parameterized by quadratic B-splines (k = 3) with seven control points. In (a) a uniform knot vector [1,2,3,4,5,6,7,8,9,10] is used, while in (b) the nonuniform knot vector [1,2,3,4,4,6,7,8,8,10] is used. The duplication of the 4th and 8th knots means that all interior points of the 3rd and 7th B-spline are equal, so the curve interpolates the control points associated with those knots.</p></figcaption>
</figure>
<p>Interpolation by repeated knots comes at a high cost: it removes the smoothness of the B-spline and the resulting overall function and represented curve.</p>
<p>However, at the beginning and end of the spline, where continuity is not an issue, knot repetition is useful for creating <em>endpoint interpolating B-splines.</em> While the first (or last) knot’s value is not important for interpolation, for simplicity, we make the first (or last) <em>k</em> knots have the same value to achieve interpolation.</p>
<p>Endpoint interpolating quadratic B-splines are shown in <a href="C20_chapter15.xhtml#f15_25">Figure 15.25</a>. The first two and last two B-splines are different than the uniform ones. Their expressions <a id="term-36"/><a id="term-238"/><a id="term-248"/><a id="term-491"/><span aria-label="425" epub:type="pagebreak" id="pg_425" role="doc-pagebreak"/>can be derived through the use of the <a id="index_term273"/>Cox–de Boor recurrence:</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">1</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">3</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">[</m:mi><m:mi mathvariant="normal">0</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">0</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">0</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">1</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">2</m:mi><m:mo>,</m:mo><m:mo>…</m:mo><m:mi mathvariant="normal">]</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">t</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mrow><m:mo>{</m:mo><m:mtable columnalign="left"><m:mtr><m:mtd><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">1</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">t</m:mi><m:msup><m:mrow><m:mi mathvariant="normal">)</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup></m:mtd><m:mtd><m:mi>if</m:mi><m:mi mathvariant="normal"/><m:mi mathvariant="normal">0</m:mi><m:mo>≤</m:mo><m:mi mathvariant="italic">t</m:mi><m:mo>&lt;</m:mo><m:mi mathvariant="normal">1</m:mi><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mi mathvariant="normal">0</m:mi></m:mtd><m:mtd><m:mi>otherwise</m:mi><m:mi mathvariant="normal">.</m:mi></m:mtd></m:mtr></m:mtable></m:mrow></m:mrow></m:math>
</div>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">3</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">[</m:mi><m:mi mathvariant="normal">0</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">0</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">0</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">1</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal">2</m:mi><m:mo>,</m:mo><m:mo>…</m:mo><m:mi mathvariant="normal">]</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">t</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mrow><m:mo>{</m:mo><m:mtable columnalign="left"><m:mtr><m:mtd><m:mi mathvariant="normal">2</m:mi><m:mi mathvariant="italic">u</m:mi><m:mo>−</m:mo><m:mfrac><m:mrow><m:mi mathvariant="normal">3</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:mfrac><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup></m:mtd><m:mtd><m:mi>if</m:mi><m:mi mathvariant="normal"/><m:mi mathvariant="normal">0</m:mi><m:mo>≤</m:mo><m:mi mathvariant="italic">t</m:mi><m:mo>&lt;</m:mo><m:mi mathvariant="normal">1</m:mi><m:mtext> </m:mtext><m:mi mathvariant="normal"/><m:mi mathvariant="italic">u</m:mi><m:mo>=</m:mo><m:mi mathvariant="italic">t</m:mi><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mfrac><m:mrow><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:mfrac><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="normal">1</m:mi><m:mo>−</m:mo><m:mi mathvariant="italic">u</m:mi><m:msup><m:mrow><m:mi mathvariant="normal">)</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup></m:mtd><m:mtd><m:mi>if</m:mi><m:mi mathvariant="normal"/><m:mi mathvariant="normal">1</m:mi><m:mo>≤</m:mo><m:mi mathvariant="italic">t</m:mi><m:mo>&lt;</m:mo><m:mi mathvariant="normal">2</m:mi><m:mi mathvariant="normal"/><m:mtext> </m:mtext><m:mi mathvariant="italic">u</m:mi><m:mo>=</m:mo><m:mi mathvariant="italic">t</m:mi><m:mo>−</m:mo><m:mi mathvariant="normal">1</m:mi><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mi mathvariant="normal">0</m:mi></m:mtd><m:mtd><m:mi>otherwise</m:mi><m:mi mathvariant="normal">.</m:mi></m:mtd></m:mtr></m:mtable></m:mrow></m:mrow></m:math>
</div>
<figure id="f15_25" tabindex="0">
<img alt="" src="../images/fig15_25.jpg"/>
<figcaption><p><span class="blue">Figure 15.25.</span> Endpoint interpolating quadratic (<em>k</em> = 3) B-splines, for <em>n</em> = 8. The knot vector is [0,0,0,1,2,3,4,5,6,6,6]. The first and last two B-splines are aperiodic, while the middle four (shown as dotted lines) are periodic and identical to the ones in <a href="C20_chapter15.xhtml#f15_20">Figure 15.20</a>.</p></figcaption>
</figure>
</section>
</section>
<section>
<h3 id="sec15_6_4"><a id="index_term787"/><span class="green">15.6.4 NURBS</span></h3>
<p>Despite all of the generality B-splines provide, there are some functions that cannot be exactly represented using them. In particular, B-splines cannot represent conic sections. To represent such curves, a ratio of two polynomials is used. Nonuniform B-splines are used to represent both the numerator and the denominator. <span aria-label="426" epub:type="pagebreak" id="pg_426" role="doc-pagebreak"/>The most general form of these are nonuniform rational B-splines, or NURBS for short.</p>
<p>NURBS associate a scalar weight <em>h<sub>i</sub></em> with every control point <strong>p<sub>i</sub></strong> and use the same B-splines for both:</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mi mathvariant="bold">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mfrac><m:mrow><m:msubsup><m:mrow><m:mstyle displaystyle="true" mathvariant="normal"><m:mo>∑</m:mo></m:mstyle></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">n</m:mi></m:mrow></m:msubsup><m:msub><m:mrow><m:mi mathvariant="italic">h</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi mathvariant="bold">p</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>,</m:mo><m:mi mathvariant="italic">k</m:mi><m:mo>,</m:mo><m:mi mathvariant="italic">t</m:mi></m:mrow></m:msub></m:mrow><m:mrow><m:msubsup><m:mrow><m:mstyle displaystyle="true" mathvariant="normal"><m:mo>∑</m:mo></m:mstyle></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal">1</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">n</m:mi></m:mrow></m:msubsup><m:msub><m:mrow><m:mi mathvariant="italic">h</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi mathvariant="italic">b</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">i</m:mi><m:mo>,</m:mo><m:mi mathvariant="italic">k</m:mi><m:mo>,</m:mo><m:mi mathvariant="bold">t</m:mi></m:mrow></m:msub></m:mrow></m:mfrac><m:mo>,</m:mo></m:mrow></m:math>
</div>
<p>where <em>b</em><sub><em>i,k,</em><strong>t</strong> are the B-splines with parameter <em>k</em> and knot vector <strong>t</strong>.</sub></p>
<p>NURBS are very widely used to represent curves and surfaces in geometric modeling because of the amazing versatility they provide, in addition to the useful properties of B-splines.</p>
</section>
</section>
<section>
<h2 id="sec15_7"><a epub:type="backlink" href="C02a_toc.xhtml#rsec15_7" role="doc-backlink"><span class="green">15.7 Summary</span></a></h2>
<p>In this chapter, we have discussed a number of representations for free-form curves. The most important ones for computer graphics are:</p>
<ul class="list-bullet">
<li>
<p class="list">Cardinal splines use a set of cubic pieces to interpolate control points. They are generally preferred to interpolating polynomials because they are local and easier to evaluate.</p>
</li>
<li>
<p class="list">Bézier curves approximate their control points and have many useful properties and associated algorithms. For this reason, they are popular in graphics applications.</p>
</li>
<li>
<p class="list">B-spline curves represent the curve as a linear combination of B-spline functions. They are general and have many useful properties such as being bounded by their convex hull and being variation diminishing. B-splines are often used when smooth curves are desired.</p>
</li>
</ul>
</section>
<section>
<h2 id="sec65"><span class="green">Notes</span></h2>
<p>The problem of representing shapes mathematically is an entire field unto itself, generally known as geometric modeling. Representing curves is just the beginning and is generally a precursor to modeling surfaces and solids. A more thorough discussion of curves can be found in most geometric modeling texts, see for example <em>Geometric Modeling</em> (Mortenson, 1985) for a text that is accessible to computer graphics students. Many geometric modeling books specifically focus <span aria-label="427" epub:type="pagebreak" id="pg_427" role="doc-pagebreak"/>on smooth curves and surfaces. Texts such as <em>An Introduction to Splines for Use in Computer Graphics</em> (Bartels, Beatty, &amp; Barsky, 1987), <em>Curves and Surfaces for CAGD: A Practical Guide</em> (Farin, 2002) and <em>Geometric Modeling with Splines:</em></p>
<p><em>An Introduction</em> (E. Cohen, Riesenfeld, &amp; Elber, 2001) provide considerable detail about curve and surface representations. Other books focus on the mathematics of splines; <em>A Practical Guide to Splines</em> (De Boor, 2001) is a standard reference.</p>
<p>The history of the development of curve and surface representations is complex, see the chapter by Farin in <em>Handbook of Computer Aided Geometric Design</em> (<a id="index_term356"/>Farin, Hoschek, &amp; Kim, 2002) or the book on the subject <em>An Introduction to NURBS: With Historical Perspective</em> (D. F. Rogers, 2000) for a discussion.</p>
<p>Many ideas were independently developed by multiple groups who approached the problems from different disciplines. Because of this, it can be difficult to attribute ideas to a single person or to point at the “original” sources. It has also led to a diversity of notation, terminology, and ways of introducing the concepts in the literature.</p>
<section>
<h3 id="sec15_7_1"><span class="green">15.7.1 Exercises</span></h3>
<p>For Exercises 1–4, find the constraint matrix, the basis matrix, and the basis functions. To invert the matrices you can use a program such as MATLAB or OCTAVE (a free MATLAB-like system).</p>
<p class="qpara"><span class="green">1.</span> A line segment: parameterized with <strong>p</strong><sub>0</sub> located 25% of the way along the segment (<em>u</em> = 0.25), and <strong>p</strong><sub>1</sub> located 75% of the way along the segment.</p>
<p class="qpara"><span class="green">2.</span> A quadratic: parameterized with <strong>p</strong><sub>0</sub> as the position of the beginning point (<em>u</em> = 0), <strong>p</strong><sub>1</sub>, the first derivative at the beginning point, and <strong>p</strong><sub>2</sub>, the second derivative at the beginning point.</p>
<p class="qpara"><span class="green">3.</span> A cubic: its control points are equally spaced (<strong>p</strong><sub>0</sub> has <em>u</em> = 0, <strong>p</strong><sub>1</sub> has <em>u</em> = 1/3, <strong>p</strong><sub>2</sub> has <em>u</em> = 2/3,and <strong>p</strong><sub>3</sub> has <em>u</em> = 1).</p>
<p class="qpara"><span class="green">4.</span> A quintic: (a degree five polynomial, so the matrices will be 6×6)where <strong>p</strong><sub>0</sub> is the beginning position, <strong>p</strong><sub>1</sub> is the beginning derivative, <strong>p</strong><sub>2</sub> is the middle (<em>u</em> = 0.5) position, <strong>p</strong><sub>3</sub> is the first derivative at the middle, <strong>p</strong><sub>4</sub> is the position at the end, and <strong>p</strong><sub>5</sub> is the first derivative at the end.</p>
<p class="qpara"><span class="green">5.</span> The Lagrange form (Equation (15.12)) can be used to represent the interpolating cubic of Exercise 3. Use it at several different parameter values to confirm that it does produce the same results as the basis functions derived in Exercise 3.</p>
<p class="qpara"><span class="green">6.</span> <span aria-label="428" epub:type="pagebreak" id="pg_428" role="doc-pagebreak"/>Devise an arc-length parameterization for the curve represented by the parametric function</p>
<div class="disp-formula">
<m:math display="block"><m:mrow><m:mi mathvariant="italic">f</m:mi><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mi mathvariant="normal">)</m:mi><m:mo>=</m:mo><m:mi mathvariant="normal">(</m:mi><m:mi mathvariant="italic">u</m:mi><m:mo>,</m:mo><m:mi mathvariant="normal"/><m:msup><m:mrow><m:mi mathvariant="italic">u</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">2</m:mi></m:mrow></m:msup><m:mi mathvariant="normal">)</m:mi><m:mn>.</m:mn></m:mrow></m:math>
</div>
<p class="qpara"><span class="green">7.</span> Given the four control points of a segment of a Hermite spline, compute the control points of an equivalent Bézier segment.</p>
<p class="qpara"><span class="green">8.</span> Use the de Casteljau algorithm to evaluate the position of the cubic Bézier curve with its control points at (0,0), (0,1), (1,1) and (1,0) for parameter values <em>u</em> = 0.5 and <em>u</em> = 0.75. Drawing a sketch will help you do this.</p>
<p class="qpara"><span class="green">9.</span> Use the Cox–de Boor recurrence to derive Equation (15.16).</p>
</section>
</section>
</section>
</body>
</html>