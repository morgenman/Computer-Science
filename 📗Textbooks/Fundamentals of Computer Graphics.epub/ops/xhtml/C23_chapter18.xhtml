<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" xmlns:m="http://www.w3.org/1998/Math/MathML" xmlns:svg="http://www.w3.org/2000/svg" dir="ltr" lang="en" xml:lang="en">
<head>
<meta charset="UTF-8"/>
<title>18 Color</title>
<link href="../styles/9781000426359.css" rel="stylesheet" type="text/css"/>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
jax: ["input/TeX","input/MathML","output/SVG"],
extensions: ["tex2jax.js","mml2jax.js","MathEvents.js"],
TeX: {
extensions: ["noErrors.js","noUndefined.js","autoload-all.js"]
},
MathMenu: {
showRenderer: false
},
menuSettings: {
zoom: "Click"
},
messageStyle: "none"
});
</script>
<script src="../mathjax/MathJax.js" type="text/javascript"/>
<meta content="urn:uuid:e0000000-0000-0000-0000-000006665500" name="Adept.expected.resource"/>
</head>
<body epub:type="bodymatter">
<section epub:type="chapter" role="doc-chapter">
<header>
<p class="chap-auz"><span class="green">Erik Reinhard and Garrett Johnson</span></p>
<h1 class="chapz1" id="c18"><a id="term-137"/><span aria-label="503" epub:type="pagebreak" id="pg_503" role="doc-pagebreak"/><a epub:type="backlink" href="C02a_toc.xhtml#rc18" role="doc-backlink"><span class="green"><span class="big1">18</span><br/>Color</span></a></h1>
</header>
<p class="noindent1">Photons are the carriers of optical information. They propagate through media taking on properties associated with waves. At surface boundaries they interact with matter, behaving more as particles. They can also be absorbed by the retina, where the information they carry is transcoded into electrical signals that are subsequently processed by the brain. It is only there that a sensation of color is generated.</p>
<p>As a consequence, the study of color in all its guises touches upon several different fields: physics for the propagation of light through space, chemistry for its interaction with matter, and neuroscience and psychology for aspects relating to perception and cognition of <a id="index_term150"/>color (Reinhard et al., 2008).</p>
<p>In computer graphics, we traditionally take a simplified view of how light propagates through space. Photons travel along straight paths until they hit a surface boundary and are then reflected according to a reflection function of some sort. A single photon will carry a certain amount of energy, which is represented by its wavelength. Thus, a photon will have only one wavelength. The relationship between its wavelength λ and the amount of energy it carries (Δ<em>E</em>) is given by</p>
<div class="disp-formula">
<m:math xmlns:mml="http://www.w3.org/1998/Math/MathML" alttext=""><m:mrow><m:mi>λ</m:mi><m:mtext> </m:mtext><m:mi mathvariant="normal">Δ</m:mi><m:mi>E</m:mi><m:mo>=</m:mo><m:mn>1239.9</m:mn><m:mo>,</m:mo></m:mrow></m:math>
</div>
<p>where Δ<em>E</em> is measured in electron volts (eV).</p>
<p>In computer graphics, it is not very efficient to simulate single photons; instead large collections of them are simulated at the same time. If we take a very large number of photons, each carrying a possibly different amount of energy, then <a id="term-125"/><a id="term-138"/><a id="term-814"/><a id="term-819"/><span aria-label="504" epub:type="pagebreak" id="pg_504" role="doc-pagebreak"/>together they represent a <a id="index_term1115"/><a id="index_term176"/>spectrum. A spectrum can be thought of as a graph where the number of photons is plotted against wavelength. Because two photons of the same wavelength carry twice as much energy as a single photon of that wavelength, this graph can also be seen as a plot of energy against wavelength. An example of a spectrum is shown in <a href="C23_chapter18.xhtml#f18_1">Figure 18.1</a>. The range of wavelengths to which humans are sensitive is roughly between 380 and 800 nanometers (nm).</p>
<figure id="f18_1" tabindex="0">
<img alt="" src="../images/fig18_1.jpg"/>
<figcaption><p><span class="blue">Figure 18.1.</span> A spectrum describes how much energy is available at each wavelength λ, here measured as relative radiant power. This specific spectrum represents average daylight.</p></figcaption>
</figure>
<p>When simulating light, it would therefore be possible to trace rays that each carry a spectrum. A renderer that accomplishes this is normally called a <em>spectral renderer</em>. From preceding chapters, it should be clear that we are not normally going through the expense of building <a id="index_term1112"/>spectral renderers. Instead, we replace spectra with representations that typically use red, green, and blue components. The reason that this is possible at all has to do with human vision and will be discussed in <a href="C23_chapter18.xhtml#sec18_1">Section 18.1</a>.</p>
<p>Simulating light by tracing rays takes care of the physics of light, although it should be noted that several properties of light, including, for instance, polarization, diffraction, and interference, are not modeled in this manner.</p>
<p>At surface boundaries, we normally model what happens with light by means of a reflectance function. These functions can be measured directly by means of <em><a id="index_term446"/>gonioreflectometers</em>, leading to a large amount of tabled data, which can be more compactly represented by various different functions. Nonetheless, these reflectance functions are empirical in nature, i.e., they abstract away the chemistry that happens when a photon is absorbed and re-emitted by an electron. Thus, reflectance functions are useful for modeling in computer graphics, but do not <span aria-label="505" epub:type="pagebreak" id="pg_505" role="doc-pagebreak"/>offer an explanation as to why certain wavelengths of light are absorbed and others are reflected. We can therefore not use reflectance functions to explain why the light reflected off a banana has a spectral composition that appears to us as yellow. For that, we would have to study molecular orbital theory, a topic beyond the scope of this book.</p>
<p>Finally, when light reaches the retina, it is transcoded into electrical signals that are propagated to the brain. A large part of the brain is devoted to processing visual signals, part of which gives rise to the sensation of color. Thus, even if we know the spectrum of light that is reflected off a banana, we do not know yet why humans associate the term “yellow” with it. Moreover, as we will find out in the remainder of this chapter, our perception of color is vastly more complicated than it would seem at first glance. It changes with illumination, varies between observers, and varies within an observer over time.</p>
<p>In other words, the spectrum of light coming off a banana is perceived in the context of an environment. To predict how an observer perceives a “banana spectrum” requires knowledge of the environment that contains the banana as well as the observer’s environment. In many instances, these two environments are the same. However, when we are displaying a photograph of a banana on a monitor, then these two environments will be different. As human visual perception depends on the environment the observer is in, it may perceive the banana in the photograph differently from how an observer directly looking at the banana would perceive it. This has a significant impact on how we should deal with color and illustrates the complexities associated with color.</p>
<p>To emphasize the crucial role that human vision plays, we only have to look at the definition of color: “Color is the aspect of visual perception by which an observer may distinguish differences between two structure-free fields of view of the same size and shape, such as may be caused by differences in the spectral composition of the radiant energy concerned in the observation” (Wyszecki &amp; Stiles, 2000). In essence, without a human observer there is no color.</p>
<p>Luckily, much of what we know about color can be quantified, so that we can carry out computations to correct for the idiosyncrasies of human vision and thereby display images that will appear to observers the way the designer of those images intended. This chapter contains the theory and mathematics required to do so.</p>
<section>
<h2 id="sec18_1"><a id="index_term158"/><a epub:type="backlink" href="C02a_toc.xhtml#rsec18_1" role="doc-backlink"><span class="green">18.1 Colorimetry</span></a></h2>
<p><a id="index_term187"/>Colorimetry is the science of color measurement and description. Since color is ultimately a human response, color measurement should begin with human <a id="term-148"/><span aria-label="506" epub:type="pagebreak" id="pg_506" role="doc-pagebreak"/>observation. The photodetectors in the human retina consist of rods and cones. The rods are highly sensitive and come into play in low-light conditions. Under normal lighting conditions, the cones are operational, mediating human vision. There are three cone types and together they are primarily responsible for color vision.</p>
<p>Although it may be possible to directly record the electrical output of cones while some visual stimulus is being presented, such a procedure would be invasive, while at the same time ignoring the sometimes substantial differences between observers. Moreover, much of the measurement of color was developed well before such direct recording techniques were available.</p>
<p>The alternative is to measure color by means of measuring the human response to patches of color. This leads to color matching experiments, which will be described later in this section. Carrying out these experiments have resulted in several standardized observers, which can be thought of as statistical approximations of actual human observers. First, however, we need to describe some of the assumptions underlying the possibility of color matching, which are summarized by <a id="index_term506"/><a id="index_term192"/>Grassmann’s laws.</p>
<section>
<h3 id="sec18_1_1"><span class="green">18.1.1 Grassmann’s Laws</span></h3>
<p>Given that humans have three different cone types, the experimental laws of color matching can be summed up as the trichromatic generalization (Wyszecki &amp; Stiles, 2000), which states that any color stimulus can be matched completely with an additive mixture of three appropriately modulated color sources. This feature of color is often used in practice, for instance by televisions and monitors which reproduce many different colors by adding a mixture of red, green, and blue light for each pixel. It is also the reason that renderers can be built using only three values to describe each color.</p>
<p>The trichromatic generalization allows us to make color matches between any given stimulus and an additive mixture of three other color stimuli. Hermann Grassmann was the first to describe the algebraic rules to which color matching adheres. They are known as Grassmann’s laws of additive color matching (Grassmann, 1853) and are the following:</p>
<ul class="list-bullet">
<li>
<p class="list"><span style="color:green"><a id="index_term1148"/>Symmetry law.</span> If color stimulus <em>A</em> matches color stimulus <em>B</em>, then <em>B</em> matches <em>A</em>.</p>
</li>
<li>
<p class="list"><span style="color:green"><a id="index_term1269"/>Transitive law.</span> If <em>A</em> matches <em>B</em> and <em>B</em> matches <em>C</em>, then <em>A</em> matches <em>C</em>.</p>
</li>
<li>
<p class="list"><span style="color:green"><a id="index_term910"/>Proportionality law.</span> If <em>A</em> matches <em>B</em>, then <em>αA</em> matches <em>αB</em>, where <em>α</em> is a positive scale factor.</p>
</li>
<li>
<p class="list"><a id="term-116"/><a id="term-146"/><a id="term-147"/><span aria-label="507" epub:type="pagebreak" id="pg_507" role="doc-pagebreak"/><span style="color:green">Additivity law.</span> If <em>A</em> matches <em>B</em>, <em>C</em> matches <em>D</em>, and <em>A</em> + <em>C</em> matches <em>B</em> + <em>D</em>, then it follows that <em>A</em> + <em>D</em> matches <em>B</em> + <em>C</em>.</p>
</li>
</ul>
<p class="indent">The <a id="index_term2"/>additivity law forms the basis for color matching and colorimetry as a whole.</p>
</section>
<section>
<h3 id="sec18_1_2"><span class="green">18.1.2 Cone Responses</span></h3>
<p>Each cone type is sensitive to a range of wavelengths, spanning most of the full visible range. However, sensitivity to wavelengths is not evenly distributed, but contains a peak wavelength at which sensitivity is greatest. The location of this peak wavelength is different for each cone type. The three cone types are classified as S, M, and L cones, where the letters stand for short, medium, and long, indicating where in the visible spectrum the peak sensitivity is located.</p>
<p>The response of a given cone is then the magnitude of the electrical signal it outputs, as a function of the spectrum of wavelengths incident upon the cone. The cone response functions for each cone type as a function of wavelength λ are then given by <em>L</em>(λ), <em>M</em> (λ), and <em>S</em>(λ). They are plotted in <a href="C23_chapter18.xhtml#f18_2">Figure 18.2</a>.</p>
<figure id="f18_2" tabindex="0">
<img alt="" src="../images/fig18_2.jpg"/>
<figcaption><p><span class="blue">Figure 18.2.</span> The <a id="index_term191"/>cone response functions for L, M, and S cones.</p></figcaption>
</figure>
<p>The actual response to a stimulus with a given spectral composition Φ(λ) is then given for each cone type by</p>
<div class="disp-formula">
<m:math xmlns:mml="http://www.w3.org/1998/Math/MathML" alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mi>L</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:msub><m:mrow><m:mo>∫</m:mo></m:mrow><m:mrow><m:mi>λ</m:mi></m:mrow></m:msub><m:mtext> </m:mtext><m:mi mathvariant="normal">Φ</m:mi><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo><m:mtext> </m:mtext><m:mi>L</m:mi><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo><m:mtext> </m:mtext><m:mi>d</m:mi><m:mi>λ</m:mi><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>M</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:msub><m:mrow><m:mo>∫</m:mo></m:mrow><m:mrow><m:mi>λ</m:mi></m:mrow></m:msub><m:mtext> </m:mtext><m:mi mathvariant="normal">Φ</m:mi><m:mo>⁢</m:mo><m:mtext> </m:mtext><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo><m:mtext> </m:mtext><m:mi>M</m:mi><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo><m:mtext> </m:mtext><m:mtext> </m:mtext><m:mi>d</m:mi><m:mi>λ</m:mi><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>S</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:msub><m:mrow><m:mo>∫</m:mo></m:mrow><m:mrow><m:mi>λ</m:mi></m:mrow></m:msub><m:mtext> </m:mtext><m:mtext> </m:mtext><m:mi mathvariant="normal">Φ</m:mi><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo><m:mtext> </m:mtext><m:mtext> </m:mtext><m:mi>S</m:mi><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo><m:mtext> </m:mtext><m:mtext> </m:mtext><m:mi>d</m:mi><m:mi>λ</m:mi><m:mo>,</m:mo></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>These three integrated responses are known as tristimulus values.</p>
</section>
<section>
<h3 id="sec18_1_3"><a id="index_term190"/><a id="term-110"/><a id="term-131"/><a id="term-132"/><a id="term-144"/><a id="term-145"/><span aria-label="508" epub:type="pagebreak" id="pg_508" role="doc-pagebreak"/><span class="green">18.1.3 Color Matching Experiments</span></h3>
<p>Given that tristimulus values are created by integrating the product of two functions over the visible range, it is immediately clear that the human visual system does not act as a simple wavelength detector. Rather, our photo-receptors act as approximately linear integrators. As a result, it is possible to find two different spectral compositions, say Φ<sub>1</sub>(λ) and Φ<sub>2</sub>(λ), that after integration yield the same response (<em>L, M, S</em>). This phenomenon is known as <em>metamerism</em>, an example of which is shown in <a href="C23_chapter18.xhtml#f18_3">Figure 18.3</a>.</p>
<figure id="f18_3" tabindex="0">
<img alt="" src="../images/fig18_3.jpg"/>
<figcaption><p><span class="blue">Figure 18.3.</span> Two stimuli Φ<sub>1</sub>(λ) and Φ<sub>2</sub>(λ) leading to the same tristimulus values after integration.</p></figcaption>
</figure>
<p>Metamerism is the key feature of human vision that allows the construction of color reproduction devices, including the color figures in this book and anything reproduced on printers, televisions, and monitors.</p>
<p>Color matching experiments also rely on the principle of metamerism. Suppose we have three differently colored light sources, each with a dial to alter its intensity. We call these three light sources primaries. We should now be able to adjust the intensity of each in such a way that when mixed together additively, the resulting spectrum integrates to a tristimulus value that matches the perceived color of a fourth unknown light source. When we carry out such an experiment, we have essentially matched our primaries to an unknown color. The positions of our three dials are then a representation of the color of the fourth light source.</p>
<p>In such an experiment, we have used Grassmann’s laws to add the three spectra of our primaries. We have also used metamerism, because the combined spectrum of our three primaries is almost certainly different from the spectrum of the <a id="term-149"/><a id="term-815"/><span aria-label="509" epub:type="pagebreak" id="pg_509" role="doc-pagebreak"/>fourth light source. However, the tristimulus values computed from these two spectra will be identical, having produced a color match.</p>
<p>Note that we do not actually have to know the cone response functions to carry out such an experiment. As long as we use the same observer under the same conditions, we are able to match colors and record the positions of our dials for each color. However, it is quite inconvenient to have to carry out such experiments every time we want to measure colors. For this reason, we do want to know the spectral cone response functions and average those for a set of different observers to eliminate interobserver variability.</p>
</section>
<section>
<h3 id="sec18_1_4"><span class="green">18.1.4 Standard Observers</span></h3>
<p>If we perform a color matching experiment for a large range of colors, carried out by a set of different observers, it is possible to generate an average color matching dataset. If we specifically use monochromatic light sources against which to match our primaries, we can repeat this experiment for all visible wavelengths. The resulting tristimulus values are then called <em><a id="index_term1113"/>spectral tristimulus values</em>, and can be plotted against wavelength λ, shown in <a href="C23_chapter18.xhtml#f18_4">Figure 18.4</a>.</p>
<figure id="f18_4" tabindex="0">
<img alt="" src="../images/fig18_4.jpg"/>
<figcaption><p><span class="blue">Figure 18.4.</span> Spectral tristimulus values averaged over many observers. The primaries where monochromatic light sources with wavelengths of 435.8, 546.1, and 700 nm.</p></figcaption>
</figure>
<p>By using a well-defined set of primary light sources, the spectral tristimulus values lead to three <a id="index_term155"/>color matching functions. The Commission Internationale d’Eclairage (CIE) has defined three such primaries to be monochromatic light sources of 435.8, 546.1, and 700 nm, respectively. With these three monochromatic <span aria-label="510" epub:type="pagebreak" id="pg_510" role="doc-pagebreak"/>light sources, all other visible wavelengths can be matched by adding different amounts of each. The amount of each required to match a given wavelength <em>λ</em> is encoded in color matching functions, given by <span class="inline-formula"><m:math alttext=""><m:mrow><m:mover><m:mrow><m:mi>r</m:mi></m:mrow><m:mrow><m:mo>¯</m:mo></m:mrow></m:mover><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo><m:mo>,</m:mo><m:mover><m:mrow><m:mi>g</m:mi></m:mrow><m:mrow><m:mo>¯</m:mo></m:mrow></m:mover><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo></m:mrow></m:math></span>, and <span class="inline-formula"><m:math alttext=""><m:mrow><m:mover><m:mrow><m:mi>b</m:mi></m:mrow><m:mrow><m:mo>¯</m:mo></m:mrow></m:mover><m:mrow><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math></span> and plotted in <a href="C23_chapter18.xhtml#f18_4">Figure 18.4</a>. Tristimulus values associated with these color matching functions are termed <em>R</em>, <em>G</em>,and <em>B</em>.</p>
<p>Given that we are adding light, and light cannot be negative, you may have noticed an anomaly in <a href="C23_chapter18.xhtml#f18_4">Figure 18.4</a>: to create a match for some wavelengths, it is necessary to subtract light. Although there is no such thing as negative light, we can use <a id="index_term507"/>Grassmann’s laws once more, and instead of subtracting light from the mixture of primaries, we can add the same amount of light to the color that is being matched.</p>
<p>The CIE <span class="inline-formula"><m:math alttext=""><m:mrow><m:mover><m:mrow><m:mi>r</m:mi></m:mrow><m:mrow><m:mo>¯</m:mo></m:mrow></m:mover><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo><m:mo>,</m:mo><m:mover><m:mrow><m:mi>g</m:mi></m:mrow><m:mrow><m:mo>¯</m:mo></m:mrow></m:mover><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo></m:mrow></m:math></span>, and <span class="inline-formula"><m:math alttext=""><m:mrow><m:mover><m:mrow><m:mi>b</m:mi></m:mrow><m:mrow><m:mo>¯</m:mo></m:mrow></m:mover><m:mrow><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math></span> color matching functions allow us to determine if a spectral distribution Φ<sub>1</sub> matches a second spectral distribution Φ<sub>2</sub> by simply comparing the resulting tristimulus values obtained by integrating with these color matching functions:</p>
<div class="disp-formula">
<m:math xmlns:mml="http://www.w3.org/1998/Math/MathML" alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mtable><m:mtr><m:mtd><m:mo>∫</m:mo></m:mtd></m:mtr></m:mtable></m:mrow><m:mrow><m:mi>λ</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi mathvariant="normal">Φ</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo><m:mover><m:mrow><m:mi>r</m:mi></m:mrow><m:mrow><m:mo>¯</m:mo></m:mrow></m:mover><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:msub><m:mrow><m:mo>∫</m:mo></m:mrow><m:mrow><m:mi>λ</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi mathvariant="normal">Φ</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo><m:mover><m:mrow><m:mi>r</m:mi></m:mrow><m:mrow><m:mo>¯</m:mo></m:mrow></m:mover><m:mrow><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo><m:mo>,</m:mo></m:mrow></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mtable><m:mtr><m:mtd><m:mo>∫</m:mo></m:mtd></m:mtr></m:mtable></m:mrow><m:mrow><m:mi>λ</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi mathvariant="normal">Φ</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo><m:mover><m:mrow><m:mi>g</m:mi></m:mrow><m:mrow><m:mo>¯</m:mo></m:mrow></m:mover><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:msub><m:mrow><m:mo>∫</m:mo></m:mrow><m:mrow><m:mi>λ</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi mathvariant="normal">Φ</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo><m:mover><m:mrow><m:mi>g</m:mi></m:mrow><m:mrow><m:mo>¯</m:mo></m:mrow></m:mover><m:mrow><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo><m:mo>,</m:mo></m:mrow></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mtable><m:mtr><m:mtd><m:mo>∫</m:mo></m:mtd></m:mtr></m:mtable></m:mrow><m:mrow><m:mi>λ</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi mathvariant="normal">Φ</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo><m:mover><m:mrow><m:mi>b</m:mi></m:mrow><m:mrow><m:mo>¯</m:mo></m:mrow></m:mover><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:msub><m:mrow><m:mo>∫</m:mo></m:mrow><m:mrow><m:mi>λ</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi mathvariant="normal">Φ</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo><m:mover><m:mrow><m:mi>b</m:mi></m:mrow><m:mrow><m:mo>¯</m:mo></m:mrow></m:mover><m:mrow><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo><m:mn>.</m:mn></m:mrow></m:mrow></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>Of course, a color match is only guaranteed if all three tristimulus values match.</p>
<p>The importance of these color matching functions lies in the fact that we are now able to communicate and describe colors compactly by means of tristimulus values. For a given spectral function, the <a id="index_term139"/>CIE color matching functions provide a precise way in which to calculate tristimulus values. As long as everybody uses the same color matching functions, it should always be possible to generate a match.</p>
<p>If the same color matching functions are not available, then it is possible to transform one set of tristimulus values into a different set of tristimulus values appropriate for a corresponding set of primaries. The CIE has defined one such a transform for two specific reasons. First, in the 1930s numerical integrations were difficult to perform, and even more so for functions that can be both positive and negative. Second, the CIE had already developed the photopic luminance response function, CIE <em>V</em> (λ). It became desirable to have three integrating functions, of which <em>V</em> (λ) is one and all three being positive over the visible range.</p>
<p>To create a set of positive color matching functions, it is necessary to define imaginary primaries. In other words, to reproduce any color in the visible spectrum, we need light sources that cannot be physically realized. The color matching functions that were settled upon by the CIE are named <span class="inline-formula"><m:math alttext=""><m:mrow><m:mover><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mo>¯</m:mo></m:mrow></m:mover><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo><m:mo>,</m:mo><m:mover><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mo>¯</m:mo></m:mrow></m:mover><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo></m:mrow></m:math></span>, and <span class="inline-formula"><m:math alttext=""><m:mrow><m:mover><m:mrow><m:mi>z</m:mi></m:mrow><m:mrow><m:mo>¯</m:mo></m:mrow></m:mover><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo></m:mrow></m:math></span> and are shown in <a href="C23_chapter18.xhtml#f18_5">Figure 18.5</a>. Note that <span class="inline-formula"><m:math alttext=""><m:mrow><m:mover><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mo>¯</m:mo></m:mrow></m:mover><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo></m:mrow></m:math></span> is equal to the photopic luminance response function <em>V</em> (λ) and that each of these functions is indeed positive. They are known as the CIE 1931 standard observer.</p>
<figure id="f18_5" tabindex="0">
<img alt="" src="../images/fig18_5.jpg"/>
<figcaption><p><span class="blue">Figure 18.5.</span> <a id="term-100"/><a id="term-107"/><a id="term-111"/><a id="term-141"/><span aria-label="511" epub:type="pagebreak" id="pg_511" role="doc-pagebreak"/>The CIE <span class="inline-formula"><m:math alttext=""><m:mrow><m:mover><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mo>¯</m:mo></m:mrow></m:mover><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo><m:mo>,</m:mo><m:mover><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mo>¯</m:mo></m:mrow></m:mover><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo></m:mrow></m:math></span>, and <span class="inline-formula"><m:math alttext=""><m:mrow><m:mover><m:mrow><m:mi>z</m:mi></m:mrow><m:mrow><m:mo>¯</m:mo></m:mrow></m:mover><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo></m:mrow></m:math></span> color matching functions.</p></figcaption>
</figure>
<p>The corresponding tristimulus values are termed <em>X</em>, <em>Y</em> , and <em>Z</em>, to avoid confusion with <em>R</em>, <em>G</em>,and <em>B</em> tristimulus values that are normally associated with realizable primaries. The conversion from (<em>R, G, B</em>) tristimulus values to (<em>X, Y, Z</em>) tristimulus values is defined by a simple 3 <em>×</em> 3 transform:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mi>X</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>Y</m:mi></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>Z</m:mi></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mo>=</m:mo><m:mfrac><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>0.17697</m:mn></m:mrow></m:mfrac><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mn>0.4900</m:mn></m:mtd><m:mtd><m:mn>0.3100</m:mn></m:mtd><m:mtd><m:mn>0.2000</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0.17697</m:mn></m:mtd><m:mtd><m:mn>0.81240</m:mn></m:mtd><m:mtd><m:mn>0.01063</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0.0000</m:mn></m:mtd><m:mtd><m:mn>0.0100</m:mn></m:mtd><m:mtd><m:mn>0.9900</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mo>⋅</m:mo><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mi>R</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>G</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>B</m:mi></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mo>⋅</m:mo></m:mrow></m:math>
</div>
<p class="indent">To calculate tristimulus values, we typically directly integrate the standard observer color matching functions with the spectrum of interest Φ(λ), rather than go through the CIE <span class="inline-formula"><m:math alttext=""><m:mrow><m:mover><m:mrow><m:mi>r</m:mi></m:mrow><m:mrow><m:mo>¯</m:mo></m:mrow></m:mover><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo><m:mo>,</m:mo><m:mover><m:mrow><m:mi>g</m:mi></m:mrow><m:mrow><m:mo>¯</m:mo></m:mrow></m:mover><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo></m:mrow></m:math></span>, and <span class="inline-formula"><m:math alttext=""><m:mrow><m:mover><m:mrow><m:mi>b</m:mi></m:mrow><m:mrow><m:mo>¯</m:mo></m:mrow></m:mover><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo></m:mrow></m:math></span> color matching functions first, followed by the above transformation. It allows us to calculate consistent color measurements and also determine when two colors match each other.</p>
</section>
<section>
<h3 id="sec18_1_5"><a id="index_term188"/><span class="green">18.1.5 Chromaticity Coordinates</span></h3>
<p>Every color can be represented by a set of three tristimulus values (<em>X, Y, Z</em>). We could define an orthogonal coordinate system with <em>X</em>, <em>Y</em> , and <em>Z</em> axes and plot each color in the resulting 3D space. This is called a <em>color space</em>. The spatial extent of the volume in which colors lie is then called the color gamut.</p>
<section>
<p class="indent"><span aria-label="512" epub:type="pagebreak" id="pg_512" role="doc-pagebreak"/>Visualizing colors in a 3D color space is fairly difficult. Moreover, the <em>Y</em> value of any color corresponds to its luminance, by virtue of the fact that <span class="inline-formula"><m:math alttext=""><m:mrow><m:mover><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mo>¯</m:mo></m:mrow></m:mover><m:mo>(</m:mo><m:mi>λ</m:mi><m:mo>)</m:mo></m:mrow></m:math></span> equals <em>V</em> (λ). We could therefore project tristimulus values to a 2D space which approximates chromatic information, i.e., information which is independent of luminance. This projection is called a <em>chromaticity diagram</em> and is obtained by normalization while at the same time removing luminance information:</p>
<div class="disp-formula">
<m:math xmlns:mml="http://www.w3.org/1998/Math/MathML" alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mi>x</m:mi><m:mo>=</m:mo><m:mfrac><m:mrow><m:mi>X</m:mi></m:mrow><m:mrow><m:mi>X</m:mi><m:mo>+</m:mo><m:mi>Y</m:mi><m:mo>+</m:mo><m:mi>Z</m:mi></m:mrow></m:mfrac><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>y</m:mi><m:mo>=</m:mo><m:mfrac><m:mrow><m:mi>Y</m:mi></m:mrow><m:mrow><m:mi>X</m:mi><m:mo>+</m:mo><m:mi>Y</m:mi><m:mo>+</m:mo><m:mi>Z</m:mi></m:mrow></m:mfrac><m:mo>,</m:mo></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>z</m:mi><m:mo>=</m:mo><m:mfrac><m:mrow><m:mi>Z</m:mi></m:mrow><m:mrow><m:mi>X</m:mi><m:mo>+</m:mo><m:mi>Y</m:mi><m:mo>+</m:mo><m:mi>Z</m:mi></m:mrow></m:mfrac><m:mn>.</m:mn></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>Given that <em>x</em> + <em>y</em> + <em>z</em> equals 1, the <em>z</em>-value is redundant, allowing us to plot the <em>x</em> and <em>y</em> chromaticities against each other in a chromaticity diagram. Although <em>x</em> and <em>y</em> by themselves are not sufficient to fully describe a color, we can use these two chromaticity coordinates and one of the three tristimulus values, traditionally <em>Y</em>, to recover the other two tristimulus values:</p>
<div class="disp-formula">
<m:math xmlns:mml="http://www.w3.org/1998/Math/MathML" alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mi>X</m:mi><m:mo>=</m:mo><m:mfrac><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>y</m:mi></m:mrow></m:mfrac><m:mi>Y</m:mi><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>Z</m:mi><m:mo>=</m:mo><m:mfrac><m:mrow><m:mn>1</m:mn><m:mo>−</m:mo><m:mi>x</m:mi><m:mo>−</m:mo><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>y</m:mi></m:mrow></m:mfrac><m:mi>Y</m:mi><m:mn>.</m:mn></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p class="indent">By plotting all monochromatic (spectral) colors in a chromaticity diagram, we obtain a horseshoe-shaped curve. The points on this curve are called <em>spectrum loci</em>. All other colors will generate points lying inside this curve. The spectrum locus for the 1931 standard observer is shown in <a href="C23_chapter18.xhtml#f18_6">Figure 18.6</a>. The purple line between either end of the horseshoe does not represent a monochromatic color, but rather a combination of short and long wavelength stimuli.</p>
<figure id="f18_6" tabindex="0">
<img alt="" src="../images/fig18_6.jpg"/>
<figcaption><p><span class="blue">Figure 18.6.</span> The spectrum locus for the CIE 1931 standard observer.</p></figcaption>
</figure>
<p><a id="term-98"/><a id="term-108"/><a id="term-142"/><span aria-label="513" epub:type="pagebreak" id="pg_513" role="doc-pagebreak"/>A (non-monochromatic) primary can be integrated over all visible wavelengths, leading to (<em>X, Y, Z</em>) tristimulus values, and subsequently to an (<em>x, y</em>) chromaticity coordinate, i.e., a point on a chromaticity diagram. Repeating this for two or more primaries yields a set of points on a chromaticity diagram that can be connected by straight lines. The volume spanned in this manner represents the range of colors that can be reproduced by the additive mixture of these primaries. Examples of three-primary systems are shown in <a href="C23_chapter18.xhtml#f18_7">Figure 18.7</a>.</p>
<figure id="f18_7" tabindex="0">
<img alt="" src="../images/fig18_7.jpg"/>
<figcaption><p><span class="blue">Figure 18.7.</span> The chromaticity boundaries of the CIE RGB primaries at 435.8, 546.1, and 700 nm (solid) and a typical HDTV (dashed).</p></figcaption>
</figure>
<p>Chromaticity diagrams provide insight into additive color mixtures. However, they should be used with care. First, the interior of the horseshoe should not be colored, as any color reproduction system will have its own primaries and can only reproduce some parts of the chromaticity diagram. Second, as the CIE color matching functions do not represent human cone sensitivities, the distance between any two points on a chromaticity diagram is not a good indicator for how differently these colors will be perceived.</p>
<p>A more uniform chromaticity diagram was developed to at least in part address the second of these problems. The CIE <em>u</em>′ <em>v</em>′ chromaticity diagram provides a perceptually more uniform spacing and is therefore generally preferred over (<em>x, y</em>) chromaticity diagrams. It is computed from (<em>X, Y, Z</em>) tristimulus values by applying a different normalization,</p>
<div class="disp-formula">
<m:math xmlns:mml="http://www.w3.org/1998/Math/MathML" alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:msup><m:mrow><m:mi>u</m:mi></m:mrow><m:mrow><m:mo>′</m:mo></m:mrow></m:msup><m:mo>=</m:mo><m:mfrac><m:mrow><m:mn>4</m:mn><m:mi>X</m:mi></m:mrow><m:mrow><m:mi>X</m:mi><m:mo>+</m:mo><m:mn>15</m:mn><m:mi>Y</m:mi><m:mo>+</m:mo><m:mn>3</m:mn><m:mi>Z</m:mi></m:mrow></m:mfrac><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:msup><m:mrow><m:mi>v</m:mi></m:mrow><m:mrow><m:mo>′</m:mo></m:mrow></m:msup><m:mo>=</m:mo><m:mfrac><m:mrow><m:mn>9</m:mn><m:mi>Y</m:mi></m:mrow><m:mrow><m:mi>X</m:mi><m:mo>+</m:mo><m:mn>15</m:mn><m:mi>Y</m:mi><m:mo>+</m:mo><m:mn>3</m:mn><m:mi>Z</m:mi></m:mrow></m:mfrac><m:mn>.</m:mn></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p class="noindent"><a id="term-99"/><a id="term-101"/><a id="term-109"/><a id="term-133"/><a id="term-143"/><span aria-label="514" epub:type="pagebreak" id="pg_514" role="doc-pagebreak"/>and can alternatively be computed directly from (<em>x, y</em>) chromaticity coordinates:</p>
<div class="disp-formula">
<m:math xmlns:mml="http://www.w3.org/1998/Math/MathML" alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mi mathvariant="italic">u</m:mi><m:mo>′</m:mo><m:mo>=</m:mo><m:mfrac><m:mrow><m:mi mathvariant="normal">4</m:mi><m:mi mathvariant="italic">x</m:mi></m:mrow><m:mrow><m:mo>−</m:mo><m:mi mathvariant="normal">2</m:mi><m:mi mathvariant="italic">x</m:mi><m:mi mathvariant="normal">+</m:mi><m:mi mathvariant="normal">1</m:mi><m:mi mathvariant="normal">2</m:mi><m:mi mathvariant="italic">y</m:mi><m:mi mathvariant="normal">+</m:mi><m:mi mathvariant="normal">3</m:mi></m:mrow></m:mfrac><m:mi mathvariant="normal">,</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:msup><m:mrow><m:mi>v</m:mi></m:mrow><m:mrow><m:mo>′</m:mo></m:mrow></m:msup><m:mo>=</m:mo><m:mfrac><m:mrow><m:mn>9</m:mn><m:mi>y</m:mi></m:mrow><m:mrow><m:mo>−</m:mo><m:mn>2</m:mn><m:mi>x</m:mi><m:mo>+</m:mo><m:mn>12</m:mn><m:mi>y</m:mi><m:mo>+</m:mo><m:mn>3</m:mn></m:mrow></m:mfrac><m:mn>.</m:mn></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>A CIE <em>u</em>' <em>v</em>' chromaticity diagram is shown in <a href="C23_chapter18.xhtml#f18_8">Figure 18.8</a>.</p>
<figure id="f18_8" tabindex="0">
<img alt="" src="../images/fig18_8.jpg"/>
<figcaption><p><span class="blue">Figure 18.8.</span> The CIE <em>u</em>' <em>v</em>' chromaticity diagram.</p></figcaption>
</figure>
</section>
</section>
</section>
<section>
<h2 id="sec18_2"><a id="index_term182"/><a epub:type="backlink" href="C02a_toc.xhtml#rsec18_2" role="doc-backlink"><span class="green">18.2 Color Spaces</span></a></h2>
<p>As explained above, each color can be represented by three numbers, for instance defined by (<em>X, Y, Z</em>) tristimulus values. However, its primaries are imaginary, meaning that it is not possible to construct a device that has three light sources (all positive) that can reproduce all colors in the visible spectrum.</p>
<p>For the same reason, image encoding and computations on images may not be practical. There is, for instance, a large number of possible <em>XYZ</em> values that do not correspond to any physical color. This would lead to inefficient use of available bits for storage and to a higher requirement for bit-depth to preserve visual integrity after image processing. Although it may be possible to build a capture device that has primaries that are close to the CIE <em>XYZ</em> color matching functions, the cost of hardware and image processing make this an unattractive option. It is not possible to build a display that corresponds to CIE <em>XYZ</em>. For these reasons, it is necessary to design other color spaces: physical realizability, efficient encoding, perceptual uniformity, and intuitive color specification.</p>
<p>The CIE <em>XYZ</em> color space is still actively used, mostly for the conversion between other color spaces. It can be seen as a device-independent color space. <span aria-label="515" epub:type="pagebreak" id="pg_515" role="doc-pagebreak"/>Other color spaces can then be defined in terms of their relationship to CIE <em>XY Z</em>, which is often specified by a specific <a id="index_term723"/>transform. For instance, linear and additive trichromatic display devices can be transformed to and from CIE <em>XY Z</em> by means of a simple 3 <em>×</em> 3 matrix. Some nonlinear additional transform may also be specified, for instance to minimize perceptual errors when data is stored with a limited bit-depth, or to enable display directly on devices that have a nonlinear relationship between input signal and the amount of light emitted.</p>
<section>
<h3 id="sec18_2_1"><a id="index_term165"/><span class="green">18.2.1 Constructing a Matrix Transform</span></h3>
<p>For a display device with three primaries, say red, green, and blue, we can measure the spectral composition of the emitted light by sending the color vectors (1<em>,</em> 0<em>,</em> 0), (0<em>,</em> 1<em>,</em> 0), and (0<em>,</em> 0<em>,</em> 1). These vectors represent the three cases namely where one of the primaries is full on, and the other two are off. From the measured spectral output, we can then compute the corresponding chromaticity coordinates (<em>x<sub>R</sub>,y<sub>R</sub></em>), (<em>x<sub>G</sub>,y<sub>G</sub></em>), and (<em>x<sub>B</sub>,y<sub>B</sub></em>).</p>
<p>The <em>white point</em> of a display is defined as the spectrum emitted when the color vector (1<em>,</em> 1<em>,</em> 1) is sent to the display. Its corresponding chromaticity coordinate is (<em>x<sub>W</sub>,y<sub>W</sub></em> ). The three primaries and the white point characterize the display and are each required to construct a transformation matrix between the display’s color space and CIE <em>XY Z</em>.</p>
<p>These four chromaticity coordinates can be extended to chromaticity triplets reconstructing the <em>z</em>-coordinate from <em>z</em> = 1—<em>x</em>—<em>y</em>, leading to triplets (<em>x<sub>R</sub>,y<sub>R</sub>,z<sub>R</sub></em>) (<em>x<sub>G</sub>,y<sub>G</sub>,z<sub>G</sub></em>), (<em>x<sub>B</sub>,y<sub>B</sub>,z<sub>B</sub></em>), and (<em>x<sub>W</sub>,y<sub>W</sub>,z<sub>W</sub></em> ). If we know the maximum luminance of the white point, we can compute its corresponding tristimulus value (<em>X<sub>W</sub>,Y<sub>W</sub>,Z<sub>W</sub></em> ) and then solve the following set of equations for the luminance ratio scalars <em>S<sub>R</sub></em>, <em>S<sub>G</sub></em>, and <em>S<sub>B</sub></em>:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="italic">X</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">W</m:mi></m:mrow></m:msub></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:msub><m:mrow><m:mi mathvariant="italic">x</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">R</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi mathvariant="italic">S</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">R</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:msub><m:mrow><m:mi mathvariant="italic">x</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">G</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi mathvariant="italic">S</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">G</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:msub><m:mrow><m:mi mathvariant="italic">x</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">B</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi mathvariant="italic">S</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">B</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">,</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="italic">Y</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">W</m:mi></m:mrow></m:msub></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:msub><m:mrow><m:mi mathvariant="italic">y</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">R</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi mathvariant="italic">S</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">R</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:msub><m:mrow><m:mi mathvariant="italic">y</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">G</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi mathvariant="italic">S</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">G</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:msub><m:mrow><m:mi mathvariant="italic">y</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">B</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi mathvariant="italic">S</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">B</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">,</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi mathvariant="italic">Z</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">W</m:mi></m:mrow></m:msub></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:msub><m:mrow><m:mi mathvariant="italic">z</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">R</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi mathvariant="italic">S</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">R</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:msub><m:mrow><m:mi mathvariant="italic">z</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">G</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi mathvariant="italic">S</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">G</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:msub><m:mrow><m:mi mathvariant="italic">z</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">B</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi mathvariant="italic">S</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">B</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">.</m:mi></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>The conversion between RGB and XYZ is then given by</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mi>X</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>Y</m:mi></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>Z</m:mi></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mo>=</m:mo><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>R</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>S</m:mi></m:mrow><m:mrow><m:mi>R</m:mi></m:mrow></m:msub></m:mtd><m:mtd><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>G</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>S</m:mi></m:mrow><m:mrow><m:mi>G</m:mi></m:mrow></m:msub></m:mtd><m:mtd><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>B</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>S</m:mi></m:mrow><m:mrow><m:mi>B</m:mi></m:mrow></m:msub></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>R</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>S</m:mi></m:mrow><m:mrow><m:mi>R</m:mi></m:mrow></m:msub></m:mtd><m:mtd><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>G</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>S</m:mi></m:mrow><m:mrow><m:mi>G</m:mi></m:mrow></m:msub></m:mtd><m:mtd><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>B</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>S</m:mi></m:mrow><m:mrow><m:mi>B</m:mi></m:mrow></m:msub></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi>z</m:mi></m:mrow><m:mrow><m:mi>R</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>S</m:mi></m:mrow><m:mrow><m:mi>R</m:mi></m:mrow></m:msub></m:mtd><m:mtd><m:msub><m:mrow><m:mi>z</m:mi></m:mrow><m:mrow><m:mi>G</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>S</m:mi></m:mrow><m:mrow><m:mi>G</m:mi></m:mrow></m:msub></m:mtd><m:mtd><m:msub><m:mrow><m:mi>z</m:mi></m:mrow><m:mrow><m:mi>B</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>S</m:mi></m:mrow><m:mrow><m:mi>B</m:mi></m:mrow></m:msub></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mi>R</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>G</m:mi></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>B</m:mi></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mn>.</m:mn></m:mrow></m:math>
</div>
<p>The luminance of any given color can be computed by evaluating the middle row of a matrix constructed in this manner:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mi mathvariant="italic">Y</m:mi><m:mo>=</m:mo><m:msub><m:mrow><m:mi mathvariant="italic">y</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">R</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi mathvariant="italic">S</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">R</m:mi></m:mrow></m:msub><m:mi mathvariant="italic">R</m:mi><m:mo>+</m:mo><m:msub><m:mrow><m:mi mathvariant="italic">y</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">G</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi mathvariant="italic">S</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">G</m:mi></m:mrow></m:msub><m:mi mathvariant="italic">G</m:mi><m:mo>+</m:mo><m:msub><m:mrow><m:mi mathvariant="italic">y</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">B</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi mathvariant="italic">S</m:mi></m:mrow><m:mrow><m:mi mathvariant="italic">B</m:mi></m:mrow></m:msub><m:mi mathvariant="italic">B</m:mi><m:mi mathvariant="normal">.</m:mi></m:mrow></m:math>
</div>
<p class="indent"><span aria-label="516" epub:type="pagebreak" id="pg_516" role="doc-pagebreak"/>To convert between XYZ and RGB of a given device, the above matrix can simply be inverted.</p>
<p>If an image is represented in an RGB color space for which the primaries and white point are unknown, then the next best thing is to assume that the image was encoded in a standard RGB color space. A reasonable choice is then to assume that the image was specified according to ITU-R BT.709, which is the specification used for encoding and broadcasting of HDTV. Its primaries and white point are specified in <a href="C23_chapter18.xhtml#t18_1">Table 18.1</a>. Note that the same primaries and white point are used to define the well-known sRGB color space. The transformation between this RGB color space and CIE XYZ is and vice versa given by</p>
<table class="table1" id="t18_1">
<caption><span class="blue"><strong>Table 18.1</strong></span> The (<em>x, y</em>) chromaticity coordinates for the primaries and white point specified by ITU-R BT.709. The sRGB standard also uses these primaries and white point.</caption>
<thead>
<tr>
<th scope="col"/>
<th scope="col"><p class="tabtexth"><em>R</em></p></th>
<th scope="col"><p class="tabtexth"><em>G</em></p></th>
<th scope="col"><p class="tabtexth"><em>B</em></p></th>
<th scope="col"><p class="tabtexth">White</p></th>
</tr>
</thead>
<tbody>
<tr>
<td><p class="tabtext"><em>x</em></p></td>
<td><p class="tabtext">0.6400</p></td>
<td><p class="tabtext">0.3000</p></td>
<td><p class="tabtext">0.1500</p></td>
<td><p class="tabtext">0.3127</p></td>
</tr>
<tr>
<td><p class="tabtext"><em>y</em></p></td>
<td><p class="tabtext">0.3300</p></td>
<td><p class="tabtext">0.6000</p></td>
<td><p class="tabtext">0.0600</p></td>
<td><p class="tabtext">0.3290</p></td>
</tr>
</tbody>
</table>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mi>X</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>Y</m:mi></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>Z</m:mi></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mn>0.4124</m:mn></m:mtd><m:mtd><m:mn>0.3576</m:mn></m:mtd><m:mtd><m:mn>0.1805</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0.2126</m:mn></m:mtd><m:mtd><m:mn>0.7152</m:mn></m:mtd><m:mtd><m:mn>0.0722</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0.0193</m:mn></m:mtd><m:mtd><m:mn>0.1192</m:mn></m:mtd><m:mtd><m:mn>0.9505</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mi>R</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>G</m:mi></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>B</m:mi></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mo>;</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mi>R</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>G</m:mi></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>B</m:mi></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mn>3.2405</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>1.5371</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>0.4985</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mo>−</m:mo><m:mn>0.9693</m:mn></m:mtd><m:mtd><m:mn>1.8706</m:mn></m:mtd><m:mtd><m:mn>0.0416</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0.0556</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>0.2040</m:mn></m:mtd><m:mtd><m:mn>1.0572</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mi>X</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>Y</m:mi></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>Z</m:mi></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mn>.</m:mn></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p class="indent">By substituting the maximum <em>RGB</em> values of the device, we can compute the white point. For ITU-R BT.709, the maximum values are (<em>R<sub>W</sub>,G<sub>W</sub>,B<sub>W</sub></em> ) = (100<em>,</em> 100<em>,</em> 100), leading to a white point of (<em>X<sub>W</sub>,Y<sub>W</sub>,Z<sub>W</sub></em> ) = (95<em>.</em>05<em>,</em> 100<em>.</em>00<em>,</em> 108<em>.</em>90).</p>
<p>In addition to a linear transformation, the sRGB color space is characterized by a subsequent nonlinear transform. The nonlinear encoding is given by</p>
<div class="disp-formula">
<m:math xmlns:mml="http://www.w3.org/1998/Math/MathML" alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi>R</m:mi></m:mrow><m:mrow><m:mtext>sRGB</m:mtext></m:mrow></m:msub><m:mo>=</m:mo><m:mo>{</m:mo><m:mtable columnalign="left"><m:mtr><m:mtd><m:mn>1.055</m:mn><m:mtext> </m:mtext><m:msup><m:mrow><m:mi>R</m:mi></m:mrow><m:mrow><m:mn>1</m:mn><m:mo>/</m:mo><m:mn>2.4</m:mn></m:mrow></m:msup><m:mo>−</m:mo><m:mn>0.055</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>12.92</m:mn><m:mtext> </m:mtext><m:mi>R</m:mi></m:mtd></m:mtr></m:mtable></m:mtd><m:mtd columnalign="left"><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mi>R</m:mi><m:mo>&gt;</m:mo><m:mn>0.0031308</m:mn><m:mo>,</m:mo></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>R</m:mi><m:mo>≤</m:mo><m:mn>0.0031308</m:mn><m:mo>;</m:mo></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi>G</m:mi></m:mrow><m:mrow><m:mtext>sRGB</m:mtext></m:mrow></m:msub><m:mo>=</m:mo><m:mo>{</m:mo><m:mtable columnalign="left"><m:mtr><m:mtd><m:mn>1.055</m:mn><m:mtext> </m:mtext><m:msup><m:mrow><m:mi>G</m:mi></m:mrow><m:mrow><m:mn>1</m:mn><m:mo>/</m:mo><m:mn>2.4</m:mn></m:mrow></m:msup><m:mo>−</m:mo><m:mn>0.055</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>12.92</m:mn><m:mtext> </m:mtext><m:mi>G</m:mi></m:mtd></m:mtr></m:mtable><m:mtext> </m:mtext></m:mtd><m:mtd columnalign="left"><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mi>G</m:mi><m:mo>&gt;</m:mo><m:mn>0.0031308</m:mn><m:mo>,</m:mo></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>G</m:mi><m:mo>≤</m:mo><m:mn>0.0031308</m:mn><m:mo>;</m:mo></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi>B</m:mi></m:mrow><m:mrow><m:mtext>sRGB</m:mtext></m:mrow></m:msub><m:mo>=</m:mo><m:mo>{</m:mo><m:mtable columnalign="left"><m:mtr><m:mtd><m:mn>1.055</m:mn><m:mtext> </m:mtext><m:msup><m:mrow><m:mi>B</m:mi></m:mrow><m:mrow><m:mn>1</m:mn><m:mo>/</m:mo><m:mn>2.4</m:mn></m:mrow></m:msup><m:mo>−</m:mo><m:mn>0.055</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>12.92</m:mn><m:mtext> </m:mtext><m:mi>B</m:mi></m:mtd></m:mtr></m:mtable></m:mtd><m:mtd columnalign="left"><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mi>B</m:mi><m:mo>&gt;</m:mo><m:mn>0.0031308</m:mn><m:mo>,</m:mo></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>B</m:mi><m:mo>≤</m:mo><m:mn>0.0031308</m:mn><m:mo>,</m:mo></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>This nonlinear encoding helps minimize perceptual errors due to quantization errors in digital applications.</p>
</section>
<section>
<h3 id="sec18_2_2"><span aria-label="517" epub:type="pagebreak" id="pg_517" role="doc-pagebreak"/><span class="green">18.2.2 Device-Dependent RGB Spaces</span></h3>
<p>As each device typically has its own set of primaries and white point, we call the associated <a id="index_term171"/><a id="index_term996"/>RGB color spaces device-dependent. It should be noted that even if all these devices operate in an RGB space, they may have very different primaries and white points. If we therefore have an image specified in some RGB space, it may appear very different to us, depending upon which device we display it.</p>
<p>This is clearly an undesirable situation, resulting from a lack of color management. However, if the image is specified in a known RGB color space, it can first be converted to XYZ, which is device independent, and then subsequently it can be converted to the <a id="index_term173"/>RGB space of the device on which it will be displayed.</p>
<p>There are several other RGB color spaces that are well defined. They each consist of a linear matrix transform followed by a nonlinear transform, akin to the aforementioned sRGB color space. The nonlinear transform can be parameterized as follows:</p>
<div class="disp-formula">
<m:math xmlns:mml="http://www.w3.org/1998/Math/MathML" alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi>R</m:mi></m:mrow><m:mrow><m:mtext>nonlinear</m:mtext></m:mrow></m:msub><m:mo>=</m:mo><m:mo>{</m:mo><m:mtable columnalign="left"><m:mtr><m:mtd><m:mrow><m:mo>(</m:mo><m:mn>1</m:mn><m:mo>+</m:mo><m:mi>f</m:mi><m:mo>)</m:mo></m:mrow><m:mtext> </m:mtext><m:msup><m:mrow><m:mi>R</m:mi></m:mrow><m:mrow><m:mi>γ</m:mi></m:mrow></m:msup><m:mo>−</m:mo><m:mi>f</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>s</m:mi><m:mtext> </m:mtext><m:mi>R</m:mi></m:mtd></m:mtr></m:mtable></m:mtd><m:mtd columnalign="left"><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mi>t</m:mi><m:mo>&lt;</m:mo><m:mi>R</m:mi><m:mo>≤</m:mo><m:mn>1</m:mn><m:mo>,</m:mo></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0</m:mn><m:mo>≤</m:mo><m:mi>R</m:mi><m:mo>≤</m:mo><m:mi>t</m:mi><m:mo>;</m:mo></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi>G</m:mi></m:mrow><m:mrow><m:mtext>nonlinear</m:mtext></m:mrow></m:msub><m:mo>=</m:mo><m:mo>{</m:mo><m:mtext> </m:mtext><m:mtable columnalign="left"><m:mtr><m:mtd><m:mrow><m:mo>(</m:mo><m:mn>1</m:mn><m:mo>+</m:mo><m:mi>f</m:mi><m:mo>)</m:mo></m:mrow><m:mtext> </m:mtext><m:msup><m:mrow><m:mi>G</m:mi></m:mrow><m:mrow><m:mi>γ</m:mi></m:mrow></m:msup><m:mo>−</m:mo><m:mi>f</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>s</m:mi><m:mtext>G</m:mtext></m:mtd></m:mtr></m:mtable></m:mtd><m:mtd columnalign="left"><m:mtable><m:mtr><m:mtd><m:mi>t</m:mi><m:mo>&lt;</m:mo><m:mi>G</m:mi><m:mo>≤</m:mo><m:mn>1</m:mn><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0</m:mn><m:mo>≤</m:mo><m:mi>G</m:mi><m:mo>≤</m:mo><m:mi>t</m:mi><m:mo>;</m:mo></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi>B</m:mi></m:mrow><m:mrow><m:mtext>nonlinear</m:mtext></m:mrow></m:msub><m:mo>=</m:mo><m:mo>{</m:mo><m:mtable columnalign="left"><m:mtr><m:mtd><m:mrow><m:mo>(</m:mo><m:mn>1</m:mn><m:mo>+</m:mo><m:mi>f</m:mi><m:mo>)</m:mo></m:mrow><m:mtext> </m:mtext><m:mtext> </m:mtext><m:msup><m:mrow><m:mi>B</m:mi></m:mrow><m:mrow><m:mi>γ</m:mi></m:mrow></m:msup><m:mo>−</m:mo><m:mi>f</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>s</m:mi><m:mtext> </m:mtext><m:mi>B</m:mi></m:mtd></m:mtr></m:mtable></m:mtd><m:mtd columnalign="left"><m:mtable><m:mtr><m:mtd><m:mi>t</m:mi><m:mo>&lt;</m:mo><m:mi>B</m:mi><m:mo>≤</m:mo><m:mn>1</m:mn><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0</m:mn><m:mo>≤</m:mo><m:mi>B</m:mi><m:mo>≤</m:mo><m:mi>t</m:mi><m:mn>.</m:mn></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>The parameters <em>s</em>, <em>f</em> , <em>t</em> and γ, together with primaries and white point, specify a class of RGB color spaces that are used in various industries. Several common transformations are listed in <a href="C23_chapter18.xhtml#t18_2">Table 18.2</a>.</p>
<table class="table" id="t18_2">
<caption><strong><span class="blue">Table 18.2</span></strong> Transformations for standard RGB color spaces (after (Pascale, 2003)).</caption>
<thead>
<tr>
<th scope="col"><p class="tabtexth">Color space</p></th>
<th scope="col"><p class="tabtexth">XYZ to RGB matrix</p></th>
<th scope="col"><p class="tabtexth">RGB to XYZ matrix</p></th>
<th scope="col"><p class="tabtexth">Nonlinear transform</p></th>
</tr>
</thead>
<tbody>
<tr>
<td class="border"><p class="tabtext">sRGB</p></td>
<td class="border"><div class="disp-formula">
<m:math alttext=""><m:mrow><m:mo>[</m:mo><m:mtable columnalign="left"><m:mtr><m:mtd><m:mn>3.2405</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>1.5371</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>0.4985</m:mn></m:mtd></m:mtr><m:mtr><m:mtd columnalign="left"><m:mo>−</m:mo><m:mn>0.9693</m:mn></m:mtd><m:mtd columnalign="center"><m:mn>1.8760</m:mn></m:mtd><m:mtd columnalign="center"><m:mn>0.0416</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0.0556</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>0.2040</m:mn></m:mtd><m:mtd columnalign="center"><m:mn>1.0572</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow></m:math>
</div></td>
<td class="border"><div class="disp-formula">
<m:math alttext=""><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mn>0.4124</m:mn></m:mtd><m:mtd><m:mn>0.3576</m:mn></m:mtd><m:mtd><m:mn>0.1805</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0.2126</m:mn></m:mtd><m:mtd><m:mn>0.7152</m:mn></m:mtd><m:mtd><m:mn>0.0722</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0.0193</m:mn></m:mtd><m:mtd><m:mn>0.1192</m:mn></m:mtd><m:mtd><m:mn>0.9505</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow></m:math>
</div></td>
<td class="border"><div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mi>γ</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mn>1</m:mn><m:mo>/</m:mo><m:mn>2.4</m:mn><m:mo>≈</m:mo><m:mn>0.42</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>f</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mn>0.055</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>s</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mn>12.92</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>t</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mn>0.0031308</m:mn></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div></td>
</tr>
<tr>
<td class="border"><p class="tabtext">Adobe RGB (1998)</p></td>
<td class="border"><div class="disp-formula">
<m:math alttext=""><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd columnalign="right"><m:mn>2.0414</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>0.5649</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>0.3447</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mo>−</m:mo><m:mn>0.9693</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>1.8760</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>0.0416</m:mn></m:mtd></m:mtr><m:mtr><m:mtd columnalign="right"><m:mn>0.0134</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>0.1184</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>1.0154</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow></m:math>
</div></td>
<td class="border"><div class="disp-formula">
<m:math alttext=""><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd columnalign="right"><m:mn>0.5767</m:mn></m:mtd><m:mtd><m:mn>0.1856</m:mn></m:mtd><m:mtd><m:mn>0.1882</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0.2974</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>0.6273</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>0.0753</m:mn></m:mtd></m:mtr><m:mtr><m:mtd columnalign="right"><m:mn>0.0270</m:mn></m:mtd><m:mtd><m:mn>0.0707</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>0.9911</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow></m:math>
</div></td>
<td class="border"><div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mi>γ</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mfrac><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mfrac><m:mrow><m:mn>51</m:mn></m:mrow><m:mrow><m:mn>256</m:mn></m:mrow></m:mfrac></m:mrow></m:mfrac><m:mo>≈</m:mo><m:mfrac><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2.2</m:mn></m:mrow></m:mfrac></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>f</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mtext>N.A.</m:mtext></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>s</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mtext>N.A.</m:mtext></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>t</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mtext>N.A.</m:mtext></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div></td>
</tr>
<tr>
<td class="border"><p class="tabtext">HDTV (HD-CIF)</p></td>
<td class="border"><div class="disp-formula">
<m:math alttext=""><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd columnalign="right"><m:mn>3.2405</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>1.5371</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>0.4985</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mo>−</m:mo><m:mn>0.9693</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>1.8760</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>0.0416</m:mn></m:mtd></m:mtr><m:mtr><m:mtd columnalign="right"><m:mn>0.0556</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>0.2040</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>1.0572</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow></m:math>
</div></td>
<td class="border"><div class="disp-formula">
<m:math alttext=""><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mn>0.4124</m:mn></m:mtd><m:mtd><m:mn>0.3576</m:mn></m:mtd><m:mtd><m:mn>0.1805</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0.2126</m:mn></m:mtd><m:mtd><m:mn>0.7152</m:mn></m:mtd><m:mtd><m:mn>0.0722</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0.0193</m:mn></m:mtd><m:mtd><m:mn>0.1192</m:mn></m:mtd><m:mtd><m:mn>0.9505</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow></m:math>
</div></td>
<td class="border"><div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mi>γ</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mn>0.45</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>f</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mn>0.099</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>s</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mn>4.5</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>t</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mn>0.018</m:mn></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div></td>
</tr>
<tr>
<td class="border"><p class="tabtext">NTSC (1953)/ITU-R BT.601-4</p></td>
<td class="border"><div class="disp-formula">
<m:math alttext=""><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd columnalign="right"><m:mn>1.9100</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>1.3932</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>0.4758</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mo>−</m:mo><m:mn>0.9847</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>1.8760</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>0.0416</m:mn></m:mtd></m:mtr><m:mtr><m:mtd columnalign="right"><m:mn>0.0679</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>0.2289</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>1.0694</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow></m:math>
</div></td>
<td class="border"><div class="disp-formula">
<m:math alttext=""><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd columnalign="right"><m:mn>0.4306</m:mn></m:mtd><m:mtd><m:mn>0.3415</m:mn></m:mtd><m:mtd><m:mn>0.1783</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0.2220</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>0.7066</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>0.0713</m:mn></m:mtd></m:mtr><m:mtr><m:mtd columnalign="right"><m:mn>0.0202</m:mn></m:mtd><m:mtd><m:mn>0.1296</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>0.9391</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow></m:math>
</div></td>
<td class="border"><div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mi>γ</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mn>0.45</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>f</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mn>0.099</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>s</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mn>4.5</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>t</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mn>0.018</m:mn></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div></td>
</tr>
<tr>
<td class="border"><p class="tabtext">PAL/SECAM</p></td>
<td class="border"><div class="disp-formula">
<m:math alttext=""><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd columnalign="right"><m:mn>3.0629</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>1.3932</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>0.4758</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mo>−</m:mo><m:mn>0.9693</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>1.8760</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>0.0416</m:mn></m:mtd></m:mtr><m:mtr><m:mtd columnalign="right"><m:mn>0.0679</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>0.2289</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>1.0641</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow></m:math>
</div></td>
<td class="border"><div class="disp-formula">
<m:math alttext=""><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd columnalign="right"><m:mn>0.4306</m:mn></m:mtd><m:mtd><m:mn>0.3415</m:mn></m:mtd><m:mtd><m:mn>0.1783</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0.2220</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>0.7066</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>0.0713</m:mn></m:mtd></m:mtr><m:mtr><m:mtd columnalign="right"><m:mn>0.0202</m:mn></m:mtd><m:mtd><m:mn>0.1296</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>0.9391</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow></m:math>
</div></td>
<td class="border"><div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mi>γ</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mn>0.45</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>f</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mn>0.099</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>s</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mn>4.5</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>t</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mn>0.018</m:mn></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div></td>
</tr>
<tr>
<td class="border"><p class="tabtext">SMPTE-C</p></td>
<td class="border"><div class="disp-formula">
<m:math alttext=""><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd columnalign="right"><m:mn>3.5054</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>1.7395</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>0.5440</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mo>−</m:mo><m:mn>1.0691</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>1.9778</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>0.0352</m:mn></m:mtd></m:mtr><m:mtr><m:mtd columnalign="right"><m:mn>0.0563</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>0.1970</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>1.0502</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow></m:math>
</div></td>
<td class="border"><div class="disp-formula">
<m:math alttext=""><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd columnalign="right"><m:mn>0.3936</m:mn></m:mtd><m:mtd><m:mn>0.3652</m:mn></m:mtd><m:mtd><m:mn>0.1916</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0.2124</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>0.7010</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>0.0865</m:mn></m:mtd></m:mtr><m:mtr><m:mtd columnalign="right"><m:mn>0.0187</m:mn></m:mtd><m:mtd><m:mn>0.1119</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>0.9582</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow></m:math>
</div></td>
<td class="border"><div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mi>γ</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mn>0.45</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>f</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mn>0.099</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>s</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mn>4.5</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>t</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mn>0.018</m:mn></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div></td>
</tr>
<tr>
<td class="border"><p class="tabtext">SMPTE-240M</p></td>
<td class="border"><div class="disp-formula">
<m:math alttext=""><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd columnalign="right"><m:mn>2.042</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>0.565</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>0.345</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mo>−</m:mo><m:mn>0.894</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>1.815</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>0.032</m:mn></m:mtd></m:mtr><m:mtr><m:mtd columnalign="right"><m:mn>0.064</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>0.129</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>0.912</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow></m:math>
</div></td>
<td class="border"><div class="disp-formula">
<m:math alttext=""><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd columnalign="right"><m:mn>0.567</m:mn></m:mtd><m:mtd><m:mn>0.190</m:mn></m:mtd><m:mtd><m:mn>0.193</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0.279</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>0.643</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>0.077</m:mn></m:mtd></m:mtr><m:mtr><m:mtd columnalign="right"><m:mn>0.000</m:mn></m:mtd><m:mtd><m:mn>0.073</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>1.016</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow></m:math>
</div></td>
<td class="border"><div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mi>γ</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mn>0.45</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>f</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mn>0.1115</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>s</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mn>4.0</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>t</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mn>0.0228</m:mn></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div></td>
</tr>
<tr>
<td class="border"><p class="tabtext">Wide Gamut</p></td>
<td class="border"><div class="disp-formula">
<m:math alttext=""><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd columnalign="right"><m:mn>1.4625</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>0.1845</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>0.2734</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mo>−</m:mo><m:mn>0.5228</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>1.4479</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>0.0681</m:mn></m:mtd></m:mtr><m:mtr><m:mtd columnalign="right"><m:mn>0.0346</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>0.0958</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>1.2875</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow></m:math>
</div></td>
<td class="border"><div class="disp-formula">
<m:math alttext=""><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mn>0.7164</m:mn></m:mtd><m:mtd><m:mn>0.1010</m:mn></m:mtd><m:mtd><m:mn>0.1468</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0.2587</m:mn></m:mtd><m:mtd><m:mn>0.7247</m:mn></m:mtd><m:mtd><m:mn>0.0166</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0.0000</m:mn></m:mtd><m:mtd><m:mn>0.0512</m:mn></m:mtd><m:mtd><m:mn>0.7740</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow></m:math>
</div></td>
<td class="border"><div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mi>γ</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mtext>N.A.</m:mtext></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>f</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mtext>N.A.</m:mtext></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>s</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mtext>N.A.</m:mtext></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>t</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mtext>N.A.</m:mtext></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div></td>
</tr>
</tbody>
</table>
</section>
<section>
<h3 id="sec18_2_3"><a id="index_term162"/><span class="green">18.2.3 LMS Cone Space</span></h3>
<p>The aforementioned cone signals can be expressed in terms of the CIE XYZ color space. The matrix transform to compute <em>LM S</em> signals from <em>XY Z</em> and vice versa are given by</p>
<div class="disp-formula">
<m:math xmlns:mml="http://www.w3.org/1998/Math/MathML" alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mi>L</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>M</m:mi></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>S</m:mi></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mo>=</m:mo><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mn>0.38971</m:mn></m:mtd><m:mtd><m:mn>0.68898</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>0.07868</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mo>−</m:mo><m:mn>0.22981</m:mn></m:mtd><m:mtd><m:mn>1.18340</m:mn></m:mtd><m:mtd><m:mn>0.04641</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0.00000</m:mn></m:mtd><m:mtd><m:mn>0.00000</m:mn></m:mtd><m:mtd><m:mn>1.00000</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mi>X</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>Y</m:mi></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>Z</m:mi></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mo>;</m:mo></m:mtd></m:mtr><m:mtr><m:mtd columnalign="left"><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mi>X</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>Y</m:mi></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>Z</m:mi></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mo>=</m:mo><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mn>1.91019</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>1.11214</m:mn></m:mtd><m:mtd><m:mn>0.20195</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0.37095</m:mn></m:mtd><m:mtd><m:mn>0.62905</m:mn></m:mtd><m:mtd><m:mn>0.00000</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0.00000</m:mn></m:mtd><m:mtd><m:mn>0.00000</m:mn></m:mtd><m:mtd><m:mn>1.00000</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mi>L</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>M</m:mi></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>S</m:mi></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mn>.</m:mn></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p><a id="term-112"/><a id="term-123"/><a id="term-124"/><a id="term-134"/><a id="term-522"/><a id="term-717"/><span aria-label="518" epub:type="pagebreak" id="pg_518" role="doc-pagebreak"/>This transform is known as the Hunt-Pointer-Estevez transform (Hunt, 2004) and is used in chromatic adaptation transforms as well as in color appearance modeling.</p>
</section>
<section>
<h3 id="sec18_2_4"><span class="green">18.2.4 CIE 1976 <em>L* a* b*</em></span></h3>
<p>Color opponent spaces are characterized by a channel representing an achromatic channel (luminance), as well as two channels encoding color opponency. These are frequently red-green and yellow-blue channels. These color opponent channels <span aria-label="519" epub:type="pagebreak" id="pg_519" role="doc-pagebreak"/>thus encode two chromaticities along one axis, which can have both positive and negative values. For instance, a red-green channel encodes red for positive values and green for negative values. The value zero encodes a special case: neutral which is neither red or green. The yellow-blue channel works in much the same way.</p>
<p>As at least two colors are encoded on each of the two chromatic axes, it is not possible to encode a mixture of red and green. Neither is it possible to encode yellow and blue simultaneously. While this may seem a disadvantage, it is known that the human visual system computes similar attributes early in the visual pathway. As a result, humans are not able to perceive colors that are simultaneously red and green, or yellow and blue. We do not see anything resembling reddish-green, or yellowish-blue. We are, however, able to perceive mixtures of colors such as yellowish-red (orange) or greenish-blue, as these are encoded across the chromatic channels.</p>
<p>The most relevant color opponent system for computer graphics is the CIE 1976 <em>L</em>*<em>a</em>*<em>b</em>* color model. It is a perceptually more or less uniform color space, useful, among other things, for the computation of color differences. It is also known as <a id="index_term142"/>CIELAB.</p>
<p>The input to CIELAB are the stimulus (<em>X, Y, Z</em>) tristimulus values as well as the tristimulus values of a diffuse white reflecting surface that is lit by a known illuminant, (<em>X<sub>n</sub>,Y<sub>n</sub>,Z<sub>n</sub></em>). CIELAB therefore goes beyond being an ordinary color space, as it takes into account a patch of color in the context of a known illumination. It can thus be seen as a rudimentary color appearance space.</p>
<p>The three channels defined in CIELAB are <em>L</em>*, <em>a</em>*, and <em>b</em>*. The <em>L</em>* channel encodes the lightness of the color, i.e., the perceived reflectance of a patch with tristimulus value (<em>X, Y, Z</em>). The <em>a</em>* and <em>b</em>* are chromatic opponent channels. The transform between XYZ and CIELAB is given by</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mi>L</m:mi><m:mo>*</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>a</m:mi><m:mo>*</m:mo></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>b</m:mi><m:mo>*</m:mo></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mo>=</m:mo><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd columnalign="right"><m:mn>0</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>116</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>0</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>16</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>500</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>500</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>0</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>0</m:mn></m:mtd></m:mtr><m:mtr><m:mtd columnalign="right"><m:mn>0</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>200</m:mn></m:mtd><m:mtd><m:mo>−</m:mo><m:mn>200</m:mn></m:mtd><m:mtd columnalign="right"><m:mn>0</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mi>f</m:mi><m:mrow><m:mo>(</m:mo><m:mi>X</m:mi><m:mo>/</m:mo><m:msub><m:mrow><m:mi>X</m:mi></m:mrow><m:mrow><m:mi>n</m:mi></m:mrow></m:msub><m:mo>)</m:mo></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>f</m:mi><m:mrow><m:mo>(</m:mo><m:mi>Y</m:mi><m:mo>/</m:mo><m:msub><m:mrow><m:mi>Y</m:mi></m:mrow><m:mrow><m:mi>n</m:mi></m:mrow></m:msub><m:mo>)</m:mo></m:mrow></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>f</m:mi><m:mrow><m:mo>(</m:mo><m:mi>Z</m:mi><m:mo>/</m:mo><m:msub><m:mrow><m:mi>Z</m:mi></m:mrow><m:mrow><m:mi>n</m:mi></m:mrow></m:msub><m:mo>)</m:mo></m:mrow></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>1</m:mn></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mn>.</m:mn></m:mrow></m:math>
</div>
<p>The function <em>f</em> is defined as</p>
<div class="disp-formula">
<m:math xmlns:mml="http://www.w3.org/1998/Math/MathML" alttext=""><m:mrow><m:mi>f</m:mi><m:mrow><m:mo>(</m:mo><m:mi>r</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mo>{</m:mo><m:mtable><m:mtr><m:mtd columnalign="left"><m:mroot><m:mrow><m:mi>r</m:mi></m:mrow><m:mrow><m:mn>3</m:mn></m:mrow></m:mroot></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>7.787</m:mn><m:mi>r</m:mi><m:mo>+</m:mo><m:mfrac><m:mrow><m:mn>16</m:mn></m:mrow><m:mrow><m:mn>116</m:mn></m:mrow></m:mfrac></m:mtd></m:mtr></m:mtable><m:mo>⁢</m:mo><m:mtext>    </m:mtext><m:mtext> </m:mtext><m:mtext> </m:mtext><m:mtext> </m:mtext><m:mtable columnalign="left"><m:mtr><m:mtd><m:mtext>for </m:mtext><m:mtext> </m:mtext><m:mi>r</m:mi><m:mo>&gt;</m:mo><m:mn>0.008856</m:mn><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext>for  </m:mtext><m:mi>r</m:mi><m:mo>⁢</m:mo><m:mtext> </m:mtext><m:mo>≤</m:mo><m:mn>0.008856.</m:mn></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>As can be seen from this formulation, the chromatic channels do depend on the luminance <em>Y</em> . Although this is perceptually accurate, it means that we cannot plot the values of <em>a</em>* and <em>b</em>* in a chromaticity diagram. The lightness <em>L</em>* is normalized <a id="term-104"/><span aria-label="520" epub:type="pagebreak" id="pg_520" role="doc-pagebreak"/>between 0 and 100 for black and white. Although the <em>a</em>* and <em>b</em>* channels are not explicitly constrained, they are typically in the range [—128<em>,</em> 128].</p>
<p>As CIELAB is approximately perceptually linear, it is possible to take two colors, convert them to CIELAB, and then estimate the perceived color difference by computing the Euclidean distance between them. This leads to the following color difference formula:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mi mathvariant="normal">Δ</m:mi><m:msubsup><m:mrow><m:mi>E</m:mi></m:mrow><m:mrow><m:mtext>ab</m:mtext></m:mrow><m:mrow><m:mo>*</m:mo></m:mrow></m:msubsup><m:mo>=</m:mo><m:mrow><m:mo>[</m:mo><m:mrow><m:mo>(</m:mo><m:mi mathvariant="normal">Δ</m:mi><m:mi>L</m:mi><m:mo>*</m:mo><m:msup><m:mrow><m:mo>)</m:mo></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>+</m:mo><m:mrow><m:mo>(</m:mo><m:mi mathvariant="normal">Δ</m:mi><m:mi>a</m:mi><m:mo>*</m:mo><m:msup><m:mrow><m:mo>)</m:mo></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>+</m:mo><m:mrow><m:mo>(</m:mo><m:mi mathvariant="normal">Δ</m:mi><m:mi>b</m:mi><m:mo>*</m:mo><m:msup><m:mrow><m:mo>)</m:mo></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup></m:mrow></m:mrow></m:mrow><m:msup><m:mrow><m:mo>]</m:mo></m:mrow><m:mrow><m:mn>1</m:mn><m:mo>/</m:mo><m:mn>2</m:mn></m:mrow></m:msup></m:mrow><m:mn>.</m:mn></m:mrow></m:math>
</div>
<p>The letter <em>E</em> stands for difference in sensation (in German, Empfindung) (Judd, 1932).</p>
<p>Finally, the inverse transform between CIELAB and XYZ is given by</p>
<div class="disp-formula">
<m:math xmlns:mml="http://www.w3.org/1998/Math/MathML" alttext=""><m:mrow><m:mtable><m:mtr><m:mtd columnalign="left"><m:mi>X</m:mi><m:mo>=</m:mo><m:msub><m:mrow><m:mi>X</m:mi></m:mrow><m:mrow><m:mi>n</m:mi></m:mrow></m:msub><m:mo>{</m:mo><m:mtable><m:mtr><m:mtd><m:mo>(</m:mo><m:mfrac><m:mrow><m:mi>L</m:mi><m:mo>*</m:mo></m:mrow><m:mrow><m:mn>116</m:mn></m:mrow></m:mfrac><m:mo>+</m:mo><m:mfrac><m:mrow><m:mi>a</m:mi><m:mo>*</m:mo></m:mrow><m:mrow><m:mn>500</m:mn></m:mrow></m:mfrac><m:mo>+</m:mo><m:mfrac><m:mrow><m:mn>16</m:mn></m:mrow><m:mrow><m:mn>116</m:mn></m:mrow></m:mfrac><m:msup><m:mrow><m:mo>)</m:mo></m:mrow><m:mrow><m:mn>3</m:mn></m:mrow></m:msup></m:mtd></m:mtr><m:mtr><m:mtd><m:mfrac><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>7.787</m:mn></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mfrac><m:mrow><m:mi>L</m:mi><m:mo>*</m:mo></m:mrow><m:mrow><m:mn>116</m:mn></m:mrow></m:mfrac><m:mo>+</m:mo><m:mfrac><m:mrow><m:mi>a</m:mi><m:mo>*</m:mo></m:mrow><m:mrow><m:mn>500</m:mn></m:mrow></m:mfrac><m:mo>)</m:mo></m:mrow></m:mtd></m:mtr></m:mtable></m:mtd><m:mtd columnalign="left"><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mtext>if </m:mtext><m:mi>L</m:mi><m:mo>*</m:mo><m:mo>&gt;</m:mo><m:mn>7.9996</m:mn></m:mtd></m:mtr></m:mtable><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext>if </m:mtext><m:mi>L</m:mi><m:mo>*</m:mo><m:mo>≤</m:mo><m:mn>7.9996</m:mn><m:mo>,</m:mo></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd columnalign="left"><m:mi>Y</m:mi><m:mo>=</m:mo><m:msub><m:mrow><m:mi>Y</m:mi></m:mrow><m:mrow><m:mi>n</m:mi></m:mrow></m:msub><m:mo>{</m:mo><m:mtable><m:mtr><m:mtd><m:mo>(</m:mo><m:mfrac><m:mrow><m:mi>L</m:mi><m:mo>*</m:mo></m:mrow><m:mrow><m:mn>116</m:mn></m:mrow></m:mfrac><m:mo>+</m:mo><m:mfrac><m:mrow><m:mn>16</m:mn></m:mrow><m:mrow><m:mn>116</m:mn></m:mrow></m:mfrac><m:msup><m:mrow><m:mo>)</m:mo></m:mrow><m:mrow><m:mn>3</m:mn></m:mrow></m:msup></m:mtd></m:mtr><m:mtr><m:mtd><m:mfrac><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>7.787</m:mn></m:mrow></m:mfrac><m:mfrac><m:mrow><m:mi>L</m:mi><m:mo>*</m:mo></m:mrow><m:mrow><m:mn>116</m:mn></m:mrow></m:mfrac></m:mtd></m:mtr></m:mtable></m:mtd><m:mtd columnalign="left"><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mtext>i</m:mtext><m:mtext>f</m:mtext><m:mtext> </m:mtext><m:mi>L</m:mi><m:mo>*</m:mo><m:mo>&gt;</m:mo><m:mn>7.9996</m:mn><m:mo>,</m:mo></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext>if </m:mtext><m:mi>L</m:mi><m:mo>*</m:mo><m:mo>≤</m:mo><m:mn>7.9996</m:mn><m:mo>,</m:mo></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext> </m:mtext></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd columnalign="left"><m:mi>Z</m:mi><m:mo>=</m:mo><m:msub><m:mrow><m:mi>Z</m:mi></m:mrow><m:mrow><m:mi>n</m:mi></m:mrow></m:msub><m:mo>{</m:mo><m:mtable><m:mtr><m:mtd><m:mo>(</m:mo><m:mfrac><m:mrow><m:mi>L</m:mi><m:mo>*</m:mo></m:mrow><m:mrow><m:mn>116</m:mn></m:mrow></m:mfrac><m:mo>−</m:mo><m:mfrac><m:mrow><m:mi>b</m:mi><m:mo>*</m:mo></m:mrow><m:mrow><m:mn>200</m:mn></m:mrow></m:mfrac><m:mo>+</m:mo><m:mfrac><m:mrow><m:mn>16</m:mn></m:mrow><m:mrow><m:mn>116</m:mn></m:mrow></m:mfrac><m:msup><m:mrow><m:mo>)</m:mo></m:mrow><m:mrow><m:mn>3</m:mn></m:mrow></m:msup></m:mtd></m:mtr><m:mtr><m:mtd><m:mfrac><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>7.787</m:mn></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mfrac><m:mrow><m:mi>L</m:mi><m:mo>*</m:mo></m:mrow><m:mrow><m:mn>116</m:mn></m:mrow></m:mfrac><m:mo>−</m:mo><m:mfrac><m:mrow><m:mi>b</m:mi><m:mo>*</m:mo></m:mrow><m:mrow><m:mn>200</m:mn></m:mrow></m:mfrac><m:mo>)</m:mo></m:mrow></m:mtd></m:mtr></m:mtable></m:mtd><m:mtd columnalign="left"><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mtext>if </m:mtext><m:mi>L</m:mi><m:mo>*</m:mo><m:mo>&gt;</m:mo><m:mn>7.9996</m:mn><m:mo>,</m:mo></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext>if </m:mtext><m:mi>L</m:mi><m:mo>*</m:mo><m:mo>≤</m:mo><m:mn>7.9996.</m:mn></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
</section>
</section>
<section>
<h2 id="sec18_3"><a id="index_term1"/><a id="index_term152"/><a epub:type="backlink" href="C02a_toc.xhtml#rsec18_3" role="doc-backlink"><span class="green">18.3 Chromatic Adaptation</span></a></h2>
<p>The CIELAB color space just described takes as input both a tristimulus value of the stimulus and the tristimulus value of light reflected off a white diffuse patch. As such, it forms the beginnings of a system in which the viewing environment is taken into account.</p>
<p>The environment in which we observe objects and images has a large influence on how we perceive those objects. The range of viewing environments that we encounter in daily life is very large, from sunlight to starlight and from candlelight to fluorescent light. The lighting conditions not only constitute a very large range in the amount of light that is present, but also vary greatly in the color of the emitted light.</p>
<p><a id="term-1"/><a id="term-96"/><a id="term-105"/><span aria-label="521" epub:type="pagebreak" id="pg_521" role="doc-pagebreak"/>The human visual system accommodates these changes in the environment through a process called adaptation. Three different types of adaptation can be distinguished, namely light adaptation, dark adaptation, and chromatic adaptation. Light adaptation refers to the changes that occur when we move from a very dark to a very light environment. When this happens, at first we are dazzled by the light, but soon we adapt to the new situation and begin to distinguish objects in our environment. Dark adaptation refers to the opposite—when we go from a light environment to a dark environment. At first, we see very little, but after a given amount of time, details will start to emerge. The time needed to adapt to the dark is generally much longer than for light adaptation.</p>
<p>Chromatic adaptation refers to our ability to adapt, and largely ignore, variations in the color of the illumination. Chromatic adaptation is, in essence, the biological equivalent of the white balancing operation that is available on most modern cameras. The human visual system effectively normalizes the viewing conditions to present a visual experience that is fairly consistent. Thus, we exhibit a certain amount of color constancy: object reflectances appear relatively constant despite variations in illumination.</p>
<p>Although we are able to largely ignore changes in viewing environment, we are not able to do so completely. For instance, colors appear much more colorful on a sunny day than they do on a cloudy day. Although the appearances have changed, we do not assume that object reflectances themselves have actually changed their physical properties. We thus understand that the lighting conditions have influenced the overall color appearance.</p>
<p>Nonetheless, color constancy does apply to chromatic content. Chromatic adaptation allows white objects to appear white for a large number of lighting conditions, as shown in <a href="C23_chapter18.xhtml#f18_9">Figure 18.9</a>.</p>
<figure id="f18_9" tabindex="0">
<img alt="" src="../images/fig18_9.jpg"/>
<figcaption><p><span class="blue">Figure 18.9.</span> A series of light sources plotted in the CIE <em>u</em>' <em>v</em>' chromaticity diagram. A white piece of paper illuminated by any of these light sources maintains a white color appearance.</p></figcaption>
</figure>
<p><a id="term-2"/><a id="term-97"/><a id="term-106"/><span aria-label="522" epub:type="pagebreak" id="pg_522" role="doc-pagebreak"/>Computational models of chromatic adaptation tend to focus on the gain control mechanism in the cones. One of the simplest models assumes that each cone adapts independently to the energy that it absorbs. This means that different cone types adapt differently dependent on the spectrum of the light being absorbed. Such adaptation can then be modeled as an adaptive and independent rescaling of the cone signals:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi>L</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mi>α</m:mi><m:mtext> </m:mtext><m:mi>L</m:mi><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi>M</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mi>β</m:mi><m:mtext> </m:mtext><m:mi>M</m:mi><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi>S</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mi>γ</m:mi><m:mtext> </m:mtext><m:mi>S</m:mi><m:mo>,</m:mo></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>where (<em>L<sub>a</sub>,M<sub>a</sub>,S<sub>a</sub></em>) are the chromatically adapted cone signals, and <em>α</em>, <em>β</em>, and <em>γ</em> are the independent gain controls which are determined by the viewing environment. This type of independent adaptation is also known as von-Kries adaptation. An example is shown in <a href="C23_chapter18.xhtml#f18_10">Figure 18.10</a>.</p>
<figure id="f18_10" tabindex="0">
<img alt="" src="../images/fig18_10.jpg"/>
<figcaption><p><span class="blue">Figure 18.10.</span> An example of von Kries–style independent photoreceptor gain control. The relative cone responses (solid line) and the relative adapted cone responses to CIE illuminant A (dashed) are shown. The separate patch of color represents CIE illuminant A rendered into the sRGB color space.</p></figcaption>
</figure>
<p>The adapting illumination can be measured off a white surface in the scene. In the ideal case, this would be a Lambertian surface. In a digital image, the adapting illumination can also be approximated as the maximum tristimulus values of the scene. The light measured or computed in this manner is the adapting white, given by (<em>L<sub>w</sub>,M<sub>w</sub>,S<sub>w</sub></em>). Von Kries adaptation is then simply a scaling by the reciprocal <span aria-label="523" epub:type="pagebreak" id="pg_523" role="doc-pagebreak"/>of the adapting white, carried out in cone response space:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi>L</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi>M</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi>S</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mo>=</m:mo><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mfrac><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:msub><m:mrow><m:mi>L</m:mi></m:mrow><m:mrow><m:mi>w</m:mi></m:mrow></m:msub></m:mrow></m:mfrac></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mfrac><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:msub><m:mrow><m:mi>M</m:mi></m:mrow><m:mrow><m:mi>w</m:mi></m:mrow></m:msub></m:mrow></m:mfrac></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mfrac><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:msub><m:mrow><m:mi>S</m:mi></m:mrow><m:mrow><m:mi>w</m:mi></m:mrow></m:msub></m:mrow></m:mfrac></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mi>L</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>M</m:mi></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>S</m:mi></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mn>.</m:mn></m:mrow></m:math>
</div>
<p class="indent">In many cases, we are interested in what stimulus should be generated under one illumination to match a given color under a different illumination. For example, if we have a colored patch illuminated by daylight, we may ask ourselves what tristimulus values should be generated to create a matching color patch that will be illuminated by incandescent light.</p>
<p>We are thus interested in computing corresponding colors, which can be achieved by cascading two chromatic adaptation calculations. In essence, the previously mentioned von Kries transform divides out the adapting illuminant—in our example, the daylight illumination. If we subsequently multiply in the incandescent illuminant, we have computed a corresponding color. If the two illuminants are given by (<em>L<sub>w,</sub></em><sub>1</sub><em>,M<sub>w,</sub></em><sub>1</sub><em>,S<sub>w,</sub></em><sub>1</sub>) and (<em>L<sub>w,</sub></em><sub>2</sub><em>,M<sub>w,</sub></em><sub>2</sub><em>,S<sub>w,</sub></em><sub>2</sub>), the corresponding color (<em>L<sub>c</sub>,M<sub>c</sub>,S<sub>c</sub></em>) is given by</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi>L</m:mi></m:mrow><m:mrow><m:mi>a</m:mi><m:mi>c</m:mi></m:mrow></m:msub></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi>M</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi>S</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mo>=</m:mo><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi>L</m:mi></m:mrow><m:mrow><m:mi>w</m:mi><m:mo>,</m:mo><m:mn>2</m:mn></m:mrow></m:msub></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:msub><m:mrow><m:mi>M</m:mi></m:mrow><m:mrow><m:mi>w</m:mi><m:mo>,</m:mo><m:mn>2</m:mn></m:mrow></m:msub></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:msub><m:mrow><m:mi>S</m:mi></m:mrow><m:mrow><m:mi>w</m:mi><m:mo>,</m:mo><m:mn>2</m:mn></m:mrow></m:msub></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mfrac><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:msub><m:mrow><m:mi>L</m:mi></m:mrow><m:mrow><m:mi>w</m:mi><m:mo>,</m:mo><m:mn>1</m:mn></m:mrow></m:msub></m:mrow></m:mfrac></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mfrac><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:msub><m:mrow><m:mi>M</m:mi></m:mrow><m:mrow><m:mi>w</m:mi><m:mo>,</m:mo><m:mn>1</m:mn></m:mrow></m:msub></m:mrow></m:mfrac></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mn>0</m:mn></m:mtd><m:mtd><m:mfrac><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:msub><m:mrow><m:mi>S</m:mi></m:mrow><m:mrow><m:mi>w</m:mi><m:mo>,</m:mo><m:mn>1</m:mn></m:mrow></m:msub></m:mrow></m:mfrac></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mi>L</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>M</m:mi></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>S</m:mi></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mn>.</m:mn></m:mrow></m:math>
</div>
<p class="indent">There are several more complicated and, therefore, more accurate chromatic adaptation transform in existence (Reinhard et al., 2008). However, the simple von Kries model remains remarkably effective in modeling chromatic adaptation and can thus be used to achieve white balancing in digital images.</p>
<p>The importance of chromatic adaptation in the context of rendering, is that we have moved one step closer to taking into account the viewing environment of the observer, without having to correct for it by adjusting the scene and rerendering our imagery. Instead, we can model and render our scenes, and then, as an image postprocess, correct for the illumination of the viewing environment. To ensure that white balancing does not introduce artifacts, however, it is important to ensure that the image is rendered to a floating-point format. If rendered to traditional 8-bit image formats, the chromatic adaptation transform may amplify quantization errors.</p>
</section>
<section>
<h2 id="sec18_4"><span aria-label="524" epub:type="pagebreak" id="pg_524" role="doc-pagebreak"/><a epub:type="backlink" href="C02a_toc.xhtml#rsec18_4" role="doc-backlink"><span class="green">18.4 Color Appearance</span></a></h2>
<p>While colorimetry allows us to accurately specify and communicate color in a device-independent manner, and chromatic adaptation allows us to predict color matches across changes in illumination, these tools are still insufficient to describe what colors actually look like.</p>
<p>To predict the actual perception of an object, we need to know more information about the environment and take that information into account. The human visual system is constantly adapting to its environment, which means that the perception of color will be strongly influenced by such changes. Color appearance models take into account measurements of the stimulus itself, as well as the viewing environment. This means that the resulting description of color is independent of viewing condition.</p>
<p>The importance of color appearance modeling can be seen in the following example. Consider an image being displayed on an LCD screen. When making a print of the same image and viewing it in a different context, more often than not the image will look markedly different. Color appearance models can be used to predict the changes required to generate an accurate cross-media color reproduction (Fairchild, 2005).</p>
<p>Although color appearance modeling offers important tools for color reproduction, actual implementations tend to be relatively complicated and cumbersome in practical use. It can be anticipated that this situation may change over time. However, until then, we leave their description to more specialized textbooks (Fairchild, 2005).</p>
</section>
<section>
<h2 id="sec71"><span class="green">Notes</span></h2>
<p>Of all the books on color theory, Reinhard et al.’s work (<a id="index_term977"/>Reinhard et al., 2008) is most directly geared toward engineering disciplines, including computer graphics, computer vision, and image processing. Other general introductions to color theory are given by Berns (Berns, 2000) and Stone (Stone, 2003). Wyszecki and Stiles have produced a comprehensive volume of data and formulae, forming an indispensable reference work (Wyszecki &amp; Stiles, 2000). For color reproduction, we recommend Hunt’s book (Hunt, 2004). <a id="index_term189"/>Color <a id="index_term151"/>appearance models are comprehensively described in Fairchild’s book (Fairchild, 2005). For color issues related to video and HDTV Poynton’s book is essential (Poynton, 2003).</p>
</section>
</section>
</body>
</html>