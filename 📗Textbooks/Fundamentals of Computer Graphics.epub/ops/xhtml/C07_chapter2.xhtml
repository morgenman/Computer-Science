<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" xmlns:m="http://www.w3.org/1998/Math/MathML" xmlns:svg="http://www.w3.org/2000/svg" dir="ltr" lang="en" xml:lang="en">
<head>
<meta charset="UTF-8"/>
<title>2 Miscellaneous Math</title>
<link href="../styles/9781000426359.css" rel="stylesheet" type="text/css"/>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
jax: ["input/TeX","input/MathML","output/SVG"],
extensions: ["tex2jax.js","mml2jax.js","MathEvents.js"],
TeX: {
extensions: ["noErrors.js","noUndefined.js","autoload-all.js"]
},
MathMenu: {
showRenderer: false
},
menuSettings: {
zoom: "Click"
},
messageStyle: "none"
});
</script>
<script src="../mathjax/MathJax.js" type="text/javascript"/>
<meta content="urn:uuid:e0000000-0000-0000-0000-000006665500" name="Adept.expected.resource"/>
</head>
<body epub:type="bodymatter">
<section epub:type="chapter" role="doc-chapter">
<h1 class="chapz" id="c2"><a id="term-515"/><span aria-label="13" epub:type="pagebreak" id="pg_13" role="doc-pagebreak"/><a epub:type="backlink" href="C02a_toc.xhtml#rc2" role="doc-backlink"><span class="green"><span class="big1">2</span><br/>Miscellaneous Math</span></a></h1>
<p>Much of graphics is just translating math directly into code. The cleaner the math, the cleaner the resulting code; so much of this book concentrates on using just the right math for the job. This chapter reviews various tools from high school and college mathematics and is designed to be used more as a reference than as a tutorial. It may appear to be a hodge-podge of topics and indeed it is; each topic is chosen because it is a bit unusual in “standard” math curricula, because it is of central importance in graphics, or because it is not typically treated from a geometric standpoint. In addition to establishing a review of the notation used in this book, this chapter also emphasizes a few points that are sometimes skipped in the standard undergraduate curricula, such as barycentric coordinates on triangles. This chapter is not intended to be a rigorous treatment of the material; instead, intuition and geometric interpretation are emphasized. A discussion of linear algebra is deferred until <a href="C11_chapter6.xhtml#c6">Chapter 6</a> just before transformation matrices are discussed. Readers are encouraged to skim this chapter to familiarize themselves with the topics covered and to refer back to it as needed. The exercises at the end of this chapter may be useful in determining which topics need a refresher.</p>
<section>
<h2 id="sec2_1"><a id="index_term1031"/><a id="index_term707"/><a epub:type="backlink" href="C02a_toc.xhtml#rsec2_1" role="doc-backlink"><span class="green">2.1 Sets and Mappings</span></a></h2>
<p><em>Mappings</em>, also called <em>functions</em>, are basic to mathematics and programming. Like a function in a program, a mapping in math takes an argument of one <em>type</em> and <a id="term-275"/><a id="term-409"/><a id="term-478"/><a id="term-643"/><a id="term-665"/><a id="term-844"/><span aria-label="14" epub:type="pagebreak" id="pg_14" role="doc-pagebreak"/>maps it to (returns) an object of a particular type. In a program, we say “type”; in math, we would identify the set. When we have an object that is a member of a set, we use the ∈ symbol. For example,</p>
<p class="center"><em>a</em> ∈ <strong>S</strong>,</p>
<p class="noindent">can be read “<em>a</em> is a member of set <strong>S</strong>.” Given any two sets <strong>A</strong> and <strong>B</strong>, we can create a third set by taking the <em>Cartesian product</em> of the two sets, denoted <strong>A</strong> × <strong>B</strong>. This set <strong>A</strong> × <strong>B</strong> is composed of all possible ordered pairs (<em>a, b</em>) where <em>a</em> ∈ <strong>A</strong> and <em>b</em> ∈ <strong>B</strong>. As a shorthand, we use the notation <strong>A</strong><sup>2</sup> to denote <strong>A</strong> × <strong>A</strong>. We can extend the <a id="index_term127"/>Cartesian product to create a set of all possible ordered triples from three sets and so on for arbitrarily long ordered tuples from arbitrarily many sets.</p>
<p>Common sets of interest include</p>
<ul class="list-bullet">
<li>
<p class="list"><span class="green">ℝ</span>—the real numbers;</p>
</li>
<li>
<p class="list"><span class="green">ℝ</span> <sup>+</sup>—the nonnegative real numbers (includes zero);</p>
</li>
<li>
<p class="list"><span class="green">ℝ</span> <sup>2</sup>—the ordered pairs in the real 2D plane;</p>
</li>
<li>
<p class="list"><span class="green">ℝ</span> <sup><em>n</em></sup>—the points in <em>n</em>-dimensional Cartesian space;</p>
</li>
<li>
<p class="list"><strong><span class="green">Z</span></strong>—the integers;</p>
</li>
<li>
<p class="list"><em>S</em><sup>2</sup>—the set of 3D points (points in ℝ<sup>3</sup>) on the unit sphere.</p>
</li>
</ul>
<p>Note that although <em>S</em><sup>2</sup> is composed of points embedded in three-dimensional space, it is on a surface that can be parameterized with two variables, so it can be thought of as a 2D set. Notation for mappings uses the arrow and a colon, for example,</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mi>f</m:mi><m:mo>:</m:mo><m:mtext> </m:mtext><m:mtext>&gt;ℝ</m:mtext><m:mstyle><m:mrow><m:mo>↔</m:mo><m:mtext>Z,</m:mtext></m:mrow></m:mstyle></m:mrow></m:math>
</div>
<p>which you can read as “There is a function called <em>f</em> that takes a real number as input and maps it to an integer.” Here, the set that comes before the arrow is called the <em>domain</em> of the function, and the set on the right-hand side is called the <em>target</em>. Computer programmers might be more comfortable with the following equivalent language: “There is a function called <em>f</em> which has one real argument and returns an integer.” In other words, the set notation above is equivalent to the common programming notation:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mtext>integer</m:mtext><m:mi>f</m:mi><m:mrow><m:mo>(</m:mo><m:mtext>real</m:mtext><m:mo>)</m:mo></m:mrow></m:mtd><m:mtd><m:mo>←</m:mo><m:mtext>equivalent</m:mtext><m:mo>→</m:mo></m:mtd></m:mtr></m:mtable></m:mtd><m:mtd><m:mi>f</m:mi><m:mo>:</m:mo><m:mtext>&gt;ℝ</m:mtext><m:mo>↔</m:mo><m:mtext>Z.</m:mtext></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>So the colon-arrow notation can be thought of as a programming <a id="index_term1149"/>syntax. It’s that simple.</p>
<p>The point <em>f</em> (<em>a</em>) is called the <em>image</em> of <em>a</em>, and the image of a set <em>A</em> (a subset of the domain) is the subset of the target that contains the images of all points in <em>A</em>. The image of the whole domain is called the <em>range</em> of the function.</p>
<section>
<h3 id="sec2_1_1"><a id="index_term637"/><a id="term-475"/><a id="term-479"/><span aria-label="15" epub:type="pagebreak" id="pg_15" role="doc-pagebreak"/><span class="green">2.1.1 Inverse Mappings</span></h3>
<p>If we have a function <em>f</em> : <strong>A</strong> ⟼ <strong>B</strong>, there may exist an <em>inverse function</em> <em>f</em><sup>–1</sup>: <strong>B ⟼ A</strong>, which is defined by the rule <em>f<sup>–1</sup></em>(<em>b</em>) = <em>a</em> where <em>b</em> = <em>f</em> (<em>a</em>) . This definition only works if every <em>b</em> ∈ <strong>B</strong> is an image of some point under <em>f</em> (i.e., the range equals the target) and if there is only one such point (i.e., there is only one <em>a</em> for which <em>f</em> (<em>a</em>) = <em>b</em>). Such mappings or functions are called <em>bijections</em>. A bijection maps every <em>a</em> ∈ <strong>A</strong> to a unique <em>b</em> ∈ <strong>B</strong>, and for every <em>b</em> ∈ <strong>B</strong>, there is exactly one <em>a</em> ∈ <strong>A</strong> such that <em>f</em> (<em>a</em>) = <em>b</em> (<a href="C07_chapter2.xhtml#f2_1">Figure 2.1</a>). A bijection between a group of riders and horses indicates that everybody rides a single horse, and every horse is ridden. The two functions would be <em>rider (horse)</em> and <em>horse (rider)</em>. These are inverse functions of each other. Functions that are not bijections have no inverse (<a href="C07_chapter2.xhtml#f2_2">Figure 2.2</a>).</p>
<p>An example of a bijection is <em>f</em> : ℝ ⟼ ℝ, with <em>f</em> (<em>x</em>) = <em>x</em><sup>3</sup>. The inverse is <span class="inline-formula"><m:math alttext=""><m:mrow><m:msup><m:mrow><m:mi>f</m:mi></m:mrow><m:mrow><m:mo>−</m:mo><m:mn>1</m:mn></m:mrow></m:msup><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mmultiscripts><m:mrow><m:msqrt><m:mrow><m:mi>x</m:mi></m:mrow></m:msqrt></m:mrow><m:mprescripts/><m:none/><m:mrow><m:mn>3</m:mn></m:mrow></m:mmultiscripts></m:mrow></m:mrow></m:math></span>. This example shows that the standard notation can be somewhat awkward because <em>x</em> is used as a dummy variable in both <em>f</em> and <em>f</em><sup>–1</sup>. It is sometimes more intuitive to use different dummy variables, with <em>y</em> = <em>f</em> (<em>x</em>) and <em>x</em> = <em>f</em><sup>–1</sup>(<em>y</em>) . This yields the more intuitive <em>y</em> = <em>x</em><sup>3</sup> and <span class="inline-formula"><m:math alttext=""><m:mrow><m:mi>x</m:mi><m:mo>=</m:mo><m:mmultiscripts><m:mrow><m:msqrt><m:mrow><m:mi>y</m:mi></m:mrow></m:msqrt></m:mrow><m:mprescripts/><m:none/><m:mrow><m:mn>3</m:mn></m:mrow></m:mmultiscripts></m:mrow></m:math></span>. An example of a function that does not have an inverse is <em>sqr</em> : ℝ ⟼ ℝ, where <em>sqr</em>(<em>x</em>) = <em>x</em><sup>2</sup>. This is true for two reasons: first <em>x</em><sup>2</sup> = (–<em>x</em>)<sup>2</sup>, and second no members of the domain map to the negative portions of the target. Note that we can define an inverse if we restrict the domain and range to R<sup>+</sup>. Then, <span class="inline-formula"><m:math alttext=""><m:mrow><m:msqrt><m:mrow><m:mi>x</m:mi></m:mrow></m:msqrt></m:mrow></m:math></span> is a valid inverse.</p>
</section>
<section>
<h3 id="sec2_1_2"><a id="index_term635"/><span class="green">2.1.2 Intervals</span></h3>
<p>Often, we would like to specify that a function deals with real numbers that are restricted in value. One such constraint is to specify an <em>interval</em>. An example of an interval is the real numbers between zero and one, not including zero or one. We denote this (0, 1) . Because it does not include its endpoints, this is referred to as an <em>open interval</em>. The corresponding <em>closed interval</em>, which does contain its endpoints, is denoted with square brackets: [0, 1]. This notation can be mixed; i.e., [0, 1) includes zero but not one. When writing an interval [<em>a, b</em>], we assume that <em>a</em> ≤ <em>b</em>. The three common ways to represent an interval are shown in <a href="C07_chapter2.xhtml#f2_3">Figure 2.3</a>. The Cartesian products of intervals are often used. For example, to indicate that a point <strong>x</strong> is in the unit cube in 3D, we say <strong>x</strong> ∈ [0, 1]<sup>3</sup>.</p>
<figure id="f2_1" tabindex="0">
<img alt="" src="../images/fig2_1.jpg"/>
<figcaption><p><span class="blue">Figure 2.1.</span> A bijection f and the inverse function <em>f</em><sup>-1</sup>. Note that <em>f</em><sup>-1</sup> is also a bijection.</p></figcaption>
</figure>
<figure id="f2_2" tabindex="0">
<img alt="" src="../images/fig2_2.jpg"/>
<figcaption><p><span class="blue">Figure 2.2.</span> The function <em>g</em> does not have an inverse because two elements of <strong>d</strong> map to the same element of <strong>E</strong>. The function <em>h</em> has no inverse because element <em>T</em> of <strong>F</strong> has no element of <strong>d</strong> mapped to it.</p></figcaption>
</figure>
<figure id="f2_3" tabindex="0">
<img alt="" src="../images/fig2_3.jpg"/>
<figcaption><p><span class="blue">Figure 2.3.</span> Three equivalent ways to denote the interval from <em>a</em> to <em>b</em> that includes <em>b</em> but not <em>a</em>.</p></figcaption>
</figure>
<p>Intervals are particularly useful in conjunction with <a id="index_term1030"/>set operations: <em><a id="index_term634"/>intersection</em>, <em><a id="index_term1301"/>union</em>, and <em><a id="index_term321"/>difference</em>. For example, the intersection of two intervals is the set of points they have in common. The symbol ∩ is used for intersection. For example, [3, 5)∩[4, 6] = [4, 5) . For unions, the symbol <em>∪</em> is used to denote points in either interval. For example, [3, 5) <em>∪</em> [4, 6] = [3, 6]. Unlike the first two operators, the difference operator produces different results depending on argument order. <a id="term-476"/><span aria-label="16" epub:type="pagebreak" id="pg_16" role="doc-pagebreak"/>The minus sign is used for the difference operator, which returns the points in the left interval that are not also in the right. For example, [3, 5) <em>–</em> [4, 6] = [3, 4) and [4, 6] <em>–</em> [3, 5) = [5, 6]. These operations are particularly easy to visualize using interval diagrams (<a href="C07_chapter2.xhtml#f2_4">Figure 2.4</a>).</p>
</section>
<section>
<h3 id="sec2_1_3"><span class="green">2.1.3 Logarithms</span></h3>
<p>Although not as prevalent today as they were before calculators, <em>logarithms</em> are often useful in problems where equations with exponential terms arise. By definition, every logarithm has a <em>base</em> <em>a</em>. The “log base <em>a</em>”of <em>x</em> is written<em><sub>a</sub></em> <em>x</em> and is defined as “the exponent to which <em>a</em> must be raised to get <em>x</em>,” i.e.,</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:msub><m:mrow/><m:mrow/></m:msub><m:msup><m:mrow/><m:mrow/></m:msup><m:msub><m:mrow/><m:mrow/></m:msub><m:msup><m:mrow/><m:mrow/></m:msup><m:mi>y</m:mi><m:mo>=</m:mo><m:msub><m:mrow><m:mtext>log</m:mtext></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mi>x</m:mi><m:msup><m:mrow/><m:mrow/></m:msup></m:mtd><m:mtd><m:mo>⇔</m:mo></m:mtd></m:mtr></m:mtable><m:msup><m:mrow><m:mi>a</m:mi></m:mrow><m:mrow><m:mi>y</m:mi></m:mrow></m:msup><m:mo>=</m:mo><m:mi>x</m:mi><m:mn>.</m:mn></m:mrow></m:math>
</div>
<figure id="f2_4" tabindex="0">
<img alt="" src="../images/fig2_4.jpg"/>
<figcaption><p><span class="blue">Figure 2.4.</span> Interval operations on [3,5) and [4,6].</p></figcaption>
</figure>
<p class="noindent">Note that the logarithm base <em>a</em> and the function that raises <em>a</em> to a power are inverses of each other. This basic definition has several consequences:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable columnalign="left"><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd columnalign="left"><m:mtable><m:mtr><m:mtd><m:msup><m:mrow><m:mi>a</m:mi></m:mrow><m:mrow><m:msub><m:mrow><m:mtext>log</m:mtext></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mo>=</m:mo><m:mi>x</m:mi><m:mo>;</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mtext>log</m:mtext></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:msup><m:mrow><m:mi>a</m:mi></m:mrow><m:mrow><m:mi>x</m:mi></m:mrow></m:msup><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>x</m:mi></m:mrow></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mtext>log</m:mtext></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mi>y</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:msub><m:mrow><m:mtext>log</m:mtext></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mi>x</m:mi><m:mo>+</m:mo><m:msub><m:mrow><m:mtext>log</m:mtext></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mi>y</m:mi><m:mo>;</m:mo></m:mrow></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mtext>log</m:mtext></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>/</m:mo><m:mi>y</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:msub><m:mrow><m:mtext>log</m:mtext></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mi>x</m:mi><m:mo>−</m:mo><m:msub><m:mrow><m:mtext>log</m:mtext></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mi>y</m:mi><m:mo>;</m:mo></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mtext>log</m:mtext></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mi>x</m:mi><m:mo>=</m:mo><m:msub><m:mrow><m:mtext>log</m:mtext></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mi>b</m:mi><m:msub><m:mrow><m:mtext>log</m:mtext></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mi>x</m:mi><m:mn>.</m:mn></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>When we apply calculus to logarithms, the special number <em>e</em> = 2.718... often turns up. The logarithm with base <em>e</em> is called the <em>natural logarithm</em>. We adopt the common shorthand ln to denote it:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext>In</m:mtext><m:mi>x</m:mi><m:mo>≡</m:mo><m:msub><m:mrow><m:mtext>log</m:mtext></m:mrow><m:mrow><m:mi>e</m:mi></m:mrow></m:msub><m:mi>x</m:mi><m:mn>.</m:mn></m:mrow></m:math>
</div>
<p>Note that the “<em>≡</em>” symbol can be read “is equivalent by definition.” Like <em>π</em>, the special number <em>e</em> arises in a remarkable number of contexts. Many fields use a particular base in addition to <em>e</em> for manipulations and omit the base in their notation, i.e., log <em>x</em>. For example, astronomers often use base 10 and theoretical computer scientists often use base 2. Because computer graphics borrows technology from many fields, we will avoid this shorthand.</p>
<p>The derivatives of logarithms and exponents illuminate why the natural <a id="index_term703"/>logarithm is “natural”:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mfrac><m:mrow><m:mi>d</m:mi></m:mrow><m:mrow><m:mi>d</m:mi><m:mi>x</m:mi></m:mrow></m:mfrac><m:msub><m:mrow><m:mtext>log</m:mtext></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mi>x</m:mi><m:mo>=</m:mo><m:mfrac><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mi>x</m:mi><m:mtext>In</m:mtext><m:mi>a</m:mi></m:mrow></m:mfrac><m:mo>;</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mfrac><m:mrow><m:mi>d</m:mi></m:mrow><m:mrow><m:mi>d</m:mi><m:mi>x</m:mi></m:mrow></m:mfrac><m:msup><m:mrow><m:mi>a</m:mi></m:mrow><m:mrow><m:mi>x</m:mi></m:mrow></m:msup><m:mo>=</m:mo><m:msup><m:mrow><m:mi>a</m:mi></m:mrow><m:mrow><m:mi>x</m:mi></m:mrow></m:msup><m:mtext>In</m:mtext><m:mi>a</m:mi><m:mn>.</m:mn></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>The constant multipliers above are unity only for <em>a</em> = <em>e</em>.</p>
</section>
</section>
<section>
<h2 id="sec2_2"><a id="term-654"/><span aria-label="17" epub:type="pagebreak" id="pg_17" role="doc-pagebreak"/><a epub:type="backlink" href="C02a_toc.xhtml#rsec2_2" role="doc-backlink"><span class="green">2.2 Solving Quadratic Equations</span></a></h2>
<p>A <em>quadratic equation</em> has the form</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:msup><m:mrow><m:mi>A</m:mi><m:mi>x</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>+</m:mo><m:mi>B</m:mi><m:mi>x</m:mi><m:mo>+</m:mo><m:mi>C</m:mi><m:mo>=</m:mo><m:mn>0</m:mn><m:mo>,</m:mo></m:mrow></m:math>
</div>
<p>where <em>x</em> is a real unknown, and <em>A</em>, <em>B</em>,and <em>C</em> are known constants. If you think of a2D <em>xy</em> plot with <em>y</em> = <em>Ax</em><sup>2</sup> + <em>Bx</em> + <em>C</em>, the solution is just whatever <em>x</em> values are “zero crossings” in <em>y</em>. Because <em>y</em> = <em>Ax</em><sup>2</sup> + <em>Bx</em> + <em>C</em> is a parabola, there will be zero, one, or two real solutions depending on whether the parabola misses, grazes, or hits the <em>x</em>-axis (<a href="C07_chapter2.xhtml#f2_5">Figure 2.5</a>).</p>
<p>To solve the quadratic equation analytically, we first divide by <em>A</em>:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:msup><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>+</m:mo><m:mfrac><m:mrow><m:mi>B</m:mi></m:mrow><m:mrow><m:mi>A</m:mi></m:mrow></m:mfrac><m:mi>x</m:mi><m:mo>+</m:mo><m:mfrac><m:mrow><m:mi>C</m:mi></m:mrow><m:mrow><m:mi>A</m:mi></m:mrow></m:mfrac><m:mo>=</m:mo><m:mn>0.</m:mn></m:mrow></m:math>
</div>
<p>Then, we “complete the square” to group terms:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:msup><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>+</m:mo><m:mfrac><m:mrow><m:mi>B</m:mi></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>A</m:mi></m:mrow></m:mfrac><m:mo>)</m:mo></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>−</m:mo><m:mfrac><m:mrow><m:msup><m:mrow><m:mi>B</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup></m:mrow><m:mrow><m:msup><m:mrow><m:mn>4</m:mn><m:mi>A</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup></m:mrow></m:mfrac><m:mo>+</m:mo><m:mfrac><m:mrow><m:mi>C</m:mi></m:mrow><m:mrow><m:mi>A</m:mi></m:mrow></m:mfrac><m:mo>=</m:mo><m:mn>0.</m:mn></m:mrow></m:math>
</div>
<p>Moving the constant portion to the right-hand side and taking the square root give</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mi>x</m:mi><m:mo>+</m:mo><m:mfrac><m:mrow><m:mi>B</m:mi></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>A</m:mi></m:mrow></m:mfrac><m:mo>=</m:mo><m:mo>±</m:mo><m:msqrt><m:mrow><m:mfrac><m:mrow><m:msup><m:mrow><m:mi>B</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup></m:mrow><m:mrow><m:msup><m:mrow><m:mn>4</m:mn><m:mi>A</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup></m:mrow></m:mfrac><m:mo>−</m:mo><m:mfrac><m:mrow><m:mi>C</m:mi></m:mrow><m:mrow><m:mi>A</m:mi></m:mrow></m:mfrac></m:mrow></m:msqrt><m:mn>.</m:mn></m:mrow></m:math>
</div>
<p>Subtracting <em>B/</em>(2<em>A</em>) from both sides and grouping terms with the denominator 2<em>A</em> gives the familiar form:<a epub:type="noteref" href="C07_chapter2.xhtml#fn2_1" id="rfn2_1" role="doc-noteref"><sup>1</sup></a></p>
<div class="disp-formula" id="equ2_1">
<m:math alttext=""><m:mrow><m:mi>x</m:mi><m:mo>=</m:mo><m:mfrac><m:mrow><m:mo>−</m:mo><m:mi>B</m:mi><m:mo>±</m:mo><m:msqrt><m:mrow><m:msup><m:mrow><m:mi>B</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>−</m:mo><m:mn>4</m:mn><m:mi>A</m:mi><m:mi>C</m:mi></m:mrow></m:msqrt></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>A</m:mi></m:mrow></m:mfrac></m:mrow><m:mspace width="3em"/><m:mo>(2.1)</m:mo></m:math>
</div>
<p>Here, the “±” symbol means there are two solutions, one with a plus sign and one with a minus sign. Thus, 3 ± 1 equals “two or four.” Note that the term that determines the number of real solutions is</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mi>D</m:mi><m:mo>≡</m:mo><m:msup><m:mrow><m:mi>B</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>−</m:mo><m:mn>4</m:mn><m:mi>A</m:mi><m:mi>C</m:mi><m:mo>,</m:mo></m:mrow></m:math>
</div>
<p>which is called the <em>discriminant</em> of the quadratic equation. If <em>D &gt;</em> 0, there are two real solutions (also called <em>roots</em>). If <em>D</em> = 0, there is one real solution (a “double” root). If <em>D &lt;</em> 0, there are no real solutions.</p>
<p>For example, the roots of 2<em>x</em><sup>2</sup> +6<em>x</em> +4 = 0 are <em>x</em> = <em>–</em>1 and <em>x</em> = <em>–</em>2, and the equation <em>x</em><sup>2</sup> + <em>x</em>+1 has no real solutions. The discriminants of these equations are <em>D</em> = 4 and <em>D</em> = <em>–</em>3, respectively, so we expect the number of solutions given. In programs, it is usually a good idea to evaluate <em>D</em> first and return “no roots” without taking the square root if <em>D</em> is negative.</p>
<figure id="f2_5" tabindex="0">
<img alt="" src="../images/fig2_5.jpg"/>
<figcaption><p><span class="blue">Figure 2.5.</span> The geometric interpretation of the roots of a <a id="index_term916"/>quadratic equation is the intersection points of a parabola with the <em>x</em>-axis.</p></figcaption>
</figure>
<aside class="footnote" epub:type="footnote" role="doc-footnote"><p><a href="#rfn2_1" id="fn2_1"><sup>1</sup></a> A robust implementation will use the equivalent expression <span class="inline-formula"><m:math alttext=""><m:mrow><m:mn>2</m:mn><m:mi>C</m:mi><m:mo>/</m:mo><m:mrow><m:mo>(</m:mo><m:mo>−</m:mo><m:mi>B</m:mi><m:mo>±</m:mo><m:msqrt><m:mrow><m:msup><m:mrow><m:mi>B</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>−</m:mo><m:mn>4</m:mn><m:mi>A</m:mi><m:mi>C</m:mi></m:mrow></m:msqrt><m:mo>)</m:mo></m:mrow></m:mrow></m:math></span> to compute one of the roots, depending on the sign of B (Exercise 7).</p></aside>
</section>
<section>
<h2 id="sec2_3"><a id="term-26"/><a id="term-653"/><span aria-label="18" epub:type="pagebreak" id="pg_18" role="doc-pagebreak"/><a epub:type="backlink" href="C02a_toc.xhtml#rsec2_3" role="doc-backlink"><span class="green">2.3 Trigonometry</span></a></h2>
<p>In graphics, we use basic trigonometry in many contexts. Usually, it is nothing too fancy, and it often helps to remember the basic definitions.</p>
<section>
<h3 id="sec2_3_1"><span class="green">2.3.1 Angles</span></h3>
<p>Although we take angles somewhat for granted, we should return to their definition so we can extend the idea of the angle onto the sphere. An angle is formed between two half-lines (infinite rays stemming from an origin) or directions, and some convention must be used to decide between the two possibilities for the angle created between them as shown in <a href="C07_chapter2.xhtml#f2_6">Figure 2.6</a>. An <em>angle</em> is defined by the length of the arc segment it cuts out on the unit circle. A common convention is that the smaller arc length is used, and the sign of the angle is determined by the order in which the two half-lines are specified. Using that convention, all angles are in the range [–π, π].</p>
<figure id="f2_6" tabindex="0">
<img alt="" src="../images/fig2_6.jpg"/>
<figcaption><p><span class="blue">Figure 2.6.</span> Two halflines cut the unit circle into two arcs. The length of either arc is a valid angle “between” the two half-lines. Either we can use the convention that the smaller length is the angle, or that the two halflines are specified in a certain order and the arc that determines angle ϕ is the one swept out counterclockwise from the first to the second half-line.</p></figcaption>
</figure>
<p>Each of these angles is <em>the length of the arc of the unit circle that is “cut” by the two directions</em>. Because the perimeter of the unit circle is 2<em>π</em>, the two possible angles sum to 2<em>π</em>. The unit of these <a id="index_term57"/>arc lengths is <em>radians</em>. Another common unit is degrees, where the perimeter of the <a id="index_term144"/>circle is 360°. Thus, an angle that is <em>π</em> radians is 180°, usually denoted 180°. The conversion between degrees and <a id="index_term923"/>radians is</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mtext>Degrees</m:mtext><m:mo>=</m:mo><m:mfrac><m:mrow><m:mn>180</m:mn></m:mrow><m:mrow><m:mi>π</m:mi></m:mrow></m:mfrac><m:mtext>radians;</m:mtext></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext>Radins</m:mtext><m:mo>=</m:mo><m:mfrac><m:mrow><m:mi>π</m:mi></m:mrow><m:mrow><m:mn>180</m:mn></m:mrow></m:mfrac><m:mtext>degrees</m:mtext><m:mn>.</m:mn></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
</section>
<section>
<h3 id="sec2_3_2"><a id="index_term1285"/><span class="green">2.3.2 Trigonometric Functions</span></h3>
<figure id="f2_7" tabindex="0">
<img alt="" src="../images/fig2_7.jpg"/>
<figcaption><p><span class="blue">Figure 2.7.</span> A geometric demonstration of the <a id="index_term915"/>Pythagorean theorem.</p></figcaption>
</figure>
<p class="noindent">Given a right triangle with sides of length <em>a</em>, <em>o</em>, and <em>h</em>, where <em>h</em> is the length of the longest side (which is always opposite the right angle), or <em><a id="index_term535"/>hypotenuse</em>, an important relation is described by the <em>Pythagorean theorem</em>:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:msup><m:mrow><m:msup><m:mrow><m:msup><m:mrow><m:mi>a</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>+</m:mo><m:mi>o</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>=</m:mo><m:mi>h</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mn>.</m:mn></m:mrow></m:math>
</div>
<p>You can see that this is true from <a href="C07_chapter2.xhtml#f2_7">Figure 2.7</a>, where the big square has area (<em>a</em>+<em>o</em>)<sup>2</sup>, the four triangles have the combined area 2<em>ao</em>, and the center square has area <em>h</em><sup>2</sup>.</p>
<p>Because the tri<a id="index_term26"/>angles and inner square subdivide the larger square evenly, we have 2<em>ao</em> + <em>h</em><sup>2</sup> = (<em>a</em> + <em>o</em>)<sup>2</sup>, which is easily manipulated to the form above.</p>
<p><a id="term-631"/><span aria-label="19" epub:type="pagebreak" id="pg_19" role="doc-pagebreak"/>We define <em><a id="index_term1085"/>sine</em> and <em><a id="index_term268"/>cosine</em> of ϕ, as well as the other ratio-based trigonometric expressions:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mtext> sin </m:mtext><m:mi>ϕ</m:mi><m:mo>≡</m:mo><m:mi>o</m:mi><m:mo>/</m:mo><m:mi>h</m:mi><m:mo>;</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext> csc </m:mtext><m:mi>ϕ</m:mi><m:mo>≡</m:mo><m:mi>h</m:mi><m:mo>/</m:mo><m:mi>o</m:mi><m:mo>;</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext> cos </m:mtext><m:mi>ϕ</m:mi><m:mo>≡</m:mo><m:mi>a</m:mi><m:mo>/</m:mo><m:mi>h</m:mi><m:mo>;</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext> sec </m:mtext><m:mi>ϕ</m:mi><m:mo>≡</m:mo><m:mi>h</m:mi><m:mo>/</m:mo><m:mi>a</m:mi><m:mo>;</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext> tan </m:mtext><m:mi>ϕ</m:mi><m:mo>≡</m:mo><m:mi>o</m:mi><m:mo>/</m:mo><m:mi>a</m:mi><m:mo>;</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext> cot </m:mtext><m:mi>ϕ</m:mi><m:mo>≡</m:mo><m:mi>a</m:mi><m:mo>/</m:mo><m:mi>o</m:mi><m:mn>.</m:mn></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p class="indent">These definitions allow us to set up <em>polar coordinates</em>, where a point is coded as a distance from the origin and a signed angle relative to the positive <em>x</em>-axis (<a href="C07_chapter2.xhtml#f2_8">Figure 2.8</a>). Note the convention that angles are in the range ϕ ∈ (–π, <em>π</em>], and that the positive angles are counterclockwise from the positive <em>x</em>-axis. This convention that counterclockwise maps to positive numbers is arbitrary, but it is used in many contexts in graphics so it is worth committing to memory.</p>
<figure id="f2_8" tabindex="0">
<img alt="" src="../images/fig2_8.jpg"/>
<figcaption><p><span class="blue">Figure 2.8.</span> Polar coordinates for the point <span class="inline-formula"><m:math alttext=""><m:mrow><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mo>,</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mo>)</m:mo><m:mo>=</m:mo><m:mrow><m:mo>(</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:msqrt><m:mrow><m:mn>3</m:mn></m:mrow></m:msqrt><m:mo>)</m:mo></m:mrow></m:mrow></m:mrow></m:math></span> is (<em>r<sub>a</sub></em>, ϕ<sub><em>a</em></sub>) = (2, π/3).</p></figcaption>
</figure>
<p>Trigonometric functions are periodic and can take any angle as an argument. For example, sin(<em>A</em>) = sin(<em>A</em> +2<em>π</em>) . This means the functions are not invertible when considered with the domain R. This problem is avoided by restricting the range of standard inverse functions, and this is done in a standard way in almost all modern math libraries (e.g., Plauger (1991)). The domains and ranges are</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable columnalign="left"><m:mtr><m:mtd><m:mtext>asin:</m:mtext><m:mrow><m:mo>[</m:mo><m:mo>−</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mn>1</m:mn><m:mo>]</m:mo><m:mo>→</m:mo><m:mrow><m:mo>[</m:mo><m:mo>−</m:mo><m:mi>π</m:mi><m:mo>/</m:mo><m:mn>2</m:mn><m:mo>,</m:mo><m:mi>π</m:mi><m:mo>/</m:mo><m:mn>2</m:mn><m:mo>]</m:mo><m:mo>;</m:mo></m:mrow></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd columnalign="left"><m:mtable><m:mtr><m:mtd columnalign="left"><m:mtext>acos:</m:mtext><m:mrow><m:mo>[</m:mo><m:mo>−</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mn>1</m:mn><m:mo>]</m:mo><m:mo>→</m:mo><m:mrow><m:mo>[</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mi>π</m:mi><m:mo>]</m:mo></m:mrow></m:mrow><m:mo>;</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext>atan: ℝ</m:mtext><m:mo>→</m:mo><m:mrow><m:mo>[</m:mo><m:mo>−</m:mo><m:mi>π</m:mi><m:mo>/</m:mo><m:mn>2</m:mn><m:mo>,</m:mo><m:mi>π</m:mi><m:mo>/</m:mo><m:mn>2</m:mn><m:mo>]</m:mo><m:mo>;</m:mo></m:mrow></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext>atan2</m:mtext><m:mo>:</m:mo><m:mtext> </m:mtext><m:msup><m:mrow><m:mtext>ℝ</m:mtext></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>→</m:mo><m:mrow><m:mo>[</m:mo><m:mo>−</m:mo><m:mi>π</m:mi><m:mo>,</m:mo><m:mi>π</m:mi><m:mo>]</m:mo><m:mn>.</m:mn></m:mrow></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr></m:mtable><m:mspace width="10.0em"/><m:mo>(2.2)</m:mo></m:mrow></m:math></div>
<p>The last function, atan2(<em>s, c</em>) is often very useful. It takes an <em>s</em> value proportional to sin <em>A</em> and a <em>c</em> value that scales cos <em>A</em> by the same factor and returns <em>A</em>. The factor is assumed to be positive. One way to think of this is that it returns the angle of a 2D Cartesian point (<em>s, c</em>) in <a id="index_term884"/>polar coordinates (<a href="C07_chapter2.xhtml#f2_9">Figure 2.9</a>).</p>
<figure id="f2_9" tabindex="0">
<img alt="" src="../images/fig2_9.jpg"/>
<figcaption><p><span class="blue">Figure 2.9.</span> The function atan2<em>(s,c)</em> returns the angle A and is often very useful in graphics.</p></figcaption>
</figure>
</section>
<section>
<h3 id="sec2_3_3"><a id="index_term542"/><span class="green">2.3.3 Useful Identities</span></h3>
<p>This section lists without derivation a variety of useful trigonometric identities.</p>
<p class="noindent3"><strong><a id="index_term1074"/><span class="green">Shifting identities:</span></strong></p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable columnalign="left"><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mtext>sin</m:mtext><m:mrow><m:mo>(</m:mo><m:mo>−</m:mo><m:mi>A</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mo>−</m:mo><m:mtext>sin</m:mtext><m:mi>A</m:mi></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext>cos</m:mtext><m:mrow><m:mo>(</m:mo><m:mo>−</m:mo><m:mi>A</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mtext>cos</m:mtext><m:mi>A</m:mi></m:mrow></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext>tan</m:mtext><m:mrow><m:mo>(</m:mo><m:mo>−</m:mo><m:mi>A</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mo>−</m:mo><m:mtext>tan</m:mtext><m:mi>A</m:mi></m:mrow></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext>sin</m:mtext><m:mrow><m:mo>(</m:mo><m:mi>π</m:mi><m:mo>/</m:mo><m:mn>2</m:mn><m:mo>−</m:mo><m:mi>A</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mtext>cos</m:mtext><m:mi>A</m:mi></m:mrow></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext>cos</m:mtext><m:mrow><m:mo>(</m:mo><m:mi>π</m:mi><m:mo>/</m:mo><m:mn>2</m:mn><m:mo>−</m:mo><m:mi>A</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mtext>sin</m:mtext><m:mi>A</m:mi></m:mrow></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext>tan</m:mtext><m:mrow><m:mo>(</m:mo><m:mi>π</m:mi><m:mo>/</m:mo><m:mn>2</m:mn><m:mo>−</m:mo><m:mi>A</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mtext>cot</m:mtext><m:mi>A</m:mi></m:mrow></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>
<a id="term-968"/><a id="term-969"/><span aria-label="20" epub:type="pagebreak" id="pg_20" role="doc-pagebreak"/>
<strong><a id="index_term914"/><span class="green">Pythagorean identities:</span></strong>
</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:msup><m:mrow><m:msup><m:mrow><m:mtext>sin</m:mtext></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>⁢</m:mo><m:mtext> </m:mtext><m:mtext> </m:mtext><m:mi>A</m:mi><m:mo>+</m:mo><m:mtext>cos</m:mtext></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mtext> </m:mtext><m:mi>A</m:mi><m:mo>=</m:mo><m:mn>1</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:msup><m:mrow><m:msup><m:mrow><m:mtext>sec</m:mtext></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>⁢</m:mo><m:mtext> </m:mtext><m:mtext> </m:mtext><m:mi>A</m:mi><m:mo>−</m:mo><m:mtext>tan</m:mtext></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mtext> </m:mtext><m:mi>A</m:mi><m:mo>=</m:mo><m:mn>1</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:msup><m:mrow><m:msup><m:mrow><m:mtext>csc</m:mtext></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>⁢</m:mo><m:mtext> </m:mtext><m:mtext> </m:mtext><m:mi>A</m:mi><m:mo>−</m:mo><m:mtext>cot</m:mtext></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mtext> </m:mtext><m:mi>A</m:mi><m:mo>=</m:mo><m:mn>1</m:mn></m:mtd></m:mtr><m:mtr><m:mtd/></m:mtr><m:mtr><m:mtd/></m:mtr></m:mtable></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>
<strong><span class="green">Half-angle identities:</span></strong>
</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable columnalign="left"><m:mtr><m:mtd><m:mtext>sin</m:mtext><m:mrow><m:mo>(</m:mo><m:mi>A</m:mi><m:mo>+</m:mo><m:mi>B</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mtext>sin</m:mtext><m:mi>A</m:mi><m:mtext> </m:mtext><m:mtext>cos</m:mtext><m:mi>B</m:mi><m:mo>⁢</m:mo><m:mtext> </m:mtext><m:mo>+</m:mo><m:mtext>sin</m:mtext><m:mi>B</m:mi><m:mo>⁢</m:mo><m:mtext>cos</m:mtext><m:mi>A</m:mi></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext>sin</m:mtext><m:mrow><m:mo>(</m:mo><m:mi>A</m:mi><m:mo>−</m:mo><m:mi>B</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mtext>sin</m:mtext><m:mi>A</m:mi><m:mtext> </m:mtext><m:mtext>cos</m:mtext><m:mi>B</m:mi><m:mo>−</m:mo><m:mo>⁢</m:mo><m:mtext>sin</m:mtext><m:mi>B</m:mi><m:mo>⁢</m:mo><m:mtext>cos</m:mtext><m:mi>A</m:mi></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext>sin</m:mtext><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>A</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mn>2</m:mn><m:mtext>sin</m:mtext><m:mi>A</m:mi><m:mtext>cos</m:mtext><m:mi>A</m:mi></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext>cos</m:mtext><m:mrow><m:mo>(</m:mo><m:mi>A</m:mi><m:mo>+</m:mo><m:mi>B</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mtext>cos</m:mtext><m:mi>A</m:mi><m:mo>⁢</m:mo><m:mtext>cos</m:mtext><m:mi>B</m:mi><m:mo>−</m:mo><m:mtext>sin</m:mtext><m:mi>A</m:mi><m:mtext>sin</m:mtext><m:mi>B</m:mi></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext>cos</m:mtext><m:mrow><m:mo>(</m:mo><m:mi>A</m:mi><m:mo>−</m:mo><m:mi>B</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mtext>cos</m:mtext><m:mi>A</m:mi><m:mo>⁢</m:mo><m:mtext>cos</m:mtext><m:mi>B</m:mi><m:mo>+</m:mo><m:mtext>sin</m:mtext><m:mi>A</m:mi><m:mtext>sin</m:mtext><m:mi>B</m:mi></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext>cos</m:mtext><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>A</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:msup><m:mrow><m:mtext>cos</m:mtext></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mtext> </m:mtext><m:mi>A</m:mi><m:mo>−</m:mo><m:msup><m:mrow><m:mtext>sin</m:mtext></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mtext> </m:mtext><m:mi>A</m:mi></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:mrow><m:mtext>tan</m:mtext><m:mrow><m:mo>(</m:mo><m:mtext> </m:mtext><m:mi>A</m:mi><m:mo>+</m:mo><m:mi>B</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mfrac><m:mrow><m:mtext>tan</m:mtext><m:mi>A</m:mi><m:mo>+</m:mo><m:mtext>tan</m:mtext><m:mi>B</m:mi></m:mrow><m:mrow><m:mn>1</m:mn><m:mo>−</m:mo><m:mtext>tan</m:mtext><m:mi>A</m:mi><m:mtext> </m:mtext><m:mtext>tan</m:mtext><m:mi>B</m:mi></m:mrow></m:mfrac></m:mrow></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:mrow><m:mtext>tan</m:mtext><m:mrow><m:mo>(</m:mo><m:mtext> </m:mtext><m:mi>A</m:mi><m:mo>−</m:mo><m:mi>B</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mfrac><m:mrow><m:mtext>tan</m:mtext><m:mi>A</m:mi><m:mo>−</m:mo><m:mtext>tan</m:mtext><m:mi>B</m:mi></m:mrow><m:mrow><m:mn>1</m:mn><m:mo>+</m:mo><m:mtext>tan</m:mtext><m:mi>A</m:mi><m:mtext> </m:mtext><m:mtext>tan</m:mtext><m:mi>B</m:mi></m:mrow></m:mfrac></m:mrow></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext>tan</m:mtext><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>A</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mfrac><m:mrow><m:mn>2</m:mn><m:mtext>tan</m:mtext><m:mi>A</m:mi></m:mrow><m:mrow><m:mn>1</m:mn><m:mo>−</m:mo><m:msup><m:mrow><m:mtext>tan</m:mtext></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mi>A</m:mi></m:mrow></m:mfrac></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd/></m:mtr><m:mtr><m:mtd/></m:mtr><m:mtr><m:mtd/></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>
<strong><span class="green">Half-angle identities:</span></strong>
</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:msup><m:mrow><m:mtext>sin</m:mtext></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mrow><m:mo>(</m:mo><m:mi>A</m:mi><m:mo>/</m:mo><m:mn>2</m:mn><m:mo>)</m:mo><m:mo>=</m:mo><m:mrow><m:mo>(</m:mo><m:mn>1</m:mn><m:mo>−</m:mo><m:mtext>cos</m:mtext><m:mtext> </m:mtext><m:mi>A</m:mi><m:mo>)</m:mo><m:mo>/</m:mo><m:mn>2</m:mn></m:mrow></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:msup><m:mrow><m:mtext>cos</m:mtext></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mrow><m:mo>(</m:mo><m:mi>A</m:mi><m:mo>/</m:mo><m:mn>2</m:mn><m:mo>)</m:mo><m:mo>=</m:mo><m:mrow><m:mo>(</m:mo><m:mn>1</m:mn><m:mo>+</m:mo><m:mtext>cos</m:mtext><m:mtext> </m:mtext><m:mi>A</m:mi><m:mo>)</m:mo><m:mo>/</m:mo><m:mn>2</m:mn></m:mrow></m:mrow></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>
<strong><span class="green">Product identities:</span></strong>
</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mtext>sin</m:mtext><m:mi>A</m:mi><m:mtext>sin</m:mtext><m:mi>B</m:mi><m:mo>=</m:mo><m:mo>−</m:mo><m:mrow><m:mo>(</m:mo><m:mtext>cos</m:mtext><m:mrow><m:mo>(</m:mo><m:mi>A</m:mi><m:mo>+</m:mo><m:mi>B</m:mi><m:mo>)</m:mo><m:mo>−</m:mo><m:mtext>cos</m:mtext><m:mrow><m:mo>(</m:mo><m:mi>A</m:mi><m:mo>−</m:mo><m:mi>B</m:mi><m:mo>)</m:mo></m:mrow></m:mrow><m:mo>)</m:mo></m:mrow><m:mo>/</m:mo><m:mn>2</m:mn></m:mtd></m:mtr><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mtext>sin</m:mtext><m:mi>A</m:mi><m:mtext>cos</m:mtext><m:mi>B</m:mi><m:mo>=</m:mo><m:mo>−</m:mo><m:mrow><m:mo>(</m:mo><m:mtext>sin</m:mtext><m:mrow><m:mo>(</m:mo><m:mi>A</m:mi><m:mo>+</m:mo><m:mi>B</m:mi><m:mo>)</m:mo><m:mo>+</m:mo><m:mtext>sin</m:mtext><m:mrow><m:mo>(</m:mo><m:mi>A</m:mi><m:mo>−</m:mo><m:mi>B</m:mi><m:mo>)</m:mo></m:mrow></m:mrow><m:mo>)</m:mo></m:mrow><m:mo>/</m:mo><m:mn>2</m:mn></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext>cos</m:mtext><m:mi>A</m:mi><m:mtext>cos</m:mtext><m:mi>B</m:mi><m:mo>=</m:mo><m:mo>−</m:mo><m:mrow><m:mo>(</m:mo><m:mtext>cos</m:mtext><m:mrow><m:mo>(</m:mo><m:mi>A</m:mi><m:mo>+</m:mo><m:mi>B</m:mi><m:mo>)</m:mo><m:mo>+</m:mo><m:mtext>cos</m:mtext><m:mrow><m:mo>(</m:mo><m:mi>A</m:mi><m:mo>−</m:mo><m:mi>B</m:mi><m:mo>)</m:mo></m:mrow></m:mrow><m:mo>)</m:mo></m:mrow><m:mo>/</m:mo><m:mn>2</m:mn></m:mtd></m:mtr><m:mtr><m:mtd/></m:mtr></m:mtable></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>The following identities are for arbitrary triangles with side lengths <em>a, b</em>, and <em>c</em>, each with an angle opposite it given by <em>A, B, C</em>, respectively (<a href="C07_chapter2.xhtml#f2_10">Figure 2.10</a>),</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable columnalign="left"><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mfrac><m:mrow><m:mtext>sin</m:mtext><m:mi>A</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:mfrac><m:mo>=</m:mo><m:mfrac><m:mrow><m:mtext>sin</m:mtext><m:mi>B</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:mfrac><m:mo>=</m:mo><m:mfrac><m:mrow><m:mtext>sin</m:mtext><m:mi>C</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:mfrac></m:mtd><m:mtd><m:mrow><m:mo>(</m:mo><m:mtext><a id="index_term667"/>Law of sines</m:mtext><m:mo>)</m:mo></m:mrow></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:msup><m:mrow><m:mi>c</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>=</m:mo><m:msup><m:mrow><m:mi>a</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>+</m:mo><m:msup><m:mrow><m:mi>b</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>−</m:mo><m:mn>2</m:mn><m:mi>a</m:mi><m:mi>b</m:mi><m:mtext>cos</m:mtext><m:mi>C</m:mi></m:mtd></m:mtr></m:mtable></m:mtd><m:mtd><m:mrow><m:mo>(</m:mo><m:mtext> </m:mtext><m:mtext>Law of cosiness</m:mtext><m:mo>)</m:mo></m:mrow></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mfrac><m:mrow><m:mi>a</m:mi><m:mo>+</m:mo><m:mi>b</m:mi></m:mrow><m:mrow><m:mi>a</m:mi><m:mo>−</m:mo><m:mi>b</m:mi></m:mrow></m:mfrac><m:mo>=</m:mo><m:mfrac><m:mrow><m:mtext>tan</m:mtext><m:mrow><m:mo>(</m:mo><m:mfrac><m:mrow><m:mi>A</m:mi><m:mo>+</m:mo><m:mi>B</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:mfrac><m:mo>)</m:mo></m:mrow></m:mrow><m:mrow><m:mtext>tan</m:mtext><m:mrow><m:mo>(</m:mo><m:mfrac><m:mrow><m:mi>A</m:mi><m:mo>−</m:mo><m:mi>B</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:mfrac><m:mo>)</m:mo></m:mrow></m:mrow></m:mfrac></m:mtd></m:mtr></m:mtable></m:mtd><m:mtd><m:mrow><m:mo>(</m:mo><m:mtext><a id="index_term668"/>Law of tangents</m:mtext><m:mo>)</m:mo></m:mrow></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>The area of a triangle can also be computed in terms of these side lengths:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext>Triangle area =</m:mtext><m:mfrac><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>4</m:mn></m:mrow></m:mfrac><m:msqrt><m:mrow><m:mrow><m:mo>(</m:mo><m:mi>a</m:mi><m:mo>+</m:mo><m:mi>b</m:mi><m:mo>+</m:mo><m:mi>c</m:mi><m:mo>)</m:mo><m:mrow><m:mo>(</m:mo><m:mo>−</m:mo><m:mi>a</m:mi><m:mo>+</m:mo><m:mi>b</m:mi><m:mo>+</m:mo><m:mi>c</m:mi><m:mo>)</m:mo><m:mrow><m:mo>(</m:mo><m:mi>a</m:mi><m:mo>−</m:mo><m:mi>b</m:mi><m:mo>+</m:mo><m:mi>c</m:mi><m:mo>)</m:mo><m:mrow><m:mo>(</m:mo><m:mi>a</m:mi><m:mo>+</m:mo><m:mi>b</m:mi><m:mo>−</m:mo><m:mi>c</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mrow></m:mrow></m:mrow></m:msqrt><m:mn>.</m:mn></m:mrow></m:math>
</div>
<figure id="f2_10" tabindex="0">
<img alt="" src="../images/fig2_10.jpg"/>
<figcaption><p><span class="blue">Figure 2.10.</span> Geometry for triangle <a id="index_term1155"/>laws.</p></figcaption>
</figure>
</section>
<section>
<h3 id="sec2_3_4"><a id="term-992"/><span aria-label="21" epub:type="pagebreak" id="pg_21" role="doc-pagebreak"/><span class="green">2.3.4 Solid Angles and Spherical Trigonometry</span></h3>
<p>Traditional trigonometry in this section deals with triangles on the plane. Triangles can be defined on non-planar surfaces as well, and one that arises in many fields, astronomy, for example, is triangles on the unit-radius sphere. These <em>spherical triangles</em> have sides that are segments of the <em><a id="index_term509"/>great circles</em> (unit-radius circles) on the sphere. The study of these triangles is a field called <em>spherical trigonometry</em> and is not used that commonly in graphics, but sometimes, it is critical when it does arise. We wont discuss the details of it here, but want the reader to be aware that area exists for when those problems do arise, and there are a lot of useful rules such as a spherical law of cosines and a spherical law of <a id="index_term1086"/>sines. For an example of the machinery of <a id="index_term1286"/><a id="index_term1124"/>spherical trigonometry being used, see the paper on sampling triangle lights (which project to a spherical triangle) (Arvo, 1995b).</p>
<p>Of more central importance to computer graphics are <em>solid angles</em>. While angles allow us to quantify things like “what is the separation of those two poles in my visual field,” solid angles let us quantify things like “how much of my visual field does that airplane cover.” For traditional angles, we project the posts onto the unit circle and measure arc length between them on the unit circle. We work with angles often enough that many of us can forget this definition because it is all so intuitive to us now. Solid angles are just as simple, but they may seem more confusing because most of us learn about them as adults. For solid angles, we project the visible directions that “see” the airplane and project it onto the unit sphere and measure the area. This area is the solid angle in the same way the arc length is the angle. While angles are measured in radians and sum to 2<em>π</em> (the total length of a unit circle), <a id="index_term1098"/><a id="index_term27"/>solid angles are measured in <em><a id="index_term1130"/>steradians</em> and sum to 4<em>π</em> (the total area of a unit sphere).</p>
</section>
</section>
<section>
<h2 id="sec2_4"><a id="index_term1309"/><a epub:type="backlink" href="C02a_toc.xhtml#rsec2_4" role="doc-backlink"><span class="green">2.4 Vectors</span></a></h2>
<figure id="f2_11" tabindex="0">
<img alt="" src="../images/fig2_11.jpg"/>
<figcaption><p><span class="blue">Figure 2.11.</span> These two vectors are the same because they have the same length and direction.</p></figcaption>
</figure>
<p class="noindent">A <em>vector</em> describes a length and a direction. It can be usefully represented by an arrow. Two vectors are equal if they have the same length and direction even if we think of them as being located in different places (<a href="C07_chapter2.xhtml#f2_11">Figure 2.11</a>). As much as possible, you should think of a vector as an arrow and not as coordinates or numbers. At some point, we will have to represent vectors as numbers in our programs, but even in code, they should be manipulated as objects and only the low-level vector operations should know about their numeric representation (DeRose, 1989). Vectors will be represented as bold characters, e.g., <strong>a</strong>. A vector’s length is denoted <a id="term-991"/><a id="term-993"/><span aria-label="22" epub:type="pagebreak" id="pg_22" role="doc-pagebreak"/>||a||. A <em><a id="index_term1302"/>unit vector</em> is any vector whose length is one. The <em><a id="index_term1470"/>zero vector</em> is the vector of zero length. The direction of the zero vector is undefined.</p>
<p>Vectors can be used to represent many different things. For example, they can be used to store an <em>offset</em>, also called a <em>displacement</em>. If we know “the treasure is buried two paces east and three paces north of the secret meeting place,” then we know the offset, but we don’t know where to start. Vectors can also be used to store a <em>location</em>, another word for <em><a id="index_term889"/>position</em> or <em><a id="index_term879"/>point</em>. Locations can be represented as a displacement from another location. Usually, there is some understood <em>origin</em> location from which all other locations are stored as offsets. Note that locations are not vectors. As we shall discuss, you can add two vectors. However, it usually does not make sense to add two locations unless it is an intermediate operation when computing weighted averages of a location (Goldman, 1985). Adding two offsets does make sense, so that is one reason why offsets are vectors. But this emphasizes that a location is not an offset; it is an offset from a specific <a id="index_term805"/>origin location. The <a id="index_term800"/>offset by itself is not the <a id="index_term702"/>location.</p>
<section>
<h3 id="sec2_4_1"><a id="index_term1307"/><span class="green">2.4.1 Vector Operations</span></h3>
<figure id="f2_12" tabindex="0">
<img alt="" src="../images/fig2_12.jpg"/>
<figcaption><p><span class="blue">Figure 2.12.</span> Two vectors are added by arranging them head to tail. This can be done in either order.</p></figcaption>
</figure>
<figure id="f2_13" tabindex="0">
<img alt="" src="../images/fig2_13.jpg"/>
<figcaption><p><span class="blue">Figure 2.13.</span> The vector –a has the same length but opposite direction of the vector a.</p></figcaption>
</figure>
<p class="noindent">Vectors have most of the usual arithmetic operations that we associate with real numbers. Two vectors are equal if and only if they have the same length and direction. Two vectors are added according to the <em>parallelogram rule</em>. This rule states that the sum of two vectors is found by placing the tail of either vector against the head of the other (<a href="C07_chapter2.xhtml#f2_12">Figure 2.12</a>). The sum vector is the vector that “completes the triangle” started by the two vectors. The parallelogram is formed by taking the sum in either order. This emphasizes that vector addition is commutative:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext>a</m:mtext><m:mo>+</m:mo><m:mtext>b</m:mtext><m:mo>=</m:mo><m:mtext>b</m:mtext><m:mo>+</m:mo><m:mtext>a</m:mtext><m:mn>.</m:mn></m:mrow></m:math>
</div>
<p>Note that the <a id="index_term821"/>parallelogram rule just formalizes our intuition about displacements. Think of walking along one vector, tail to head, and then walking along the other. The net <a id="index_term338"/>displacement is just the parallelogram diagonal. You can also create a <em><a id="index_term1299"/>unary minus</em> for a vector: <em>–</em><strong>a</strong> (<a href="C07_chapter2.xhtml#f2_13">Figure 2.13</a>) is a vector with the same length as <strong>a</strong> but opposite direction. This allows us to also define subtraction:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext>b</m:mtext><m:mo>−</m:mo><m:mtext>a</m:mtext><m:mo>≡</m:mo><m:mo>−</m:mo><m:mtext>a</m:mtext><m:mo>+</m:mo><m:mtext>b.</m:mtext></m:mrow></m:math>
</div>
<p>You can visualize vector subtraction with a parallelogram (<a href="C07_chapter2.xhtml#f2_14">Figure 2.14</a>). We can write</p>
<figure id="f2_14" tabindex="0">
<img alt="" src="../images/fig2_14.jpg"/>
<figcaption><p><span class="blue">Figure 2.14.</span> Vector subtraction is just vector addition with a reversal of the second argument.</p></figcaption>
</figure>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext>a</m:mtext><m:mo>+</m:mo><m:mrow><m:mo>(</m:mo><m:mtext>b</m:mtext><m:mo>−</m:mo><m:mtext>a</m:mtext><m:mo>)</m:mo><m:mo>=</m:mo><m:mtext>b.</m:mtext></m:mrow></m:mrow></m:math>
</div>
<p>Vectors can also be multiplied. In fact, there are several kinds of products involving vectors. First, we can <em><a id="index_term1014"/>scale</em> the vector by multiplying it by a real number <em>k</em>.</p>
<p class="noindent"><a id="term-82"/><a id="term-577"/><a id="term-994"/><span aria-label="23" epub:type="pagebreak" id="pg_23" role="doc-pagebreak"/>This just multiplies the vector’s length without changing its direction. For example, 3.5<strong>a</strong> is a vector in the same direction as <strong>a</strong>, but it is 3.5 times as long as <strong>a</strong>. We discuss two products involving two vectors, the dot product and the cross product, later in this section, and a product involving three vectors, the determinant, in <a href="C11_chapter6.xhtml#c6">Chapter 6</a>.</p>
</section>
<section>
<h3 id="sec2_4_2"><a id="index_term126"/><span class="green">2.4.2 Cartesian Coordinates of a Vector</span></h3>
<p>A 2D vector can be written as a combination of any two nonzero vectors which are not parallel. This property of the two vectors is called <em><a id="index_term690"/>linear independence</em>. Two linearly independent vectors form a 2D <em>basis</em>, and the vectors are thus referred to as <em>basis vectors</em>. For example, a vector <strong>c</strong> may be expressed as a combination of two basis vectors <strong>a</strong> and <strong>b</strong> (<a href="C07_chapter2.xhtml#f2_15">Figure 2.15</a>):</p>
<figure id="f2_15" tabindex="0">
<img alt="" src="../images/fig2_15.jpg"/>
<figcaption><p><span class="blue">Figure 2.15.</span> Any 2D vector <strong>c</strong> is a weighted sum of any two nonparallel 2D vectors <strong>a</strong> and <strong>b</strong>.</p></figcaption>
</figure>
<div class="disp-formula" id="c002_equ03">
<m:math alttext=""><m:mrow><m:mtext mathvariant="bold">c</m:mtext><m:mo>=</m:mo><m:msub><m:mrow><m:mi>a</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mtext>a</m:mtext><m:mo>+</m:mo><m:msub><m:mrow><m:mi>b</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mtext> </m:mtext><m:mtext>b.</m:mtext></m:mrow><m:mspace width="3em"/><m:mo>(2.3)</m:mo></m:math>
</div>
<p>Note that the weights <em>a<sub>c</sub></em> and <em>b<sub>c</sub></em> are unique. Bases are especially useful if the two vectors are <em><a id="index_term806"/>orthogonal</em>; i.e., they are at right angles to each other. It is even more useful if they are also unit vectors in which case they are <em>orthonormal</em>. If we assume two such “special” vectors <strong>x</strong> and <strong>y</strong> are known to us, then we can use them to represent all other vectors in a <em>Cartesian</em> coordinate system, where each vector is represented as two real numbers. For example, a vector <strong>a</strong> might be represented as</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext>a</m:mtext><m:mo>=</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mtext>x</m:mtext><m:mo>+</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mtext>y,</m:mtext></m:mrow></m:math>
</div>
<p>where <em>x<sub>a</sub></em> and <em>y<sub>a</sub></em> are the real Cartesian coordinates of the 2D vector <strong>a</strong> (<a href="C07_chapter2.xhtml#f2_16">Figure 2.16</a>). Note that this is not really any different conceptually from Equation (2.3), where the basis vectors were not orthonormal. But there are several advantages to a Cartesian coordinate system. For instance, by the Pythagorean theorem, the length of <strong>a</strong> is</p>
<figure id="f2_16" tabindex="0">
<img alt="" src="../images/fig2_16.jpg"/>
<figcaption><p><span class="blue">Figure 2.16.</span> A 2D Cartesian basis for vectors.</p></figcaption>
</figure>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mrow><m:mo>‖</m:mo><m:mtext>a</m:mtext><m:mo>‖</m:mo><m:mo>=</m:mo><m:msqrt><m:mrow><m:msubsup><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msubsup><m:mo>+</m:mo><m:msubsup><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msubsup></m:mrow></m:msqrt><m:mn>.</m:mn></m:mrow></m:mrow></m:math>
</div>
<p>It is also simple to compute dot products, cross products, and coordinates of vectors in Cartesian systems, as we’ll see in the following sections.</p>
<p>By convention, we write the coordinates of <strong>a</strong> either as an ordered pair (<em>x<sub>a</sub>,y<sub>a</sub></em>) or a column matrix:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext>a</m:mtext><m:mo>=</m:mo><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mn>.</m:mn></m:mrow></m:mrow></m:math>
</div>
<p>The form we use will depend on typographic convenience. We will also occasionally write the vector as a row matrix, which we will indicate as <strong>a</strong><sup>T</sup>:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:msup><m:mrow><m:mtext>a</m:mtext></m:mrow><m:mrow><m:mtext>T</m:mtext></m:mrow></m:msup><m:mo>=</m:mo><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mtd><m:mtd><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mn>.</m:mn></m:mrow></m:mrow></m:math>
</div>
<p><a id="term-276"/><a id="term-644"/><span aria-label="24" epub:type="pagebreak" id="pg_24" role="doc-pagebreak"/>We can also represent 3D, 4D, etc., vectors in Cartesian coordinates. For the 3D case, we use a basis vector <strong>z</strong> that is orthogonal to both <strong>x</strong> and <strong>y</strong>.</p>
</section>
<section>
<h3 id="sec2_4_3"><span class="green">2.4.3 Dot Product</span></h3>
<p>The simplest way to multiply two vectors is the <em>dot</em> product. The dot product of <strong>a</strong> and <strong>b</strong> is denoted <strong>a</strong> · <strong>b</strong> and is often called the <em><a id="index_term1013"/>scalar product</em> because it returns a scalar. The dot product returns a value related to its arguments’ lengths and the angle ϕ between them (<a href="C07_chapter2.xhtml#f2_17">Figure 2.17</a>):</p>
<div class="disp-formula" id="equ2_4">
<m:math alttext=""><m:mrow><m:mtext>a</m:mtext><m:mo>·</m:mo><m:mtext>b</m:mtext><m:mo>=</m:mo><m:mrow><m:mo>‖</m:mo><m:mtext>a</m:mtext><m:mo>‖</m:mo></m:mrow><m:mrow><m:mo>‖</m:mo><m:mtext>b</m:mtext><m:mo>‖</m:mo></m:mrow><m:mtext>cos</m:mtext><m:mi>ϕ</m:mi><m:mo>,</m:mo></m:mrow><m:mspace width="3em"/><m:mo>(2.4)</m:mo></m:math>
</div>
<p>The most common use of the dot product in graphics programs is to compute the <a id="index_term269"/>cosine of the angle between two vectors.</p>
<p>The dot product can also be used to find the <em>projection</em> of one vector onto another. This is the length <strong>a</strong>→<strong>b</strong> of a vector <strong>a</strong> that is projected at right angles onto a vector <strong>b</strong> (<a href="C07_chapter2.xhtml#f2_18">Figure 2.18</a>):</p>
<div class="disp-formula" id="equ2_5">
<m:math alttext=""><m:mrow><m:mtext>a</m:mtext><m:mo>→</m:mo><m:mtext>b</m:mtext><m:mo>=</m:mo><m:mrow><m:mo>‖</m:mo><m:mtext>a</m:mtext><m:mo>‖</m:mo><m:mtext>cos</m:mtext><m:mi>φ</m:mi><m:mo>=</m:mo><m:mfrac><m:mrow><m:mtext>a</m:mtext><m:mo>·</m:mo><m:mtext>b</m:mtext></m:mrow><m:mrow><m:mrow><m:mo>‖</m:mo><m:mtext>b</m:mtext><m:mo>‖</m:mo></m:mrow></m:mrow></m:mfrac><m:mn>.</m:mn></m:mrow></m:mrow><m:mspace width="3em"/><m:mo>(2.5)</m:mo></m:math>
</div>
<figure id="f2_17" tabindex="0">
<img alt="" src="../images/fig2_17.jpg"/>
<figcaption><p><span class="blue">Figure 2.17.</span> The dot product is related to length and angle and is one of the most important formulas in graphics.</p></figcaption>
</figure>
<p>The dot product obeys the familiar associative and distributive properties we have in real arithmetic:</p>
<figure id="f2_18" tabindex="0">
<img alt="" src="../images/fig2_18.jpg"/>
<figcaption><p><span class="blue">Figure 2.18.</span> The <a id="index_term906"/>projection of <strong>a</strong> onto <strong>b</strong> is a length found by Equation (2.5).</p></figcaption>
</figure>
<div class="disp-formula" id="equ2_6">
<m:math alttext=""><m:mrow><m:mtable columnalign="left"><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mtext>a</m:mtext><m:mo>·</m:mo><m:mtext>b</m:mtext><m:mo>=</m:mo><m:mtext>b</m:mtext><m:mo>·</m:mo><m:mtext>a,</m:mtext></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext>a</m:mtext><m:mo>·</m:mo><m:mrow><m:mo>(</m:mo><m:mtext> </m:mtext><m:mtext>b</m:mtext><m:mo>+</m:mo><m:mtext>c</m:mtext><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mtext>a</m:mtext><m:mo>·</m:mo><m:mtext>b</m:mtext><m:mo>+</m:mo><m:mtext>a</m:mtext><m:mo>·</m:mo><m:mtext>c,</m:mtext></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mrow><m:mo>(</m:mo><m:mtable><m:mtr><m:mtd><m:mi>k</m:mi><m:mtext>a</m:mtext></m:mtd></m:mtr></m:mtable><m:mo>)</m:mo></m:mrow><m:mo>·</m:mo><m:mtext>b</m:mtext><m:mo>=</m:mo><m:mtext>a</m:mtext><m:mo>·</m:mo><m:mrow><m:mo>(</m:mo><m:mi>k</m:mi><m:mtext>b</m:mtext><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>k</m:mi><m:mtext>a</m:mtext><m:mo>·</m:mo><m:mtext>b.</m:mtext></m:mrow></m:mtd></m:mtr></m:mtable></m:mrow><m:mspace width="3em"/><m:mo>(2.6)</m:mo></m:math>
</div>
<p>If 2D vectors a and b are expressed in Cartesian coordinates, we can take advantage of <strong>x</strong> · <strong>x</strong> = <strong>y</strong> · <strong>y</strong> = 1 and <strong>x</strong> · <strong>y</strong> = 0 to derive that their <a id="index_term343"/>dot product is</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mtext>a</m:mtext><m:mo>·</m:mo><m:mtext>b</m:mtext></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mtext>x</m:mtext><m:mo>+</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mtext>y</m:mtext><m:mo>)</m:mo><m:mo>·</m:mo><m:mo>(</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mtext>x</m:mtext><m:mo>+</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mtext>y</m:mtext><m:mo>)</m:mo></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mtext>x</m:mtext><m:mo>·</m:mo><m:mtext>x</m:mtext><m:mo>)</m:mo><m:mo>+</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub></m:mrow><m:mo>(</m:mo><m:mtext>x</m:mtext><m:mo>·</m:mo><m:mtext>y</m:mtext><m:mo>)</m:mo><m:mo>+</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mtext>y</m:mtext><m:mo>·</m:mo><m:mtext>x</m:mtext><m:mo>)</m:mo></m:mrow><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mtext>y</m:mtext><m:mo>·</m:mo><m:mtext>y</m:mtext><m:mo>)</m:mo></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mn>.</m:mn></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>Similarly in 3Dwe can find</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext>a</m:mtext><m:mo>·</m:mo><m:mtext>b</m:mtext><m:mo>=</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:msub><m:mrow><m:mi>z</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>z</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mn>.</m:mn></m:mrow></m:math>
</div>
</section>
<section>
<h3 id="sec2_4_4"><a id="index_term278"/><a id="term-223"/><span aria-label="25" epub:type="pagebreak" id="pg_25" role="doc-pagebreak"/><span class="green">2.4.4 Cross Product</span></h3>
<p>The cross product <strong>a</strong> × <strong>b</strong> is usually used only for three-dimensional vectors; generalized cross products are discussed in references given in the chapter notes. The cross product returns a 3D vector that is perpendicular to the two arguments of the cross product. The length of the resulting vector is related to sin ϕ:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mrow><m:mo>‖</m:mo><m:mtext>a</m:mtext><m:mo>×</m:mo><m:mtext>b</m:mtext><m:mo>‖</m:mo><m:mo>=</m:mo><m:mo>‖</m:mo><m:mtext>a</m:mtext><m:mo>‖</m:mo></m:mrow><m:mo>‖</m:mo><m:mtext>b</m:mtext><m:mo>‖</m:mo><m:mtext>sin</m:mtext><m:mi>ϕ</m:mi><m:mn>.</m:mn></m:mrow></m:math>
</div>
<p>The magnitude ||<strong>a</strong> × <strong>b</strong>|| is equal to the area of the parallelogram formed by vectors <strong>a</strong> and <strong>b</strong>. In addition, <strong>a</strong> × <strong>b</strong> is perpendicular to both <strong>a</strong> and <strong>b</strong> (<a href="C07_chapter2.xhtml#f2_19">Figure 2.19</a>). Note that there are only two possible directions for such a vector. By definition, the vectors in the direction of the <em>x-</em>, <em>y-</em> and <em>z-</em>axes are given by</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mtext>x</m:mtext></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mrow><m:mo>(</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mn>0</m:mn><m:mo>)</m:mo><m:mo>,</m:mo></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext>y</m:mtext></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mrow><m:mo>(</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mn>0</m:mn><m:mo>)</m:mo><m:mo>,</m:mo></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext>z</m:mtext></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mrow><m:mo>(</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mn>1</m:mn><m:mo>)</m:mo><m:mo>,</m:mo></m:mrow></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>and we set as a convention that <strong>x</strong> × <strong>y</strong> must be in the plus or minus <strong>z</strong> direction. The choice is somewhat arbitrary, but it is standard to assume that</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext>z</m:mtext><m:mo>=</m:mo><m:mtext>x</m:mtext><m:mo>×</m:mo><m:mtext>y.</m:mtext></m:mrow></m:math>
</div>
<figure id="f2_19" tabindex="0">
<img alt="" src="../images/fig2_19.jpg"/>
<figcaption><p><span class="blue">Figure 2.19.</span> The cross product <strong>a</strong> × <strong>b</strong> is a 3D vector perpendicular to both 3D vectors a and b, and its length is equal to the area of the parallelogram shown.</p></figcaption>
</figure>
<p class="noindent">All possible permutations of the three Cartesian unit vectors are</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext> </m:mtext><m:mtable><m:mtr><m:mtd><m:mtext>x</m:mtext><m:mo>×</m:mo><m:mtext>y</m:mtext></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mo>+</m:mo><m:mtext>z,</m:mtext></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext>y</m:mtext><m:mo>×</m:mo><m:mtext>x</m:mtext></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mo>−</m:mo><m:mtext>z,</m:mtext></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext>y</m:mtext><m:mo>×</m:mo><m:mtext>z</m:mtext></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mo>+</m:mo><m:mtext>x,</m:mtext></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext>z</m:mtext><m:mo>×</m:mo><m:mtext>y</m:mtext></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mo>−</m:mo><m:mtext>x,</m:mtext></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext>z</m:mtext><m:mo>×</m:mo><m:mtext>x</m:mtext></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mo>+</m:mo><m:mtext>y,</m:mtext></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext>x</m:mtext><m:mo>×</m:mo><m:mtext>z</m:mtext></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mo>−</m:mo><m:mtext>y.</m:mtext></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd/><m:mtd/></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p class="indent">Because of the sin ϕ property, we also know that a vector cross itself is the zero vector, so <strong>x</strong> × <strong>x</strong> = <strong>0</strong> and so on. Note that the cross product is <em>not</em> commutative, i.e., <strong>x</strong> × <strong>y</strong> <em/> = <strong>y</strong> × <strong>x</strong>. The careful observer will note that the above discussion does not allow us to draw an unambiguous picture of how the Cartesian axes relate. More specifically, if we put <strong>x</strong> and <strong>y</strong> on a sidewalk, with <strong>x</strong> pointing east and <strong>y</strong> pointing north, then does <strong>z</strong> point up to the sky or into the ground? The usual convention is to have <strong>z</strong> point to the sky. This is known as a <em>right-handed</em> coordinate system. This name comes from the memory scheme of “grabbing” <strong>x</strong> <a id="term-719"/><span aria-label="26" epub:type="pagebreak" id="pg_26" role="doc-pagebreak"/>with your <em>right</em> palm and fingers and rotating it toward <strong>y</strong>. The vector <strong>z</strong> should align with your thumb. This is illustrated in <a href="C07_chapter2.xhtml#f2_20">Figure 2.20</a>.</p>
<figure id="f2_20" tabindex="0">
<img alt="" src="../images/fig2_20.jpg"/>
<figcaption><p><span class="blue">Figure 2.20.</span> The “righthand rule” for cross products. Imagine placing the base of your right palm where <strong>a</strong> and <strong>b</strong> join at their tails, and pushing the arrow of <strong>a</strong> toward <strong>b</strong>. Your extended right thumb should point toward <strong>a</strong> × <strong>b</strong>.</p></figcaption>
</figure>
<p>The cross product has the nice property that</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext>a</m:mtext><m:mo>×</m:mo><m:mrow><m:mo>(</m:mo><m:mtext>b</m:mtext><m:mo>+</m:mo><m:mtext>c</m:mtext><m:mo>)</m:mo><m:mo>=</m:mo><m:mtext>a</m:mtext><m:mo>×</m:mo><m:mtext>b</m:mtext><m:mo>+</m:mo><m:mtext>a</m:mtext><m:mo>×</m:mo><m:mtext>c,</m:mtext></m:mrow></m:mrow></m:math>
</div>
<p>and</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext>a</m:mtext><m:mo>×</m:mo><m:mrow><m:mo>(</m:mo><m:mi>k</m:mi><m:mtext>b</m:mtext><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>k</m:mi><m:mrow><m:mo>(</m:mo><m:mtext>a</m:mtext><m:mo>×</m:mo><m:mtext>b</m:mtext><m:mo>)</m:mo><m:mtext>.</m:mtext></m:mrow></m:mrow></m:mrow></m:math>
</div>
<p>However, a consequence of the <a id="index_term999"/>right-hand rule is</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext>a</m:mtext><m:mo>×</m:mo><m:mtext>b</m:mtext><m:mo>=</m:mo><m:mo>−</m:mo><m:mrow><m:mo>(</m:mo><m:mtext>b</m:mtext><m:mo>×</m:mo><m:mtext>a</m:mtext><m:mo>)</m:mo><m:mn>.</m:mn></m:mrow></m:mrow></m:math>
</div>
<p>In Cartesian coordinates, we can use an explicit expansion to compute the cross product:</p>
<div class="disp-formula" id="equ2_7">
<m:math alttext=""><m:mrow><m:mtable columnalign="left"><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mtext>a</m:mtext><m:mo>×</m:mo><m:mtext>b</m:mtext><m:mo>=</m:mo><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mtext>x</m:mtext><m:mo>+</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mtext>y</m:mtext><m:mo>+</m:mo><m:msub><m:mrow><m:mtext>z</m:mtext></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mtext>z</m:mtext><m:mo>)</m:mo><m:mo>×</m:mo><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mtext>x</m:mtext><m:mo>+</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mtext>y</m:mtext><m:mo>+</m:mo><m:msub><m:mrow><m:mi>z</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mtext>z</m:mtext><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mo>=</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mtext>x</m:mtext><m:mo>×</m:mo><m:mtext>x</m:mtext><m:mo>+</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mtext>y</m:mtext><m:mo>×</m:mo><m:mstyle><m:mrow><m:mtext>y</m:mtext><m:mo>+</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>z</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mtext>x</m:mtext><m:mo>×</m:mo><m:mtext>z</m:mtext></m:mrow></m:mstyle></m:mtd></m:mtr><m:mtr><m:mtd><m:mo>+</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mtext>y</m:mtext><m:mo>×</m:mo><m:mtext>x</m:mtext><m:mo>+</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mtext>y</m:mtext><m:mo>×</m:mo><m:mstyle><m:mrow><m:mtext>y</m:mtext><m:mo>+</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>z</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mtext>y</m:mtext><m:mo>×</m:mo><m:mtext>z</m:mtext></m:mrow></m:mstyle></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mo>+</m:mo><m:msub><m:mrow><m:mi>z</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mtext>z</m:mtext><m:mo>×</m:mo><m:mtext>x+</m:mtext><m:msub><m:mrow><m:mi>z</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mtext>z</m:mtext><m:mo>×</m:mo><m:mtext>y</m:mtext><m:mo>+</m:mo><m:msub><m:mrow><m:mi>z</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mtext>z</m:mtext><m:mo>×</m:mo><m:mtext>z</m:mtext></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mo>=</m:mo><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>z</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>z</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>)</m:mo><m:mtext>x +</m:mtext></m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>z</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>z</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>)</m:mo><m:mtext>y+</m:mtext><m:mo>(</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>)</m:mo><m:mtext>z.</m:mtext></m:mtd></m:mtr></m:mtable></m:mrow><m:mspace width="3em"/><m:mo>(2.7)</m:mo></m:math>
</div>
<p>So, in coordinate form,</p>
<div class="disp-formula" id="equ2_8">
<m:math alttext=""><m:mrow><m:mtext>a</m:mtext><m:mo>×</m:mo><m:mtext>b</m:mtext><m:mo>=</m:mo><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>z</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>z</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>,</m:mo><m:msub><m:mrow><m:mi>z</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>z</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>,</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>)</m:mo><m:mn>.</m:mn></m:mrow></m:mrow><m:mspace width="3em"/><m:mo>(2.8)</m:mo></m:math>
</div>
</section>
<section>
<h3 id="sec2_4_5"><a id="index_term259"/><span class="green">2.4.5 Orthonormal Bases and Coordinate Frames</span></h3>
<p>Managing coordinate systems is one of the core tasks of almost any graphics program; the key to this is managing <em>orthonormal bases</em>. Any set of two 2D vectors <strong>u</strong> and <strong>v</strong> form an <a id="index_term815"/>orthonormal basis provided that they are orthogonal (at right angles) and are each of unit length. Thus,</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mrow><m:mo>‖</m:mo><m:mtext>u</m:mtext><m:mo>‖</m:mo><m:mo>=</m:mo></m:mrow><m:mo>‖</m:mo><m:mtext>v</m:mtext><m:mo>‖</m:mo><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>,</m:mo></m:mrow></m:math>
</div>
<p>and</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext>u</m:mtext><m:mo>·</m:mo><m:mtext>v</m:mtext><m:mo>=</m:mo><m:mn>0.</m:mn></m:mrow></m:math>
</div>
<p>In 3D, three vectors <strong>u</strong>, <strong>v</strong>,and <strong>w</strong> form an orthonormal basis if</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mrow><m:mo>‖</m:mo><m:mtext>u</m:mtext><m:mo>‖</m:mo></m:mrow><m:mo>=</m:mo><m:mrow><m:mo>‖</m:mo><m:mtext>v</m:mtext><m:mo>‖</m:mo><m:mo>=</m:mo><m:mrow><m:mo>‖</m:mo><m:mtext>w</m:mtext><m:mo>‖</m:mo><m:mo>=</m:mo></m:mrow><m:mn>1</m:mn><m:mo>,</m:mo></m:mrow></m:mrow></m:math>
</div>
<p><span aria-label="27" epub:type="pagebreak" id="pg_27" role="doc-pagebreak"/>and</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext>u</m:mtext><m:mo>·</m:mo><m:mtext>v</m:mtext><m:mo>=</m:mo><m:mtext>v</m:mtext><m:mo>·</m:mo><m:mtext>w</m:mtext><m:mo>=</m:mo><m:mtext>w</m:mtext><m:mo>·</m:mo><m:mtext>u</m:mtext><m:mo>=</m:mo><m:mn>0.</m:mn></m:mrow></m:math>
</div>
<p>This orthonormal basis is <em>right-handed</em> provided</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext>w</m:mtext><m:mo>=</m:mo><m:mtext>u </m:mtext><m:mo>×</m:mo><m:mtext>v,</m:mtext></m:mrow></m:math>
</div>
<p class="noindent">and otherwise, it is left-handed.</p>
<p>Note that the Cartesian canonical orthonormal basis is just one of infinitely many possible orthonormal bases. What makes it special is that it and its implicit origin location are used for low-level representation within a program. Thus, the vectors <strong>x</strong>, <strong>y</strong>, and <strong>z</strong> are never explicitly stored and neither is the canonical origin location <strong>o</strong>. The global model is typically stored in this canonical coordinate system, and it is thus often called the <em>global coordinate system</em>. However, if we want to use another coordinate system with origin <strong>p</strong> and orthonormal basis vectors <strong>u</strong>, <strong>v</strong>, and <strong>w</strong>, then we <em>do</em> store those vectors explicitly. Such a system is called a <em><a id="index_term376"/>frame of reference</em> or <em>coordinate frame</em>. For example, in a flight simulator, we might want to maintain a coordinate system with the origin at the nose of the plane, and the orthonormal basis aligned with the airplane. Simultaneously, we would have the master canonical coordinate system (<a href="C07_chapter2.xhtml#f2_21">Figure 2.21</a>). The coordinate system associated with a particular object, such as the plane, is usually called a <em><a id="index_term701"/>local coordinate system</em>.</p>
<p>At a low level, the local frame is stored in canonical coordinates. For example, if <strong>u</strong> has coordinates (<em>x<sub>u</sub>,y<sub>u</sub>,z<sub>u</sub></em>) ,</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext>u</m:mtext><m:mo>=</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>u</m:mi></m:mrow></m:msub><m:mtext>x</m:mtext><m:mo>+</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mstyle><m:mrow><m:mi>u</m:mi></m:mrow></m:mstyle></m:mrow></m:msub><m:mtext>y</m:mtext><m:mo>+</m:mo><m:msub><m:mrow><m:mi>z</m:mi></m:mrow><m:mrow><m:mi>u</m:mi><m:mtext> </m:mtext></m:mrow></m:msub><m:mtext>z.</m:mtext></m:mrow></m:math>
</div>
<p>A location implicitly includes an offset from the canonical origin:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext>p</m:mtext><m:mo>=</m:mo><m:mtext>o</m:mtext><m:mo>+</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>p</m:mi></m:mrow></m:msub><m:mtext>x</m:mtext><m:mo>+</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mtext>p</m:mtext></m:mrow></m:msub><m:mtext>y</m:mtext><m:mo>+</m:mo><m:msub><m:mrow><m:mi>z</m:mi></m:mrow><m:mrow><m:mtext>p</m:mtext></m:mrow></m:msub><m:mtext>z,</m:mtext></m:mrow></m:math>
</div>
<p>where (<em>x<sub>p</sub>,y<sub>p</sub>,z<sub>p</sub></em>) are the coordinates of <strong>p</strong>.</p>
<p>Note that if we store a vector <strong>a</strong> with respect to the <strong>u</strong>-<strong>v</strong>-<strong>w</strong> frame, we store a triple (<em>u<sub>a</sub>,v<sub>a</sub>,w<sub>a</sub></em>) which we can interpret geometrically as</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext>a</m:mtext><m:mo>=</m:mo><m:msub><m:mrow><m:mi>u</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mtext>u</m:mtext><m:mo>+</m:mo><m:msub><m:mrow><m:mi>v</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mtext>v</m:mtext><m:mo>+</m:mo><m:msub><m:mrow><m:mi>w</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mtext>w.</m:mtext></m:mrow></m:math>
</div>
<p>To get the canonical coordinates of a vector <strong>a</strong> stored in the <strong>u</strong>-<strong>v</strong>-<strong>w</strong> coordinate system, simply recall that <strong>u</strong>, <strong>v</strong>,and <strong>w</strong> are themselves stored in terms of Cartesian coordinates, so the expression <em>u<sub>a</sub></em><strong>u</strong> + <em>v<sub>a</sub></em><strong>v</strong> + <em>w<sub>a</sub></em><strong>w</strong> is already in Cartesian coordinates if evaluated explicitly. To get the <strong>u</strong>-<strong>v</strong>-<strong>w</strong> coordinates of a vector <strong>b</strong> stored in the canonical <a id="index_term261"/>coordinate system, we can use dot products:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi>u</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>=</m:mo><m:mtext>u</m:mtext><m:mo>·</m:mo><m:mtext> </m:mtext><m:mtext>b</m:mtext><m:mo>;</m:mo></m:mtd><m:mtd><m:msub><m:mrow><m:mi>v</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub></m:mtd></m:mtr></m:mtable><m:mo>=</m:mo><m:mtext>v</m:mtext><m:mo>·</m:mo><m:mtext> </m:mtext><m:mtext>b</m:mtext><m:mo>;</m:mo><m:msub><m:mrow><m:mi>w</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>=</m:mo><m:mtext>w</m:mtext><m:mo>·</m:mo><m:mtext> </m:mtext><m:mtext>b.</m:mtext></m:mrow></m:math>
</div>
<figure id="f2_21" tabindex="0">
<img alt="" src="../images/fig2_21.jpg"/>
<figcaption><p><span class="blue">Figure 2.21.</span> <span aria-label="28" epub:type="pagebreak" id="pg_28" role="doc-pagebreak"/>There is always a master or “canonical” coordinate system with origin <strong>o</strong> and orthonormal basis <strong>x</strong>, <strong>y</strong>, and <strong>z</strong>. This coordinate system is usually defined to be aligned to the global model and is thus often called the “global” or “world” coordinate system. This origin and basis vectors are never stored explicitly. All other vectors and locations are stored with coordinates that relate them to the global frame. The coordinate system associated with the plane is explicitly stored in terms of global coordinates.</p></figcaption>
</figure>
<p class="noindent">This works because we know that for <em>some</em> <em>u<sub>b</sub></em>, <em>v<sub>b</sub></em>,and <em>w<sub>b</sub></em>,</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:msub><m:mrow><m:mi>u</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mtext>u</m:mtext><m:mo>+</m:mo><m:msub><m:mrow><m:mi>v</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mtext>v</m:mtext><m:mo>+</m:mo><m:msub><m:mrow><m:mi>w</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mtext>w</m:mtext><m:mo>=</m:mo><m:mtext>b,</m:mtext></m:mrow></m:math>
</div>
<p>and the dot product isolates the <em>u<sub>b</sub></em> coordinate:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mtext>u</m:mtext><m:mo>·</m:mo><m:mtext>b</m:mtext><m:mo>=</m:mo><m:msub><m:mrow><m:mi>u</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mtext>u</m:mtext><m:mo>·</m:mo><m:mtext>u</m:mtext><m:mo>)</m:mo></m:mrow><m:mo>+</m:mo><m:msub><m:mrow><m:mi>v</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>(</m:mo><m:mtext>u</m:mtext><m:mo>·</m:mo><m:mtext>v</m:mtext><m:mo>)</m:mo><m:mo>+</m:mo><m:msub><m:mrow><m:mi>w</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>(</m:mo><m:mtext>u</m:mtext><m:mo>·</m:mo><m:mtext>w</m:mtext><m:mo>)</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mo>=</m:mo><m:msub><m:mrow><m:mi>u</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mn>.</m:mn></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>This works because <strong>u</strong>, <strong>v</strong>,and <strong>w</strong> are orthonormal.</p>
<p>Using matrices to manage changes of coordinate systems is discussed in <a href="C12_chapter7.xhtml#sec7_2_1">Sections 7.2.1</a> and <a href="C12_chapter7.xhtml#sec7_5">7.5</a>.</p>
</section>
<section>
<h3 id="sec2_4_6"><span class="green">2.4.6 Constructing a Basis from a Single Vector</span></h3>
<p>Often we need an orthonormal basis that is aligned with a given vector. That is, given a vector <strong>a</strong>, we want an orthonormal <strong>u</strong>, <strong>v</strong>, and <strong>w</strong> such that <strong>w</strong> points in the <span aria-label="29" epub:type="pagebreak" id="pg_29" role="doc-pagebreak"/>same direction as <strong>a</strong> (Hughes &amp; Möller, 1999), but we don’t particularly care what <strong>u</strong> and <strong>v</strong> are. One vector isn’t enough to uniquely determine the answer; we just need a robust procedure that will find any one of the possible bases.</p>
<p>This can be done using cross products as follows. First, make <strong>w</strong> a unit vector in the direction of <strong>a</strong>:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext>w</m:mtext><m:mo>=</m:mo><m:mfrac><m:mrow><m:mtext>a</m:mtext></m:mrow><m:mrow><m:mrow><m:mo>‖</m:mo><m:mtext>a</m:mtext><m:mo>‖</m:mo></m:mrow></m:mrow></m:mfrac><m:mn>.</m:mn></m:mrow></m:math>
</div>
<p>Then, choose any vector <strong>t</strong> not collinear with <strong>w</strong>, and use the cross product to build a unit vector <strong>u</strong> perpendicular to <strong>w</strong>:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext>u</m:mtext><m:mo>=</m:mo><m:mfrac><m:mrow><m:mtext>t</m:mtext><m:mo>×</m:mo><m:mtext>w</m:mtext></m:mrow><m:mrow><m:mrow><m:mo>‖</m:mo><m:mtext>t</m:mtext><m:mo>×</m:mo><m:mtext>w</m:mtext><m:mo>‖</m:mo></m:mrow></m:mrow></m:mfrac><m:mn>.</m:mn></m:mrow></m:math>
</div>
<aside class="boxed-text" epub:type="sidebar">
<p class="noindent">This same procedure can, of course, be used to construct the three vectors in any order; just pay attention to the order of the cross products to ensure the basis is right-handed.</p>
</aside>
<p class="noindent">If <strong>t</strong> is collinear with <strong>w</strong>, the denominator will vanish, and if they are nearly collinear, the results will have low precision. A simple procedure to find a vector sufficiently different from <strong>w</strong> is to start with <strong>t</strong> equal to <strong>w</strong> and change the smallest magnitude component of <strong>t</strong> to 1. For example, if <span class="inline-formula"><m:math alttext=""><m:mrow><m:mtext>w=</m:mtext><m:mrow><m:mo>(</m:mo><m:mn>1</m:mn><m:mo>/</m:mo><m:msqrt><m:mrow><m:mn>2</m:mn></m:mrow></m:msqrt><m:mo>,</m:mo><m:mo>−</m:mo><m:mn>1</m:mn><m:mo>/</m:mo><m:msqrt><m:mrow><m:mn>2</m:mn></m:mrow></m:msqrt><m:mo>,</m:mo><m:mn>0</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:math></span> then <span class="inline-formula"><m:math alttext=""><m:mrow><m:mtext>t</m:mtext><m:mo>=</m:mo><m:mrow><m:mo>(</m:mo><m:mn>1</m:mn><m:mo>/</m:mo><m:msqrt><m:mrow><m:mn>2</m:mn></m:mrow></m:msqrt><m:mo>,</m:mo><m:mo>−</m:mo><m:mn>1</m:mn><m:mo>/</m:mo><m:msqrt><m:mrow><m:mn>2</m:mn></m:mrow></m:msqrt><m:mo>,</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:math></span>. Once <strong>w</strong> and <strong>u</strong> are in hand, completing the basis is simple:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext>v</m:mtext><m:mo>=</m:mo><m:mtext>w</m:mtext><m:mo>×</m:mo><m:mtext>u.</m:mtext></m:mrow></m:math>
</div>
<p>An example of a situation where this construction is used is surface shading, where a basis aligned to the surface normal is needed but the rotation around the normal is often unimportant.</p>
<p>For serious production code, recently researchers at Pixar have developed a rather remarkable method for constructing a vector from two vectors that is impressive in its compactness and efficiency (Duff et al., 2017). They provide battle-tested code, and readers are encouraged to use it as there are not “gotchas” that have emerged as it used throughout the industry.</p>
</section>
<section>
<h3 id="sec2_4_7"><span class="green">2.4.7 Constructing a Basis from Two Vectors</span></h3>
<p>The procedure in the previous section can also be used in situations where the rotation of the basis around the given vector is important. A common example is building a basis for a camera: it’s important to have one vector aligned in the direction the camera is looking, but the orientation of the camera around that vector is <em>not</em> arbitrary, and it needs to be specified somehow. Once the orientation is pinned down, the basis is completely determined.</p>
<p>A common way to fully specify a frame is by providing two vectors <strong>a</strong> (which specifies <strong>w</strong>) and <strong>b</strong> (which specifies <strong>v</strong>). If the two vectors are known to be perpendicular, it is a simple matter to construct the third vector by <strong>u</strong> = <strong>b</strong> × <strong>a</strong>.</p>
<aside class="boxed-text" epub:type="sidebar">
<p class="noindent"><strong>u</strong> = <strong>a</strong> × <strong>b</strong> also produces an orthonormal basis, but it is left-handed.</p>
</aside>
<p class="indent"><span aria-label="30" epub:type="pagebreak" id="pg_30" role="doc-pagebreak"/>To be sure that the resulting basis really is orthonormal, even if the input vectors weren’t quite, a procedure much like the single-vector procedure is advisable:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable columnalign="left"><m:mtr><m:mtd><m:mtext>w</m:mtext></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mfrac><m:mrow><m:mrow><m:mtext>a</m:mtext></m:mrow></m:mrow><m:mrow><m:mrow><m:mo>‖</m:mo><m:mtext>a</m:mtext><m:mo>‖</m:mo></m:mrow></m:mrow></m:mfrac><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext>u</m:mtext></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mfrac><m:mrow><m:mtext>b</m:mtext><m:mo>×</m:mo><m:mtext>w</m:mtext></m:mrow><m:mrow><m:mrow><m:mo>‖</m:mo><m:mtext>b</m:mtext><m:mo>×</m:mo><m:mtext>w</m:mtext><m:mo>‖</m:mo></m:mrow></m:mrow></m:mfrac><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext>v</m:mtext></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mtext>w</m:mtext><m:mo>×</m:mo><m:mtext>u.</m:mtext></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>In fact, this procedure works just fine when <strong>a</strong> and <strong>b</strong> are not perpendicular. In this case, <strong>w</strong> will be constructed exactly in the direction of <strong>a</strong>,and <strong>v</strong> is chosen to be the closest vector to <strong>b</strong> among all vectors perpendicular to <strong>w</strong>.</p>
<aside class="boxed-text" epub:type="sidebar">
<p class="noindent">If you want me to set <strong>w</strong> and <strong>v</strong> to two non-perpendicular directions, something has to give—with this scheme, I’ll set everything the way you want, except I’ll make the smallest change to <strong>v</strong> so that it is in fact perpendicular to <strong>w</strong>.</p>
</aside>
<p class="indent">This procedure <em>won’t</em> work if <strong>a</strong> and <strong>b</strong> are collinear. In this case, <strong>b</strong> is of no help in choosing which of the directions perpendicular to <strong>a</strong> we should use: it is perpendicular to all of them.</p>
<aside class="boxed-text" epub:type="sidebar">
<p class="noindent">What will go wrong with the computation if <strong>a</strong> and <strong>b</strong> are parallel?</p>
</aside>
<p class="indent">In the example of specifying camera positions (<a href="C09_chapter4.xhtml#sec4_3">Section 4.3</a>), we want to construct a frame that has <strong>w</strong> parallel to the direction the camera is looking, and <strong>v</strong> should point out the top of the camera. To orient the camera upright, we build the basis around the view direction, using the straight-up direction as the reference vector to establish the camera’s orientation around the view direction. Setting <strong>v</strong> as close as possible to straight up exactly matches the intuitive notion of “holding the camera straight.”</p>
</section>
<section>
<h3 id="sec2_4_8"><span class="green">2.4.8 Squaring Up a Basis</span></h3>
<p>Occasionally, you may find problems caused in your computations by a basis that is supposed to be orthonormal but where error has crept in—due to rounding error in computation, or to the basis having been stored in a file with low precision, for instance.</p>
<p>The procedure of the previous section can be used; simply constructing the basis anew using the existing <strong>w</strong> and <strong>v</strong> vectors will produce a new basis that is orthonormal and is close to the old one.</p>
<p>This approach is good for many applications, but it is not the best available. It does produce accurately orthogonal vectors, and for nearly orthogonal starting bases, the result will not stray far from the starting point. However, it is asymmetric: it “favors” <strong>w</strong> over <strong>v</strong> and <strong>v</strong> over <strong>u</strong> (whose starting value is thrown away). It chooses a basis close to the starting basis but has no guarantee of choosing <em>the</em> closest orthonormal basis. When this is not good enough, the SVD (<a href="C11_chapter6.xhtml#sec6_4_1">Section 6.4.1</a>) can be used to compute an orthonormal basis that <em>is</em> guaranteed to be closest to the original basis.</p>
</section>
</section>
<section>
<h2 id="sec2_5"><a id="index_term626"/><span aria-label="31" epub:type="pagebreak" id="pg_31" role="doc-pagebreak"/><a epub:type="backlink" href="C02a_toc.xhtml#rsec2_5" role="doc-backlink"><span class="green">2.5 Integration</span></a></h2>
<p>A possibly misleading thing about graphics is that it is full of integrals and thus one might think one has to be good at algebraically solving integrals. This is most definitely not the case. Most of the integrals in graphics are not analytically solvable and are thus solved numerically. It is quite possible to have a great career in graphics and never algebraically solve a single integral.</p>
<p>While you do not need to be able to algebraically solve integrals, you do need to be able to read them so you can numerically solve them. In one dimension, integrals are usually pretty readable. For example, this integral</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:msubsup><m:mrow><m:mo>∫</m:mo></m:mrow><m:mrow><m:mi>π</m:mi></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow></m:msubsup><m:mtext>sin</m:mtext><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo><m:mi>d</m:mi><m:mi>x</m:mi></m:mrow></m:mrow></m:math>
</div>
<p>can be read as “compute the area of the function sin (<em>x</em>) between <em>x</em> = <em>π</em> and <em>x</em> = 2<em>π</em>.” A computer scientist might view this part:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:msubsup><m:mrow><m:mo>∫</m:mo></m:mrow><m:mrow><m:mi>π</m:mi></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow></m:msubsup><m:mi>d</m:mi><m:mi>x</m:mi></m:mrow></m:math>
</div>
<p>as a function call. We might call it “integrate().” It takes two objects: a function and a domain (interval). So the whole call might be</p>
<pre class="pre">float area = integrate(sin(), [pi,2pi]).</pre>
<p class="noindent">In more advanced calculus, we might start taking integrals over spheres, and the neat thing for graphics is we can still think of things that way:</p>
<pre class="pre">float area = integrate(cos(), unit-sphere)</pre>
<p class="noindent">The machinery inside this function may be different, but all integrals have two things:</p>
<ol class="list-order">
<li>
<p class="list">The function being integrated</p>
</li>
<li>
<p class="list">The domain over which it is integrated.</p>
</li>
</ol>
<p>The trick, usually, is just carefully decoding what 1 and 2 are for a problem at hand. This is pretty similar in spirit to getting an API call right from sometimes confusing documentation.</p>
<section>
<h3 id="sec2_5_1"><a id="index_term63"/><a id="index_term1463"/><span class="green">2.5.1 Averages and weighted averages</span></h3>
<p>Integrals compute the total of things. Lengths, areas, volumes, etc. But they are often used to compute <em>averages</em>. For example, we can compute the total volume of a region by integrating the elevation over a region (like a country).<span aria-label="32" epub:type="pagebreak" id="pg_32" role="doc-pagebreak"/></p>
<pre class="pre">float volume = integrate(elevation(), country)</pre>
<p class="noindent">But we could also compute the average elevation:</p>
<pre class="pre">float averageElevation = integrate(elevation(),
      country) / integrate(1, country)</pre>
<p class="noindent">This is basically “divide the volume by the area.” This can be abstracted as</p>
<pre class="pre">Float averageElevation = average(elevation, country)</pre>
<p class="noindent">We can also take a <em>weighted average</em>. Here, we add a weighting function to emphasize some points in the average more than others. For example, if we want to emphasize a parts of the region by the temperature (this is pretty arbitrary, and we will see more graphics relevant examples in the next section):</p>
<pre class="pre">float weightedAverageElevation =<br/>      integrate(temperature()*elevation(),<br/>      country) / integrate(temperature(), country)</pre>
<p class="noindent">It’s a good idea to keep an eye out for this form; often integrals contain a weighted average without explicitly pointing that out and it can sometimes help intuition.</p>
</section>
<section>
<h3 id="sec2_5_2"><a id="index_term1099"/><span class="green">2.5.2 Integrals over solid angle</span></h3>
<p class="noindent">One example of a type of integral we see a lot is one of these forms or something related:</p>
<pre class="pre">float shade = integrate(cos()*f*(),<br/>   unit-hemisphere)</pre>
<p class="noindent">Note that since <span class="monospace">integrate(cos(), unit-hemisphere) = pi</span>, the weighted average version is just</p>
<pre class="pre">float shade = integrate((1/pi)*cos()*f*(),<br/>       unit-hemisphere)</pre>
<p class="noindent">The more traditional form of this integral is</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mi>S</m:mi><m:mo>=</m:mo><m:msub><m:mrow><m:mo>∫</m:mo></m:mrow><m:mrow><m:mi>v</m:mi><m:mo>∈</m:mo><m:mi>H</m:mi></m:mrow></m:msub><m:mfrac><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mi>π</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mi>v</m:mi><m:mo>·</m:mo><m:mi>n</m:mi><m:mo>)</m:mo><m:mi>f</m:mi><m:mrow><m:mo>(</m:mo><m:mi>v</m:mi><m:mo>)</m:mo><m:mrow><m:mo>(</m:mo><m:mi>v</m:mi><m:mo>·</m:mo><m:mi>n</m:mi><m:mo>)</m:mo><m:mi>d</m:mi><m:mi>σ</m:mi><m:mrow><m:mo>(</m:mo><m:mi>v</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mrow></m:mrow></m:mrow></m:math>
</div>
<p>Or with spherical coordinates as we might use to solve such integrals algebraically:</p>
<div class="disp-formula">
<m:math xmlns:mml="http://www.w3.org/1998/Math/MathML" alttext=""><m:mrow><m:mi>S</m:mi><m:mo>=</m:mo><m:msubsup><m:mrow><m:mo>∫</m:mo></m:mrow><m:mrow><m:mi>ϕ</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow></m:msubsup><m:msubsup><m:mrow><m:mo>∫</m:mo></m:mrow><m:mrow><m:mi>θ</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mi>π</m:mi></m:mrow></m:msubsup><m:mfrac><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mi>π</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mi>v</m:mi><m:mo>·</m:mo><m:mi>n</m:mi><m:mo>)</m:mo><m:mi>f</m:mi><m:mrow><m:mo>(</m:mo><m:mi>θ</m:mi><m:mo>,</m:mo><m:mi>ϕ</m:mi><m:mo>)</m:mo><m:mtext>cos</m:mtext><m:mi>θ</m:mi><m:mtext>sin</m:mtext><m:mi>θ</m:mi><m:mi>d</m:mi><m:mi>θ</m:mi><m:mi>d</m:mi><m:mi>ϕ</m:mi></m:mrow></m:mrow></m:mrow></m:math>
</div>
<p><span aria-label="33" epub:type="pagebreak" id="pg_33" role="doc-pagebreak"/>The <a id="index_term1087"/>sine term if an area-correction factor for spherical coordinates. Note that in graphics, we will rarely need to write that all out and will use simpler forms without explicit coordinates as we numerically solve the integrals</p>
<p>The particular integral above is the shade of a perfectly reflective matte (dif-fuse) surface, and it is also a weighted average of all incident colors. This structure can be great for intuition; the color of a surface is usually related to a weighted average of incident colors.</p>
<p>The integrals over solid angle are almost always the same but use a wide variety of notations. Key is to recognize this is just notations and map the notations you see to one you are most comfortable with. This is much like reading pseudocode!</p>
</section>
</section>
<section>
<h2 id="sec2_6"><a id="index_term317"/><a epub:type="backlink" href="C02a_toc.xhtml#rsec2_6" role="doc-backlink"><span class="green">2.6 Density Functions</span></a></h2>
<p>Density functions come up all the time in graphics (e.g., “<a id="index_term900"/>probability density functions”) and they can be surprisingly confusing at times, but getting a handle on what precisely they are will help us use them and navigate out of confusion when it strikes us. We know what a function is, and a density function is just one that returns a density. So what is a density? Density is something that is a “per unit something,” or more formally an <em>intensive</em> quantity. For example, your weight is not a density, it is an <em>extensive</em> quantity, or just an amount of stuff, not an amount of stuff per unit something. The amount of weight a person might gain in a set period of time, say a year, is an amount of stuff, is measured in kilograms, and is thus an extensive quantity and not a density. The amount of weight the person was gaining “per day” or “per hour” is an intensive quantity, so is a density.</p>
<p>As an example of a non-density function, consider the amount of energy that is produced by a solar panel on a given day, July 1, 2014, and let’s say it is 120 kilojoules. That is an amount of “stuff.” Well that is fine, but is it enough to run my computer? My computer, if a desktop, needs a density of energy, or rate of energy, to keep working. So how do we take that day of energy and convert it into a rate of energy. We could divide it into segments of time. For example, we could do four-hour blocks, two-hour blocks, or one-hour blocks, and we would see that the rate changes during the day, but also that the amounts keep getting shorter as shown in <a href="C07_chapter2.xhtml#f2_22">Figure 2.22</a>.</p>
<figure id="f2_22" tabindex="0">
<img alt="" src="../images/fig2_22.jpg"/>
<figcaption><p><span class="blue">Figure 2.22.</span> As the histogram of how much energy is produced in set time interval lowers the time intervals, the heights of the boxes go down (with zero height in the limit case as the width goes to zero).</p></figcaption>
</figure>
<p>As we divide time finer and finer, we would eventually get down to minutes and seconds and we would get more information about time variation, but the box heights would get so small that we wouldn’t see anything. So what we could do is re-scale the height of their boxes based on their widths, so (30kJ)/(0.5 h) = 60 kJ/h. <span aria-label="34" epub:type="pagebreak" id="pg_34" role="doc-pagebreak"/>If we use this new “KJ per hour” measure, the boxes no longer get shorter, as shown in <a href="C07_chapter2.xhtml#f2_23">Figure 2.23</a>. If we take this process to the limit where the width of the box becomes infinitesimal, we get a smooth curve.</p>
<p>This curve is an example of a density function. It would be called by some an “energy density” function where the dimension the density is taken over is time, and some contexts would be called a “temporal energy density” function. Because this particular density is so useful and commonly talked about, it gets its own name, <em>power</em>, and instead of saying “joules per hour,” we say <em>Watts</em>. Note that “Watts” is joules per second rather than per hour by convention; the specific units rather than dimension are chosen for convenience. For example, some physical units make more sense with meters, some with kilometers, and some with nanometers (and a few like spectral radiance for light use both meters and nanometers in the same quantity, so when you find yourself confused, it is not your fault).</p>
<p>Putting this all together, (1) a density is always some kind of ratio where you say “so many X per unit Y” or “so many X per Y” like “so many kilometers per hour” (saying “so many kilometers per unit length” would be odd, but makes sense if everybody agrees what the unit of length is by default), and (2) a density function is a function that returns a density.</p>
<figure id="f2_23" tabindex="0">
<img alt="" src="../images/fig2_23.jpg"/>
<figcaption><p><span class="blue">Figure 2.23.</span> If we divide the energy by the width of the box, it gets more detailed as we divide further.</p></figcaption>
</figure>
<p>Density functions by themselves are useful for comparing relative concentrations at two different points. For example, with our energy density function defined over time (power), we can say “there is twice as much power at 2 pm as at 9 am” for example. But another way we can use them is to compute total quantity in a region. For example, to compute how much energy is produced between 2 pm and 4 pm, we just integrate:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mi>E</m:mi><m:mo>=</m:mo><m:msubsup><m:mrow><m:mo>∫</m:mo></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>p</m:mi><m:mi>m</m:mi></m:mrow><m:mrow><m:mn>4</m:mn><m:mi>p</m:mi><m:mi>m</m:mi></m:mrow></m:msubsup><m:mtext> </m:mtext><m:mi>P</m:mi><m:mrow><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo><m:mi>d</m:mi><m:mi>t</m:mi></m:mrow></m:mrow></m:math>
</div>
<p>Many integrals are this sort of “integrate a density function” but that is not spelled out. It can sometimes make things more clear if you tease out whether an integral is processing the “mass” of a density function in some interval or region.</p>
</section>
<section>
<h2 id="sec2_7"><a id="index_term1138"/><a epub:type="backlink" href="C02a_toc.xhtml#rsec2_7" role="doc-backlink"><span class="green">2.7 Curves and Surfaces</span></a></h2>
<p>The geometry of curves, and especially surfaces, plays a central role in graphics, and here, we review the basics of curves and surfaces in 2D and 3D space.</p>
<section>
<h3 id="sec2_7_1"><a id="index_term1291"/><a id="index_term567"/><a id="term-418"/><a id="term-420"/><span aria-label="35" epub:type="pagebreak" id="pg_35" role="doc-pagebreak"/><span class="green">2.7.1 2D Implicit Curves</span></h3>
<p>Intuitively, a <em>curve</em> is a set of points that can be drawn on a piece of paper without lifting the pen. A common way to describe a curve is using an <em>implicit equation</em>. An implicit equation in two dimensions has the form</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mi>f</m:mi><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>,</m:mo><m:mi>y</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mn>0.</m:mn></m:mrow></m:math>
</div>
<p>The function <em>f</em> (<em>x, y</em>) returns a real value. Points (<em>x, y</em>) where this value is zero are on the curve, and points where the value is nonzero are not on the curve. For example, let’s say that <em>f</em> (<em>x, y</em>) is</p>
<div class="disp-formula" id="equ2_9">
<m:math alttext=""><m:mrow><m:mi>f</m:mi><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>,</m:mo><m:mi>y</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:msup><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mo>)</m:mo></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>+</m:mo><m:msup><m:mrow><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>−</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mo>)</m:mo></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>−</m:mo><m:msup><m:mrow><m:mi>r</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>,</m:mo></m:mrow></m:mrow><m:mspace width="3em"/><m:mo>(2.9)</m:mo></m:math>
</div>
<p>where (<em>x<sub>c</sub>,y<sub>c</sub></em>) is a 2D point and <em>r</em> is a nonzero real number. If we take <em>f</em> (<em>x, y</em>) = 0, the points where this equality holds are on the <a id="index_term145"/>circle with center (<em>x<sub>c</sub>,y<sub>c</sub></em>) and radius <em>r</em>. The reason that this is called an “implicit” equation is that the points (<em>x, y</em>) on the curve cannot be immediately calculated from the equation and instead must be determined by solving the equation. Thus, the points on the curve are not generated by the equation <em>explicitly</em>, but they are buried somewhere <em>implicitly</em> in the equation.</p>
<p>It is interesting to note that <em>f</em> does have values for all (<em>x, y</em>) . We can think of <em>f</em> as a terrain, with sea level at <em>f</em> = 0 (<a href="C07_chapter2.xhtml#f2_24">Figure 2.24</a>). The shore is the implicit curve. The value of <em>f</em> is the altitude. Another thing to note is that the curve partitions space into regions where <em>f &gt;</em> 0, <em>f &lt;</em> 0, and <em>f</em> = 0. So you evaluate <em>f</em> to decide whether a point is “inside” a curve. Note that <em>f</em> (<em>x, y</em>) = <em>c</em> is a curve for any constant <em>c</em>,and <em>c</em> = 0 is just used as a convention. For example, if <em>f</em> (<em>x, y</em>) = <em>x</em><sup>2</sup> + <em>y</em><sup>2</sup> <em>–</em> 1, varying <em>c</em> just gives a variety of circles centered at the origin (<a href="C07_chapter2.xhtml#f2_25">Figure 2.25</a>).</p>
<p>We can compress our notation using vectors. If we have <strong>c</strong> = (<em>x<sub>c</sub>,y<sub>c</sub></em>) and <strong>p</strong> = (<em>x, y</em>) , then our circle with center <strong>c</strong> and <a id="index_term929"/>radius <em>r</em> is defined by those position vectors that satisfy</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mrow><m:mo>(</m:mo><m:mtext>p</m:mtext><m:mo>−</m:mo><m:mtext>c</m:mtext><m:mo>)</m:mo><m:mo>·</m:mo><m:mrow><m:mo>(</m:mo><m:mtext>p</m:mtext><m:mo>−</m:mo><m:mtext>c</m:mtext><m:mo>)</m:mo><m:mo>−</m:mo><m:msup><m:mrow><m:mi>r</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>=</m:mo><m:mn>0.</m:mn></m:mrow></m:mrow></m:mrow></m:math>
</div>
<p>This equation, if expanded algebraically, will yield Equation (2.9), but it is easier to see that this is an equation for a circle by “reading” the equation geometrically. It reads, “points <strong>p</strong> on the circle have the following property: the vector from <strong>c</strong> to <strong>p</strong> when dotted with itself has value <em>r</em><sup>2</sup>.” Because a vector dotted with itself is just its own length squared, we could also read the equation as, “points <strong>p</strong> on the circle have the following property: the vector from <strong>c</strong> to <strong>p</strong> has squared length <em>r</em><sup>2</sup>.”</p>
<figure id="f2_24" tabindex="0">
<img alt="" src="../images/fig2_24.jpg"/>
<figcaption><p><span class="blue">Figure 2.24.</span> An <a id="index_term569"/>implicit function <em>f(x,y)</em> = 0 can be thought of as a height field where f is the height (top). A path where the height is zero is the implicit curve (bottom).</p></figcaption>
</figure>
<figure id="f2_25" tabindex="0">
<img alt="" src="../images/fig2_25.jpg"/>
<figcaption><p><span class="blue">Figure 2.25.</span> An implicit function defines a curve for any constant value, with zero being the usual convention.</p></figcaption>
</figure>
<p>Even better, is to observe that the squared length is just the squared distance from <strong>c</strong> to <strong>p</strong>, which suggests the equivalent form</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:msup><m:mrow><m:mo>‖</m:mo><m:mtext>p</m:mtext><m:mo>−</m:mo><m:mtext>c</m:mtext><m:mo>‖</m:mo></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>−</m:mo><m:msup><m:mrow><m:mi>r</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>=</m:mo><m:mn>0</m:mn><m:mo>,</m:mo></m:mrow></m:math>
</div>
<p><a id="term-245"/><a id="term-348"/><a id="term-349"/><a id="term-805"/><a id="term-841"/><a id="term-842"/><a id="term-843"/><a id="term-982"/><span aria-label="36" epub:type="pagebreak" id="pg_36" role="doc-pagebreak"/>and, of course, this suggests</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mrow><m:mo>‖</m:mo><m:mtext>p</m:mtext><m:mo>−</m:mo><m:mtext>c</m:mtext><m:mo>‖</m:mo></m:mrow><m:mo>−</m:mo><m:mi>r</m:mi><m:mo>=</m:mo><m:mn>0.</m:mn></m:mrow></m:math>
</div>
<p>The above could be read “the points <strong>p</strong> on the circle are those a distance <em>r</em> from the center point <strong>c</strong>,” which is as good a definition of circle as any. This illustrates that the vector form of an equation often suggests more geometry and intuition than the equivalent full-blown Cartesian form with <em>x</em> and <em>y</em>. For this reason, it is usually advisable to use vector forms when possible. In addition, you can support a vector class in your code; the code is cleaner when vector forms are used. The vector-oriented equations are also less error prone in implementation: once you implement and debug vector types in your code, the cut-and-paste errors involving <em>x</em>, <em>y</em>,and <em>z</em> will go away. It takes a little while to get used to vectors in these equations, but once you get the hang of it, the payoff is large.</p>
</section>
<section>
<h3 id="sec2_7_2"><a id="index_term449"/><span class="green">2.7.2 The 2D Gradient</span></h3>
<p>If we think of the function <em>f</em> (<em>x, y</em>) as a height field with height = <em>f</em> (<em>x, y</em>) , the <em>gradient</em> vector points in the direction of maximum upslope, i.e., straight uphill. The gradient vector ∇<em>f</em>(<em>x, y</em>) is given by</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mi>$</m:mi><m:mi>∇</m:mi><m:mi>f</m:mi><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>,</m:mo><m:mi>y</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mrow><m:mo>(</m:mo><m:mfrac><m:mrow><m:mo>∂</m:mo><m:mi>f</m:mi></m:mrow><m:mrow><m:mo>∂</m:mo><m:mi>x</m:mi></m:mrow></m:mfrac><m:mo>,</m:mo><m:mfrac><m:mrow><m:mo>∂</m:mo><m:mi>f</m:mi></m:mrow><m:mrow><m:mo>∂</m:mo><m:mi>y</m:mi></m:mrow></m:mfrac><m:mo>)</m:mo><m:mn>.</m:mn></m:mrow></m:mrow></m:math>
</div>
<p>The gradient vector evaluated at a point on the implicit curve <em>f</em> (<em>x, y</em>) = 0 is perpendicular to the <em>tangent</em> vector of the curve at that point. This perpendicular vector is usually called the <em><a id="index_term784"/>normal vector</em> to the curve. In addition, since the gradient points uphill, it indicates the direction of the <em>f</em> (<em>x, y</em>) <em>&gt;</em> 0 region.</p>
<figure id="f2_26" tabindex="0">
<img alt="" src="../images/fig2_26.jpg"/>
<figcaption><p><span class="blue">Figure 2.26.</span> A surface height = <em>f</em> (<em>x,y</em>) is locally planar near (<em>x,y</em>) = (<em>a,b</em>). The gradient is a projection of the uphill direction onto the height = 0 plane.</p></figcaption>
</figure>
<p>In the context of height fields, the geometric meaning of partial derivatives and gradients is more visible than usual. Suppose that near the point (<em>a, b</em>) , <em>f</em> (<em>x, y</em>) is a plane (<a href="C07_chapter2.xhtml#f2_26">Figure 2.26</a>). There is a specific uphill and downhill direction. At right angles to this direction is a direction that is level with respect to the plane. Any intersection between the plane and the <em>f</em> (<em>x, y</em>) = 0 plane will be in the direction that is level. Thus, the uphill/downhill directions will be perpendicular to the line of intersection <em>f</em> (<em>x, y</em>) = 0. To see why the partial derivative has something to do with this, we need to visualize its geometric meaning. Recall that the conventional derivative of a 1D function <em>y</em> = <em>g</em>(<em>x</em>) is</p>
<div class="disp-formula" id="equ2_10">
<m:math alttext=""><m:mrow><m:mfrac><m:mrow><m:mi>d</m:mi><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>d</m:mi><m:mi>x</m:mi></m:mrow></m:mfrac><m:mo>≡</m:mo><m:munder><m:mrow><m:mtext>lim</m:mtext></m:mrow><m:mrow><m:mi mathvariant="normal">Δ</m:mi><m:mi>x</m:mi><m:mo>→</m:mo><m:mn>0</m:mn></m:mrow></m:munder><m:mfrac><m:mrow><m:mi mathvariant="normal">Δ</m:mi><m:mi>y</m:mi></m:mrow><m:mrow><m:mi mathvariant="normal">Δ</m:mi><m:mi>x</m:mi></m:mrow></m:mfrac><m:mo>=</m:mo><m:munder><m:mrow><m:mtext>lim</m:mtext></m:mrow><m:mrow><m:mi mathvariant="normal">Δ</m:mi><m:mi>x</m:mi><m:mo>→</m:mo><m:mn>0</m:mn></m:mrow></m:munder><m:mfrac><m:mrow><m:mi>g</m:mi><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">Δ</m:mi><m:mi>x</m:mi><m:mo>)</m:mo><m:mo>−</m:mo><m:mi>g</m:mi><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mrow><m:mrow><m:mi mathvariant="normal">Δ</m:mi><m:mi>x</m:mi></m:mrow></m:mfrac><m:mn>.</m:mn></m:mrow><m:mspace width="3em"/><m:mo>(2.10)</m:mo></m:math>
</div>
<p>This measures the <em>slope</em> of the <em>tangent</em> line to <em>g</em> (<a href="C07_chapter2.xhtml#f2_27">Figure 2.27</a>).</p>
<figure id="f2_27" tabindex="0">
<img alt="" src="../images/fig2_27.jpg"/>
<figcaption><p><span class="blue">Figure 2.27.</span> The derivative of a 1D function measures the <a id="index_term1095"/>slope of the line <a id="index_term1152"/>tangent to the curve.</p></figcaption>
</figure>
<p><a id="term-246"/><a id="term-350"/><a id="term-588"/><span aria-label="37" epub:type="pagebreak" id="pg_37" role="doc-pagebreak"/>The partial derivative is a generalization of the 1D derivative. For a 2D function <em>f</em> (<em>x, y</em>) , we can’t take the same limit for <em>x</em> as in Equation (2.10), because <em>f</em> can change in many ways for a given change in <em>x</em>. However, if we hold <em>y</em> constant, we can define an analog of the derivative, called the <em>partial derivative</em> (<a href="C07_chapter2.xhtml#f2_28">Figure 2.28</a>):</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mfrac><m:mrow><m:mo>∂</m:mo><m:mi>f</m:mi></m:mrow><m:mrow><m:mo>∂</m:mo><m:mi>x</m:mi></m:mrow></m:mfrac><m:mo>≡</m:mo><m:munder><m:mrow><m:mtext>lim</m:mtext></m:mrow><m:mrow><m:mi mathvariant="normal">Δ</m:mi><m:mi>x</m:mi><m:mo>→</m:mo><m:mn>0</m:mn></m:mrow></m:munder><m:mfrac><m:mrow><m:mi>f</m:mi><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>+</m:mo><m:mi mathvariant="normal">Δ</m:mi><m:mi>x</m:mi><m:mo>,</m:mo><m:mi>y</m:mi><m:mo>)</m:mo><m:mo>−</m:mo><m:mi>f</m:mi><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>,</m:mo><m:mi>y</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mrow><m:mrow><m:mi mathvariant="normal">Δ</m:mi><m:mi>x</m:mi></m:mrow></m:mfrac></m:mrow></m:math>
</div>
<p>Why is it that the partial derivatives with respect to <em>x</em> and <em>y</em> are the components of the gradient vector? Again, there is more obvious insight in the geometry than in the algebra. In <a href="C07_chapter2.xhtml#f2_29">Figure 2.29</a>, we see the vector <strong>a</strong> travels along a path where <strong>f</strong> does not change. Note that this is again at a small enough scale that the surface height (<em>x, y</em>) = <em>f</em> (<em>x, y</em>) can be considered locally planar. From the figure, we see that the vector <strong>a</strong> = (Δ<em>x,</em> Δ<em>y</em>) .</p>
<p>Because the uphill direction is perpendicular to <strong>a</strong>, we know the dot product is equal to zero:</p>
<div class="disp-formula" id="equ2_11">
<m:math alttext=""><m:mrow><m:mrow><m:mo>(</m:mo><m:mi>∇</m:mi><m:mi>f</m:mi><m:mo>)</m:mo><m:mo>·</m:mo><m:mtext>a</m:mtext><m:mo>≡</m:mo><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mi>∇</m:mi><m:mo>,</m:mo><m:mi>y</m:mi><m:mi>∇</m:mi><m:mo>)</m:mo><m:mo>·</m:mo><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mo>,</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mo>)</m:mo><m:mo>=</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>∇</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">Δ</m:mi><m:mi>x</m:mi><m:mo>+</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>∇</m:mi></m:mrow></m:msub><m:mi mathvariant="normal">Δ</m:mi><m:mi>y</m:mi><m:mo>=</m:mo><m:mn>0.</m:mn></m:mrow></m:mrow></m:mrow></m:mrow><m:mspace width="3em"/><m:mo>(2.11)</m:mo></m:math>
</div>
<figure id="f2_28" tabindex="0">
<img alt="" src="../images/fig2_28.jpg"/>
<figcaption><p><span class="blue">Figure 2.28.</span> The <a id="index_term828"/>partial derivative of a function <em>f</em> with respect to <em>x</em> must hold <em>y</em> constant to have a unique value, as shown by the dark point. The hollow points show other values of <em>f</em> that do not hold <em>y</em> constant.</p></figcaption>
</figure>
<p class="noindent">We also know that the change in <em>f</em> in the direction (<em>x<sub>a</sub>,y<sub>a</sub></em>) equals zero:</p>
<p class="noindent">Given any vectors (<em>x, y</em>) and (<em>x,y</em>) that are perpendicular, we know that the angle between them is 90 degrees, and thus, their dot product equals zero (recall that the dot product is proportional to the <a id="index_term270"/>cosine of the angle between the two vectors). Thus, we have <em>xx</em> + <em>yy</em> = 0. Given (<em>x, y</em>) , it is easy to construct valid vectors whose dot product with (<em>x, y</em>) equals zero, the two most obvious being (<em>y,–x</em>) and (–<em>y, x</em>) ; you can verify that these vectors give the desired zero dot product with (<em>x, y</em>). A generalization of this observation is that (<em>x, y</em>) is perpendicular to <em>k</em>(<em>y</em>,–x) where <em>k</em> is any nonzero constant. This implies that</p>
<div class="disp-formula" id="equ2_12">
<m:math alttext=""><m:mrow><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mo>,</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>k</m:mi><m:mrow><m:mo>(</m:mo><m:mfrac><m:mrow><m:mo>∂</m:mo><m:mi>f</m:mi></m:mrow><m:mrow><m:mo>∂</m:mo><m:mi>y</m:mi></m:mrow></m:mfrac><m:mo>,</m:mo><m:mo>−</m:mo><m:mfrac><m:mrow><m:mo>∂</m:mo><m:mi>f</m:mi></m:mrow><m:mrow><m:mo>∂</m:mo><m:mi>x</m:mi></m:mrow></m:mfrac><m:mo>)</m:mo><m:mn>.</m:mn></m:mrow></m:mrow></m:mrow><m:mspace width="3em"/><m:mo>(2.12)</m:mo></m:math>
</div>
<figure id="f2_29" tabindex="0">
<img alt="" src="../images/fig2_29.jpg"/>
<figcaption><p><span class="blue">Figure 2.29.</span> The vector <strong>a</strong> points in a direction where <em>f</em> has no change and is thus perpendicular to the gradient vector ∇<em>f</em>.</p></figcaption>
</figure>
<p class="noindent">Combining Equations (2.11) and (2.12) gives</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>∇</m:mi></m:mrow></m:msub><m:mo>,</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>∇</m:mi></m:mrow></m:msub><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>k</m:mi><m:mo>′</m:mo><m:mrow><m:mo>(</m:mo><m:mfrac><m:mrow><m:mo>∂</m:mo><m:mi>f</m:mi></m:mrow><m:mrow><m:mo>∂</m:mo><m:mi>x</m:mi></m:mrow></m:mfrac><m:mo>,</m:mo><m:mfrac><m:mrow><m:mo>∂</m:mo><m:mi>f</m:mi></m:mrow><m:mrow><m:mo>∂</m:mo><m:mi>y</m:mi></m:mrow></m:mfrac><m:mo>)</m:mo><m:mo>,</m:mo></m:mrow></m:mrow></m:mrow></m:math>
</div>
<p>where <em>k<sup/></em> is any nonzero constant. By definition, “uphill” implies a positive change in <em>f</em> , so we would like <em>k<sup/></em> <em>&gt;</em> 0,and <em>k<sup/></em> = 1 is a perfectly good convention.</p>
<p><a id="term-247"/><a id="term-351"/><a id="term-423"/><a id="term-510"/><a id="term-983"/><a id="term-984"/><span aria-label="38" epub:type="pagebreak" id="pg_38" role="doc-pagebreak"/>As an example of the gradient, consider the implicit circle <em>x</em><sup>2</sup> + <em>y</em><sup>2</sup> <em>–</em> 1 = 0 with gradient vector (2<em>x,</em> 2<em>y</em>) , indicating that the outside of the circle is the positive region for the function <em>f</em> (<em>x, y</em>) = <em>x</em><sup>2</sup> + <em>y</em><sup>2</sup> <em>–</em> 1. Note that the length of the gradient vector can be different depending on the multiplier in the implicit equation. For example, the unit circle can be described by <em>Ax</em><sup>2</sup> + <em>Ay</em><sup>2</sup> <em>–</em> <em>A</em> = 0 for any nonzero <em>A</em>. The gradient for this curve is (2<em>Ax,</em> 2<em>Ay</em>) . This will be normal (perpendicular) to the circle, but will have a length determined by <em>A</em>. For <em>A &gt;</em> 0, the normal will point outward from the circle, and for <em>A &lt;</em> 0, it will point inward. This switch from outward to inward is as it should be, since the positive region switches inside the circle. In terms of the height-field view, <em>h</em> = <em>Ax</em><sup>2</sup> + <em>Ay</em><sup>2</sup> <em>–</em> <em>A</em>, and the circle is at zero altitude. For <em>A &gt;</em> 0, the circle encloses a depression, and for <em>A &lt;</em> 0, the circle encloses a bump. As <em>A</em> becomes more negative, the bump increases in height, but the <em>h</em> = 0 circle doesn’t change. The direction of maximum uphill doesn’t change, but the slope increases. The length of the gradient reflects this change in degree of the slope. So intuitively, you can think of the gradient’s direction as pointing uphill and its magnitude as measuring how uphill the slope is.</p>
<section>
<h4 id="sec8"><a id="index_term698"/><span class="blue">Implicit 2D Lines</span></h4>
<p>The familiar “slope-intercept” form of the line is</p>
<div class="disp-formula" id="equ2_13">
<m:math alttext=""><m:mrow><m:mi>y</m:mi><m:mo>=</m:mo><m:mi>m</m:mi><m:mi>x</m:mi><m:mo>+</m:mo><m:mi>b</m:mi><m:mn>.</m:mn></m:mrow><m:mspace width="3em"/><m:mo>(2.13)</m:mo></m:math>
</div>
<p>This can be converted easily to implicit form (<a href="C07_chapter2.xhtml#f2_30">Figure 2.30</a>):</p>
<div class="disp-formula" id="equ2_14">
<m:math alttext=""><m:mrow><m:mi>y</m:mi><m:mo>−</m:mo><m:mi>m</m:mi><m:mi>x</m:mi><m:mo>−</m:mo><m:mi>b</m:mi><m:mo>=</m:mo><m:mn>0.</m:mn></m:mrow><m:mspace width="3em"/><m:mo>(2.14)</m:mo></m:math>
</div>
<p>Here, <em>m</em> is the “slope” (ratio of rise to run), and <em>b</em> is the <em>y</em> value where the line crosses the <em>y</em>-axis, usually called the <em>y-intercept</em>. The line also partitions the 2D plane, but here “inside” and “outside” might be more intuitively called “over” and “under.”</p>
<figure id="f2_30" tabindex="0">
<img alt="" src="../images/fig2_30.jpg"/>
<figcaption><p><span class="blue">Figure 2.30.</span> A 2D line can be described by the equation <em>y</em> - <em>mx</em> - <em>b</em> = 0.</p></figcaption>
</figure>
<p>Because we can multiply an implicit equation by any constant without changing the points where it is zero, <em>kf</em> (<em>x, y</em>) = 0 is the same curve for any nonzero <em>k</em>. This allows several implicit forms for the same line, for example,</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mn>2</m:mn><m:mi>y</m:mi><m:mo>−</m:mo><m:mn>2</m:mn><m:mi>m</m:mi><m:mi>x</m:mi><m:mo>−</m:mo><m:mn>2</m:mn><m:mi>b</m:mi><m:mo>=</m:mo><m:mn>0.</m:mn></m:mrow></m:math>
</div>
<p>One reason the slope-intercept form is sometimes awkward is that it can’t represent some lines such as <em>x</em> = 0 because <em>m</em> would have to be infinite. For this reason, a more general form is often useful:</p>
<div class="disp-formula" id="equ2_15">
<m:math alttext=""><m:mrow><m:mi>A</m:mi><m:mi>x</m:mi><m:mo>+</m:mo><m:mi>B</m:mi><m:mi>y</m:mi><m:mo>+</m:mo><m:mi>C</m:mi><m:mo>=</m:mo><m:mn>0</m:mn><m:mo>,</m:mo></m:mrow><m:mspace width="3em"/><m:mo>(2.15)</m:mo></m:math>
</div>
<p><span aria-label="39" epub:type="pagebreak" id="pg_39" role="doc-pagebreak"/>for real numbers <em>A</em>, <em>B</em>, <em>C</em>.</p>
<p>Suppose we know two points on the line, (<em>x</em><sub>0</sub>, <em>y</em><sub>0</sub>) and (<em>x</em><sub>1</sub><em>,y</em><sub>1</sub>) . What <em>A</em>, <em>B</em>, and <em>C</em> describe the line through these two points? Because these points lie on the line, they must both satisfy Equation (2.15):</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi>A</m:mi><m:mi>x</m:mi></m:mrow><m:mrow><m:mn>0</m:mn></m:mrow></m:msub><m:mo>+</m:mo><m:msub><m:mrow><m:mi>B</m:mi><m:mi>y</m:mi></m:mrow><m:mrow><m:mn>0</m:mn></m:mrow></m:msub><m:mo>+</m:mo><m:mi>C</m:mi><m:mo>=</m:mo><m:mn>0</m:mn><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mtable><m:mtr><m:mtd><m:mi>A</m:mi><m:mi>x</m:mi></m:mtd></m:mtr></m:mtable></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub><m:mo>+</m:mo><m:msub><m:mrow><m:mi>B</m:mi><m:mi>y</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub><m:mo>+</m:mo><m:mi>C</m:mi><m:mo>=</m:mo><m:mn>0.</m:mn></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>Unfortunately, we have two equations and <em>three</em> unknowns: <em>A, B</em>, and <em>C</em>. This problem arises because of the arbitrary multiplier we can have with an implicit equation. We could set <em>C</em> = 1 for convenience:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mi>A</m:mi><m:mi>x</m:mi><m:mo>+</m:mo><m:mi>B</m:mi><m:mi>y</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>=</m:mo><m:mn>0</m:mn><m:mo>,</m:mo></m:mrow></m:math>
</div>
<p>but we have a similar problem to the infinite slope case in slope-intercept form: lines through the origin would need to have <em>A</em>(0) + <em>B</em>(0) + 1 = 0, which is a contradiction. For example, the equation for a 45<em>–</em>° line through the origin can be written <em>x</em> <em>–</em> <em>y</em> = 0, or equally well <em>y</em> <em>–</em> <em>x</em> = 0, or even 17<em>y</em> <em>–</em> 17<em>x</em> = 0, but it cannot be written in the form <em>Ax</em> + <em>By</em> +1 = 0.</p>
<p>Whenever we have such pesky algebraic problems, we try to solve the problems using geometric intuition as a guide. One tool we have, as discussed in <a href="C07_chapter2.xhtml#sec2_7_2">Section 2.7.2</a>, is the gradient. For the line <em>Ax</em> + <em>By</em> + <em>C</em> = 0, the gradient vector is (<em>A, B</em>) . This vector is perpendicular to the line (<a href="C07_chapter2.xhtml#f2_31">Figure 2.31</a>), and points to the side of the line where <em>Ax</em> + <em>By</em> + <em>C</em> is positive. Given two points on the line (<em>x</em><sub>0</sub><em>,y</em><sub>0</sub>) and (<em>x</em><sub>1</sub><em>,y</em><sub>1</sub>) , we know that the vector between them points in the same direction as the line. This vector is just (<em>x</em><sub>1</sub> <em>–</em> <em>x</em><sub>0</sub><em>,y</em><sub>1</sub> <em>–</em> <em>y</em><sub>0</sub>), and because it is parallel to the line, it must also be perpendicular to the gradient vector (<em>A, B</em>) . Recall that there are an infinite number of (<em>A, B, C</em>) that describe the line because of the arbitrary scaling property of implicits. We want any one of the valid (<em>A, B, C</em>) .</p>
<figure id="f2_31" tabindex="0">
<img alt="" src="../images/fig2_31.jpg"/>
<figcaption><p><span class="blue">Figure 2.31.</span> The gradient vector (<em>A, B</em>) is perpendicular to the <a id="index_term571"/>implicit line <em>Ax</em> + <em>By</em> + <em>C</em> = 0.</p></figcaption>
</figure>
<p>We can start with any (<em>A, B</em>) perpendicular to (<em>x</em><sub>1</sub>–<em>x</em><sub>0</sub>,<em>y</em><sub>1</sub>–<em>y</em><sub>0</sub>). Such a vector is just (<em>A, B</em>) = (<em>y</em><sub>0</sub> <em>–y</em><sub>1</sub>, <em>x</em><sub>1</sub> <em>–</em> <em>x</em><sub>0</sub>) by the same reasoning as in <a href="C07_chapter2.xhtml#sec2_7_2">Section 2.7.2</a>. This means that the equation of the line through (<em>x</em><sub>0</sub><em>,y</em><sub>0</sub>) and (<em>x</em><sub>1</sub><em>,y</em><sub>1</sub>) is</p>
<div class="disp-formula" id="equ2_16">
<m:math alttext=""><m:mrow><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mn>0</m:mn></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub><m:mo>)</m:mo><m:mi>x</m:mi><m:mo>+</m:mo><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mn>0</m:mn></m:mrow></m:msub><m:mo>)</m:mo><m:mi>y</m:mi><m:mo>+</m:mo><m:mi>C</m:mi><m:mo>=</m:mo><m:mn>0.</m:mn></m:mrow></m:mrow></m:mrow><m:mspace width="3em"/><m:mo>(2.16)</m:mo></m:math>
</div>
<p>Now we just need to find <em>C</em>. Because (<em>x</em><sub>0</sub><em>,y</em><sub>0</sub>) and (<em>x</em><sub>1</sub><em>,y</em><sub>1</sub>) are on the line, they must satisfy Equation (2.16). We can plug either value in and solve for <em>C</em>. Doing this for (<em>x</em><sub>0</sub><em>,y</em><sub>0</sub>) yields <em>C</em> = <em>x</em><sub>0</sub><em>y</em><sub>1</sub> <em>–</em> <em>x</em><sub>1</sub><em>y</em><sub>0</sub>, and thus, the full equation for the line is</p>
<div class="disp-formula" id="equ2_17">
<m:math alttext=""><m:mrow><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mn>0</m:mn></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub><m:mo>)</m:mo><m:mi>x</m:mi><m:mo>+</m:mo><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mn>0</m:mn></m:mrow></m:msub><m:mo>)</m:mo><m:mi>y</m:mi><m:mo>+</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mn>0</m:mn></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mn>0</m:mn></m:mrow></m:msub><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:mrow></m:mrow><m:mspace width="3em"/><m:mo>(2.17)</m:mo></m:math>
</div>
<p>Again, this is one of infinitely many valid implicit equations for the line through two points, but this form has no division operation and thus no numerically degenerate cases for points with finite Cartesian coordinates. A nice thing about <a id="term-421"/><span aria-label="40" epub:type="pagebreak" id="pg_40" role="doc-pagebreak"/>Equation (2.17) is that we can always convert to the slope-intercept form (when it exists) by moving the non-<em>y</em> terms to the right-hand side of the equation and dividing by the multiplier of the <em>y</em> term:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mi>y</m:mi><m:mo>=</m:mo><m:mfrac><m:mrow><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mn>0</m:mn></m:mrow></m:msub></m:mrow><m:mrow><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mn>0</m:mn></m:mrow></m:msub></m:mrow></m:mfrac><m:mi>x</m:mi><m:mo>+</m:mo><m:mfrac><m:mrow><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mn>0</m:mn></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mn>0</m:mn></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub></m:mrow><m:mrow><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub></m:mrow></m:mfrac><m:mn>.</m:mn></m:mrow></m:math>
</div>
<p>An interesting property of the implicit line equation is that it can be used to find the signed distance from a point to the line. The value of <em>Ax</em> + <em>By</em> + <em>C</em> is proportional to the distance from the line (<a href="C07_chapter2.xhtml#f2_32">Figure 2.32</a>). As shown in <a href="C07_chapter2.xhtml#f2_33">Figure 2.33</a>, the distance from a point to the line is the length of the vector <em>k</em>(<em>A, B</em>) ,which is</p>
<div class="disp-formula" id="equ2_18">
<m:math alttext=""><m:mrow><m:mtext>distance</m:mtext><m:mo>=</m:mo><m:mi>k</m:mi><m:msqrt><m:mrow><m:msup><m:mrow><m:mi>A</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>+</m:mo><m:msup><m:mrow><m:mi>B</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup></m:mrow></m:msqrt><m:mn>.</m:mn></m:mrow><m:mspace width="3em"/><m:mo>(2.18)</m:mo></m:math>
</div>
<figure id="f2_32" tabindex="0">
<img alt="" src="../images/fig2_32.jpg"/>
<figcaption><p><span class="blue">Figure 2.32.</span> The value of the implicit function <em>f</em> (<em>x,y</em>) = <em>Ax</em> + <em>By</em> + <em>C</em> is a constant times the signed distance from <em>Ax</em> + <em>By</em> + <em>C</em> = 0.</p></figcaption>
</figure>
<p class="noindent">For the point (<em>x, y</em>)+ <em>k</em>(<em>A, B</em>) ,thevalueof <em>f</em> (<em>x, y</em>) = <em>Ax</em> + <em>By</em> + <em>C</em> is</p>
<div class="disp-formula" id="equ2_19">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mi>f</m:mi><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>+</m:mo><m:mi>k</m:mi><m:mi>A</m:mi><m:mo>,</m:mo><m:mi>y</m:mi><m:mo>+</m:mo><m:mi>k</m:mi><m:mi>B</m:mi><m:mo>)</m:mo></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mi>A</m:mi><m:mi>x</m:mi><m:mo>+</m:mo><m:msup><m:mrow><m:mi>k</m:mi><m:mi>A</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>+</m:mo><m:mi>B</m:mi><m:mi>y</m:mi><m:mo>+</m:mo><m:msup><m:mrow><m:mi>k</m:mi><m:mi>B</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>+</m:mo><m:mi>C</m:mi></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mi>k</m:mi><m:mrow><m:mo>(</m:mo><m:msup><m:mrow><m:mi>A</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>+</m:mo><m:msup><m:mrow><m:mi>B</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>)</m:mo><m:mn>.</m:mn></m:mrow></m:mtd></m:mtr></m:mtable></m:mrow><m:mspace width="3em"/><m:mo>(2.19)</m:mo></m:math>
</div>
<figure id="f2_33" tabindex="0">
<img alt="" src="../images/fig2_33.jpg"/>
<figcaption><p><span class="blue">Figure 2.33.</span> The vector <em>k</em>(<em>A,B</em>) connects a point (<em>x,y</em>) on the line closest to a point not on the line. The distance is proportional to k.</p></figcaption>
</figure>
<p class="noindent">The simplification in that equation is a result of the fact that we know (<em>x, y</em>) is on the line, so <em>Ax</em> + <em>By</em> + <em>C</em> = 0. From Equations (2.18) and (2.19), we can see that the signed distance from line <em>Ax</em> + <em>By</em> + <em>C</em> = 0 to a point (<em>a, b</em>) is</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext>Distance</m:mtext><m:mo>=</m:mo><m:mfrac><m:mrow><m:mi>f</m:mi><m:mrow><m:mo>(</m:mo><m:mi>a</m:mi><m:mo>,</m:mo><m:mi>b</m:mi><m:mo>)</m:mo></m:mrow></m:mrow><m:mrow><m:msqrt><m:mrow><m:msup><m:mrow><m:mi>A</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>+</m:mo><m:msup><m:mrow><m:mi>B</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup></m:mrow></m:msqrt></m:mrow></m:mfrac><m:mn>.</m:mn></m:mrow></m:math>
</div>
<p>Here, “signed distance” means that its magnitude (absolute value) is the geometric distance, but on one side of the line, distances are positive and on the other, they are negative. You can choose between the equally valid representations <em>f</em> (<em>x, y</em>) = 0 and <em>–f</em> (<em>x, y</em>) = 0 if your problem has some reason to prefer a particular side being positive. Note that if (<em>A, B</em>) is a unit vector, then <em>f</em> (<em>a, b</em>) is the signed distance. We can multiply Equation (2.17) by a constant that ensures that (<em>A, B</em>) is a unit vector:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mi>f</m:mi><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>,</m:mo><m:mi>y</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mfrac><m:mrow><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mn>0</m:mn></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub></m:mrow><m:mrow><m:msqrt><m:mrow><m:msup><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mn>0</m:mn></m:mrow></m:msub><m:mo>)</m:mo></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>+</m:mo><m:msup><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mn>0</m:mn></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub><m:mo>)</m:mo></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup></m:mrow></m:msqrt></m:mrow></m:mfrac><m:mi>x</m:mi><m:mo>+</m:mo><m:mfrac><m:mrow><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mn>0</m:mn></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub></m:mrow><m:mrow><m:msqrt><m:mrow><m:msup><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mn>0</m:mn></m:mrow></m:msub><m:mo>)</m:mo></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>+</m:mo><m:msup><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mn>0</m:mn></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub><m:mo>)</m:mo></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup></m:mrow></m:msqrt></m:mrow></m:mfrac></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:mo>+</m:mo><m:mfrac><m:mrow><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mn>0</m:mn></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mn>0</m:mn></m:mrow></m:msub></m:mrow><m:mrow><m:msqrt><m:mrow><m:msup><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mn>0</m:mn></m:mrow></m:msub><m:mo>)</m:mo></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>+</m:mo><m:msup><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mn>0</m:mn></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub><m:mo>)</m:mo></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup></m:mrow></m:msqrt></m:mrow></m:mfrac><m:mo>=</m:mo><m:mn>0.</m:mn></m:mtd></m:mtr></m:mtable></m:mrow><m:mspace width="3em"/><m:mo>(2.20)</m:mo></m:math>
</div>
<p>Note that evaluating <em>f</em> (<em>x, y</em>) in Equation (2.20) directly gives the signed distance, but it does require a square root to set up the equation. Implicit lines will turn out to be very useful for triangle rasterization (<a href="C14_chapter9.xhtml#sec9_1_2">Section 9.1.2</a>). Other forms for 2D lines are discussed in <a href="C18_chapter13.xhtml#c13">Chapter 13</a>.</p>
</section>
<section>
<h4 id="sec9"><a id="term-251"/><a id="term-886"/><span aria-label="41" epub:type="pagebreak" id="pg_41" role="doc-pagebreak"/><span class="blue">Implicit Quadric Curves</span></h4>
<p>In the previous section, we saw that a linear function <em>f</em> (<em>x, y</em>) gives rise to an implicit line <em>f</em> (<em>x, y</em>) = 0. If <em>f</em> is instead a quadratic function of <em>x</em> and <em>y</em>, with the general form</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:msup><m:mrow><m:mi>A</m:mi><m:mi>x</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>+</m:mo><m:mi>B</m:mi><m:mi>x</m:mi><m:mi>y</m:mi><m:mo>+</m:mo><m:msup><m:mrow><m:mi>C</m:mi><m:mi>y</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>+</m:mo><m:mi>D</m:mi><m:mi>x</m:mi><m:mo>+</m:mo><m:mi>E</m:mi><m:mi>y</m:mi><m:mo>+</m:mo><m:mi>F</m:mi><m:mo>=</m:mo><m:mn>0</m:mn><m:mo>,</m:mo></m:mrow></m:math>
</div>
<p>the resulting implicit curve is called a quadric. Two-dimensional quadric curves include ellipses and hyperbolas, as well as the special cases of parabolas, circles, and lines.</p>
<p>Examples of quadric curves include the circle with center (<em>x</em><sub>c</sub>, <em>y</em><sub>c</sub>) and radius <em>r</em>,</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:msup><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mo>)</m:mo></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>+</m:mo><m:msup><m:mrow><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>−</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mo>)</m:mo></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>−</m:mo><m:msup><m:mrow><m:mi>r</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>=</m:mo><m:mn>0</m:mn><m:mo>,</m:mo></m:mrow></m:math>
</div>
<p>and axis-aligned ellipses of the form</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mfrac><m:mrow><m:msup><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mo>)</m:mo></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup></m:mrow><m:mrow><m:msup><m:mrow><m:mi>a</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup></m:mrow></m:mfrac><m:mo>+</m:mo><m:mfrac><m:mrow><m:msup><m:mrow><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>−</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mo>)</m:mo></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup></m:mrow><m:mrow><m:msup><m:mrow><m:mi>b</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup></m:mrow></m:mfrac><m:mo>−</m:mo><m:mn>1</m:mn><m:mo>=</m:mo><m:mn>0</m:mn><m:mo>,</m:mo></m:mrow></m:math>
</div>
<aside class="boxed-text" epub:type="sidebar">
<p class="noindent">Try setting <em>a=b=r</em> in the ellipse equation and compare to the circle equation.</p>
</aside>
<p class="noindent">where (<em>x<sub>c</sub>,y<sub>c</sub></em>) is the center of the ellipse, and <em>a</em> and <em>b</em> are the minor and major semi-axes (<a href="C07_chapter2.xhtml#f2_34">Figure 2.34</a>).</p>
<figure id="f2_34" tabindex="0">
<img alt="" src="../images/fig2_34.jpg"/>
<figcaption><p><span class="blue">Figure 2.34.</span> The ellipse with center (<em>x<sub>c</sub></em>, <em>y<sub>c</sub></em>) and semiaxes of length <em>a</em> and <em>b</em>.</p></figcaption>
</figure>
</section>
</section>
<section>
<h3 id="sec2_7_3"><a id="index_term611"/><span class="green">2.7.3 3D Implicit Surfaces</span></h3>
<p>Just as implicit equations can be used to define curves in 2D, they can be used to define surfaces in 3D. As in 2D, implicit equations <em>implicitly</em> define a set of points that are on the surface:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mi>f</m:mi><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>,</m:mo><m:mi>y</m:mi><m:mo>,</m:mo><m:mi>z</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mn>0.</m:mn></m:mrow></m:mrow></m:math>
</div>
<p>Any point (<em>x, y, z</em>) that is on the surface results in zero when given as an argument to <em>f</em> . Any point not on the surface results in some number other than zero. You can check whether a point is on the surface by evaluating <em>f</em> , or you can check which side of the surface the point lies on by looking at the sign of <em>f</em> , but you cannot always explicitly construct points on the surface. Using vector notation, we will write such functions of <strong>p</strong> = (<em>x, y, z</em>) as</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mi>f</m:mi><m:mrow><m:mo>(</m:mo><m:mtext>p</m:mtext><m:mo>)</m:mo><m:mo>=</m:mo><m:mn>0.</m:mn></m:mrow></m:mrow></m:math>
</div>
</section>
<section>
<h3 id="sec2_7_4"><span class="green">2.7.4 Surface Normal to an Implicit Surface</span></h3>
<p>A surface normal (which is needed for lighting computations, among other things) is a vector perpendicular to the surface. Each point on the surface may have a <a id="term-462"/><span aria-label="42" epub:type="pagebreak" id="pg_42" role="doc-pagebreak"/>different normal vector. In the same way that the gradient provides a normal to an implicit curve in 2D, the surface normal at a point <strong>p</strong> on an implicit surface is given by the gradient of the implicit function</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext>n</m:mtext><m:mo>=</m:mo><m:mi>∇</m:mi><m:mi>f</m:mi><m:mrow><m:mo>(</m:mo><m:mtext>p</m:mtext><m:mo>)</m:mo><m:mo>=</m:mo><m:mrow><m:mo>(</m:mo><m:mfrac><m:mrow><m:mo>∂</m:mo><m:mi>f</m:mi><m:mrow><m:mo>(</m:mo><m:mtext>p</m:mtext><m:mo>)</m:mo></m:mrow></m:mrow><m:mrow><m:mo>∂</m:mo><m:mi>x</m:mi></m:mrow></m:mfrac><m:mo>,</m:mo><m:mfrac><m:mrow><m:mo>∂</m:mo><m:mi>f</m:mi><m:mrow><m:mo>(</m:mo><m:mtext>p</m:mtext><m:mo>)</m:mo></m:mrow></m:mrow><m:mrow><m:mo>∂</m:mo><m:mi>y</m:mi></m:mrow></m:mfrac><m:mo>,</m:mo><m:mfrac><m:mrow><m:mo>∂</m:mo><m:mi>f</m:mi><m:mrow><m:mo>(</m:mo><m:mtext>p</m:mtext><m:mo>)</m:mo></m:mrow></m:mrow><m:mrow><m:mo>∂</m:mo><m:mi>z</m:mi></m:mrow></m:mfrac><m:mo>)</m:mo><m:mn>.</m:mn></m:mrow></m:mrow></m:mrow></m:math>
</div>
<p>The reasoning is the same as for the 2D case: the gradient points in the direction of fastest increase in <em>f</em> , which is perpendicular to all directions <a id="index_term1153"/>tangent to the surface, in which <em>f</em> remains constant. The gradient vector points toward the side of the surface where <em>f</em> (<strong>p</strong>) <em>&gt;</em> 0, which we may think of as “into” the surface or “out from” the surface in a given context. If the particular form of <em>f</em> creates inward-facing gradients, and outward-facing gradients are desired, the surface <em>–f</em> (<strong>p</strong>) = 0 is the same as surface <em>f</em> (<strong>p</strong>) = 0 but has directionally reversed gradients, i.e., –∇<em>f</em> (<strong>p</strong>) = <em>∇</em>(–f (<strong>p</strong>)) .</p>
</section>
<section>
<h3 id="sec2_7_5"><a id="index_term610"/><span class="green">2.7.5 Implicit Planes</span></h3>
<p>As an example, consider the infinite plane through point <strong>a</strong> with surface normal <strong>n</strong>. The implicit equation to describe this plane is given by</p>
<div class="disp-formula" id="equ2_21">
<m:math alttext=""><m:mrow><m:mrow><m:mo>(</m:mo><m:mtext>p</m:mtext><m:mo>−</m:mo><m:mtext>a</m:mtext><m:mo>)</m:mo><m:mo>·</m:mo><m:mtext>n</m:mtext><m:mo>=</m:mo><m:mn>0.</m:mn></m:mrow></m:mrow><m:mspace width="3em"/><m:mo>(2.21)</m:mo></m:math>
</div>
<p>Note that <strong>a</strong> and <strong>n</strong> are known quantities. The point <strong>p</strong> is any unknown point that satisfies the equation. In geometric terms this equation says “the vector from <strong>a</strong> to <strong>p</strong> is perpendicular to the plane normal.” If <strong>p</strong> were not in the plane, then (<strong>p</strong> <em>–</em> <strong>a</strong>) would not make a right angle with <strong>n</strong> (<a href="C07_chapter2.xhtml#f2_35">Figure 2.35</a>).</p>
<figure id="f2_35" tabindex="0">
<img alt="" src="../images/fig2_35.jpg"/>
<figcaption><p><span class="blue">Figure 2.35.</span> Any of the points <strong>p</strong> shown are in the plane with normal vector <strong>n</strong> that includes point <strong>a</strong> if Equation (2.21) is satisfied.</p></figcaption>
</figure>
<p>Sometimes, we want the implicit equation for a plane through points <strong>a</strong>, <strong>b</strong>, and <strong>c</strong>. The normal to this plane can be found by taking the cross product of any two vectors in the plane. One such cross product is</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext>n</m:mtext><m:mo>=</m:mo><m:mrow><m:mo>(</m:mo><m:mtext>b</m:mtext><m:mo>−</m:mo><m:mtext>a</m:mtext><m:mo>)</m:mo><m:mo>×</m:mo><m:mrow><m:mo>(</m:mo><m:mtext>c</m:mtext><m:mo>−</m:mo><m:mtext>a</m:mtext><m:mo>)</m:mo><m:mn>.</m:mn></m:mrow></m:mrow></m:mrow></m:math>
</div>
<p>This allows us to write the implicit plane equation:</p>
<div class="disp-formula" id="equ2_22">
<m:math alttext=""><m:mrow><m:mrow><m:mo>(</m:mo><m:mtext>p</m:mtext><m:mo>−</m:mo><m:mtext>a</m:mtext><m:mo>)</m:mo><m:mo>·</m:mo><m:mrow><m:mo>(</m:mo><m:mrow><m:mo>(</m:mo><m:mtext>b</m:mtext><m:mo>−</m:mo><m:mtext>a</m:mtext><m:mo>)</m:mo><m:mo>×</m:mo><m:mrow><m:mo>(</m:mo><m:mtext>c</m:mtext><m:mo>−</m:mo><m:mtext>a</m:mtext><m:mo>)</m:mo></m:mrow></m:mrow><m:mo>=</m:mo><m:mn>0.</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:mrow><m:mspace width="3em"/><m:mo>(2.22)</m:mo></m:math>
</div>
<p>A geometric way to read this equation is that the volume of the parallelepiped defined by <strong>p</strong> <em>–</em> <strong>a</strong>, <strong>b</strong> <em>–</em> <strong>a</strong>, and <strong>c</strong> <em>–</em> <strong>a</strong> is zero; i.e., they are coplanar. This can only be true if <strong>p</strong> is in the same plane as <strong>a</strong>, <strong>b</strong>, and <strong>c</strong>. The full-blown Cartesian <a id="term-244"/><a id="term-655"/><span aria-label="43" epub:type="pagebreak" id="pg_43" role="doc-pagebreak"/>representation for this is given by the determinant (this is discussed in more detail in <a href="C11_chapter6.xhtml#sec6_3">Section 6.3</a>):</p>
<div class="disp-formula" id="equ2_23">
<m:math xmlns:mml="http://www.w3.org/1998/Math/MathML" alttext=""><m:mrow><m:mrow><m:mo>|</m:mo><m:mtable><m:mtr><m:mtd><m:mi>x</m:mi><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mtd><m:mtd><m:mi>y</m:mi><m:mo>−</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mtd><m:mtd><m:mi>z</m:mi><m:mo>−</m:mo><m:msub><m:mrow><m:mi>z</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mtd><m:mtd><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mtd><m:mtd><m:msub><m:mrow><m:mi>z</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>z</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mtd><m:mtd><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mtd><m:mtd><m:msub><m:mrow><m:mi>z</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>z</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mtd></m:mtr></m:mtable><m:mo>|</m:mo><m:mo>=</m:mo><m:mn>0</m:mn><m:mn>.</m:mn><m:mtext>          </m:mtext><m:mrow><m:mo>(</m:mo><m:mn>2.23</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:mrow></m:math>
</div>
<p>The determinant can be expanded (see <a href="C11_chapter6.xhtml#sec6_3">Section 6.3</a> for the mechanics of expanding determinants) to the bloated form with many terms.</p>
<p>Equations (2.22) and (2.23) are equivalent, and comparing them is instructive. Equation (2.22) is easy to interpret geometrically and will yield efficient code. In addition, it is relatively easy to avoid a typographic error that compiles into incorrect code if it takes advantage of debugged cross and dot product code. Equation (2.23) is also easy to interpret geometrically and will be efficient provided an efficient 3 × 3 determinant function is implemented. It is also easy to implement without a typo if a function <em>determinant</em> (<strong>a</strong>, <strong>b</strong>, <strong>c</strong>) is available. It will be especially easy for others to read your code if you rename the <em>determinant</em> function <em>volume</em>. So both Equations (2.22) and (2.23) map well into code. The full expansion of either equation into <em>x</em>-, <em>y</em>-, and <em>z</em>-components is likely to generate typos. Such typos are likely to compile and, thus, to be especially pesky. This is an excellent example of clean math generating clean code and bloated math generating bloated code.</p>
<section>
<h4 id="sec10"><a id="index_term1199"/><span class="blue">3D Quadric Surfaces</span></h4>
<p>Just as quadratic polynomials in two variables define quadric curves in 2D, quadratic polynomials in <em>x</em>, <em>y</em>,and <em>z</em> define <em>quadric surfaces</em> in 3D. For instance, a sphere can be written as</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:msup><m:mrow><m:mi>f</m:mi><m:mrow><m:mo>(</m:mo><m:mtext>p</m:mtext><m:mo>)</m:mo><m:mo>=</m:mo><m:mrow><m:mo>(</m:mo><m:mtext>p</m:mtext><m:mo>−</m:mo><m:mtext>c</m:mtext><m:mo>)</m:mo></m:mrow></m:mrow></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>−</m:mo><m:msup><m:mrow><m:mi>r</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>=</m:mo><m:mn>0</m:mn><m:mo>,</m:mo></m:mrow></m:math>
</div>
<p>and an axis-aligned ellipsoid may be written as</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mi>f</m:mi><m:mrow><m:mrow><m:mo>(</m:mo><m:mtext>p</m:mtext><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mfrac><m:mrow><m:msup><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mo>)</m:mo></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup></m:mrow><m:mrow><m:msup><m:mrow><m:mi>a</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup></m:mrow></m:mfrac><m:mo>+</m:mo><m:mfrac><m:mrow><m:msup><m:mrow><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>−</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mo>)</m:mo></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup></m:mrow><m:mrow><m:msup><m:mrow><m:mi>b</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup></m:mrow></m:mfrac><m:mo>+</m:mo><m:mfrac><m:mrow><m:msup><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>−</m:mo><m:msub><m:mrow><m:mi>z</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mo>)</m:mo></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup></m:mrow><m:mrow><m:msup><m:mrow><m:mi>c</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup></m:mrow></m:mfrac><m:mo>−</m:mo><m:mn>1</m:mn><m:mo>=</m:mo><m:mn>0.</m:mn><m:mspace linebreak="newline"/></m:mrow></m:mrow></m:math>
</div>
</section>
<section>
<h4 id="sec11"><a id="index_term1192"/><a id="index_term612"/><span class="blue">3D Curves from Implicit Surfaces</span></h4>
<p>One might hope that an implicit 3D curve could be created with the form <em>f</em> (<strong>p</strong>) = 0. However, all such curves are just degenerate surfaces and are rarely useful in practice. A 3D curve can be constructed from the intersection of two simultaneous implicit equations:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mi>f</m:mi><m:mrow><m:mo>(</m:mo><m:mtext>p</m:mtext><m:mo>)</m:mo><m:mo>=</m:mo><m:mn>0</m:mn><m:mo>,</m:mo></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>g</m:mi><m:mrow><m:mo>(</m:mo><m:mtext>p</m:mtext><m:mo>)</m:mo><m:mo>=</m:mo><m:mn>0.</m:mn></m:mrow></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p><a id="term-511"/><a id="term-587"/><a id="term-987"/><span aria-label="44" epub:type="pagebreak" id="pg_44" role="doc-pagebreak"/>For example, a 3D <a id="index_term699"/>line can be formed from the intersection of two implicit planes. Typically, it is more convenient to use <a id="index_term824"/><a id="index_term300"/>parametric curves instead; they are discussed in the following sections.</p>
</section>
</section>
<section>
<h3 id="sec2_7_6"><a id="index_term1295"/><span class="green">2.7.6 2D Parametric Curves</span></h3>
<p>A <em>parametric</em> curve is controlled by a single <em>parameter</em> that can be considered a sort of index that moves continuously along the curve. Such curves have the form</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mi>x</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>y</m:mi></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mo>=</m:mo><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mi>g</m:mi><m:mrow><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>h</m:mi><m:mrow><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mn>.</m:mn></m:mrow></m:mrow></m:mrow></m:math>
</div>
<p>Here, (<em>x, y</em>) is a point on the curve, and <em>t</em> is the parameter that influences the curve. For a given <em>t</em>, there will be some point determined by the functions <em>g</em> and <em>h</em>. For continuous <em>g</em> and <em>h</em>, a small change in <em>t</em> will yield a small change in <em>x</em> and <em>y</em>. Thus, as <em>t</em> continuously changes, points are swept out in a continuous curve. This is a nice feature because we can use the parameter <em>t</em> to explicitly construct points on the curve. Often, we can write a parametric curve in vector form,</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext>p</m:mtext><m:mo>=</m:mo><m:mi>f</m:mi><m:mrow><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo><m:mo>,</m:mo></m:mrow></m:mrow></m:math>
</div>
<p>where <em>f</em> is a vector-valued function, <span class="inline-formula"><m:math alttext=""><m:mrow><m:mi>f</m:mi><m:mo>:</m:mo><m:mtext>R</m:mtext><m:mo>→</m:mo><m:msup><m:mrow><m:mtext>R</m:mtext></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup></m:mrow></m:math></span>. Such vector functions can generate very clean code, so they should be used when possible.</p>
<p>We can think of the curve with a position as a function of time. The curve can go anywhere and could loop and cross itself. We can also think of the curve as having a velocity at any point. For example, the point <strong>p</strong>(<em>t</em>) is traveling slowly near <em>t</em> = <em>–</em>2 and quickly between <em>t</em> = 2 and <em>t</em> = 3. This type of “moving point” vocabulary is often used when discussing parametric curves even when the curve is not describing a moving point.</p>
</section>
<section>
<h3 id="sec12"><a id="index_term1296"/><a id="index_term826"/><span class="green">2D Parametric Lines</span></h3>
<p>A parametric line in 2D that passes through points <strong>p</strong><sub>0</sub> = (<em>x</em><sub>0</sub>, <em>y</em><sub>0</sub>) and <strong>p</strong><sub>1</sub> = (<em>x</em><sub>1</sub><em>,y</em><sub>1</sub>) can be written as</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mi>x</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>y</m:mi></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mo>=</m:mo><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mn>0</m:mn></m:mrow></m:msub><m:mo>+</m:mo><m:mi>t</m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mn>0</m:mn></m:mrow></m:msub><m:mo>)</m:mo></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mn>0</m:mn></m:mrow></m:msub><m:mo>+</m:mo><m:mi>t</m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mn>0</m:mn></m:mrow></m:msub><m:mo>)</m:mo></m:mrow></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mn>.</m:mn></m:mrow></m:mrow></m:mrow></m:math>
</div>
<p>Because the formulas for <em>x</em> and <em>y</em> have such similar structure, we can use the vector form for <strong>p</strong> = (<em>x, y</em>) (<a href="C07_chapter2.xhtml#f2_36">Figure 2.36</a>):</p>
<figure id="f2_36" tabindex="0">
<img alt="" src="../images/fig2_36.jpg"/>
<figcaption><p><span class="blue">Figure 2.36.</span> A 2D parametric line through <strong>p</strong><sub>0</sub> and <strong>p</strong><sub>1</sub>. The line segment defined by <em>t</em> ∈ [0,1] is shown in bold.</p></figcaption>
</figure>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext>p</m:mtext><m:mrow><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:msub><m:mrow><m:mtext>p</m:mtext></m:mrow><m:mrow><m:mn>0</m:mn></m:mrow></m:msub><m:mo>+</m:mo><m:mi>t</m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mtext>p</m:mtext></m:mrow><m:mrow><m:mn>1</m:mn></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mtext>p</m:mtext></m:mrow><m:mrow><m:mn>0</m:mn></m:mrow></m:msub><m:mo>)</m:mo></m:mrow><m:mn>.</m:mn></m:mrow></m:math>
</div>
<p><a id="term-986"/><span aria-label="45" epub:type="pagebreak" id="pg_45" role="doc-pagebreak"/>You can read this in geometric form as “start at point <strong>p</strong><sub>0</sub> and go some distance toward <strong>p</strong><sub>1</sub> determined by the parameter <em>t</em>.” A nice feature of this form is that <strong>p</strong>(0) = <strong>p</strong><sub>0</sub> and <strong>p</strong>(1) = <strong>p</strong><sub>1</sub>. Since the point changes linearly with <em>t</em>, the value of <em>t</em> between <strong>p</strong><sub>0</sub> and <strong>p</strong><sub>1</sub> measures the fractional distance between the points. Points with <em>t &lt;</em> 0 are to the “far” side of <strong>p</strong><sub>0</sub>, and points with <em>t &gt;</em> 1 are to the “far” side of <strong>p</strong><sub>1</sub>.</p>
<p>Parametric lines can also be described as just a point <strong>o</strong> and a vector <strong>d</strong>:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext>p</m:mtext><m:mrow><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mtext>o</m:mtext><m:mo>+</m:mo><m:mi>t</m:mi><m:mrow><m:mo>(</m:mo><m:mtext>d</m:mtext><m:mo>)</m:mo></m:mrow><m:mn>.</m:mn></m:mrow></m:mrow></m:math>
</div>
<p>When the vector <strong>d</strong> has unit length, the line is <em>arc-length parameterized</em>. This means <em>t</em> is an exact measure of distance along the line. Any parametric curve can be arc-length parameterized, which is obviously a very convenient form, but not all can be converted analytically.</p>
</section>
<section>
<h3 id="sec13"><a id="index_term823"/><span class="green">2D Parametric Circles</span></h3>
<p>A <a id="index_term146"/>circle with center (<em>x<sub>c</sub>,y<sub>c</sub></em>) and radius <em>r</em> has a parametric form:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mi>x</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>y</m:mi></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mo>=</m:mo><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:mi>r</m:mi><m:mtext> cos </m:mtext><m:mi>ϕ</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:mtext> </m:mtext><m:mi>r</m:mi><m:mo>⁢</m:mo><m:mtext> sin </m:mtext><m:mi>ϕ</m:mi></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mo>.</m:mo></m:mrow></m:mrow></m:mrow></m:math>
</div>
<p>To ensure that there is a unique parameter ϕ for every point on the curve, we can restrict its domain: ϕ ∈ [0, 2<em>π</em>) or ϕ ∈ (–π, π] or any other half-open interval of length 2<em>π</em>.</p>
<p>An axis-aligned ellipse can be constructed by scaling the <em>x</em> and <em>y</em> parametric equations separately:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mi>x</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>y</m:mi></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mo>=</m:mo><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:mi>a</m:mi><m:mtext> cos </m:mtext><m:mi>ϕ</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:mtext>b</m:mtext><m:mo>⁢</m:mo><m:mtext> sin </m:mtext><m:mi>ϕ</m:mi></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow></m:mrow><m:mn>.</m:mn></m:mrow></m:math>
</div>
</section>
<section>
<h3 id="sec2_7_7"><a id="index_term1196"/><span class="green">2.7.7 3D Parametric Curves</span></h3>
<p>A 3D parametric curve operates much like a 2D parametric curve:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mi>x</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mi>f</m:mi><m:mrow><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo><m:mo>,</m:mo></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>y</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mi>g</m:mi><m:mrow><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo><m:mo>,</m:mo></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>z</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mi>h</m:mi><m:mrow><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo><m:mn>.</m:mn></m:mrow></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>For example, a spiral around the <em>z</em>-axis is written as</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mi>x</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mtext>cos</m:mtext><m:mi>t</m:mi><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>y</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mtext>sin</m:mtext><m:mi>t</m:mi><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>z</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mi>t</m:mi><m:mn>.</m:mn></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p><a id="term-670"/><span aria-label="46" epub:type="pagebreak" id="pg_46" role="doc-pagebreak"/>As with 2D curves, the functions <em>f</em> , <em>g</em>, and <em>h</em> are defined on a domain <em>D</em> ⊂ R if we want to control where the curve starts and ends. In vector form, we can write</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mi>x</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>y</m:mi></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>z</m:mi></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mo>=</m:mo><m:mtext>p</m:mtext><m:mrow><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow><m:mn>.</m:mn></m:mrow></m:mrow></m:math>
</div>
<p>In this chapter, we only discuss 3D parametric lines in detail. General 3D parametric curves are discussed more extensively in <a href="C20_chapter15.xhtml#c15">Chapter 15</a>.</p>
<aside class="boxed-text" epub:type="sidebar">
<p class="noindent">The parametric curve is the range of <strong>p</strong>: ℝ → ℝ<sup>3</sup>.</p>
</aside>
<section>
<h4 id="sec14"><span class="blue">3D Parametric Lines</span></h4>
<p>A 3D parametric line can be written as a straightforward extension of the 2D parametric line, e.g.,</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mi>x</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mn>2</m:mn><m:mo>+</m:mo><m:mn>7</m:mn><m:mi>t</m:mi><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>y</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mn>1</m:mn><m:mo>+</m:mo><m:mn>2</m:mn><m:mi>t</m:mi><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>z</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mn>3</m:mn><m:mo>−</m:mo><m:mn>5</m:mn><m:mi>t</m:mi><m:mn>.</m:mn></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>This is cumbersome and does not translate well to code variables, so we will write it in vector form:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext>p</m:mtext><m:mo>=</m:mo><m:mtext>o</m:mtext><m:mo>+</m:mo><m:mi>t</m:mi><m:mtext>d,</m:mtext></m:mrow></m:math>
</div>
<p>where, for this example, <strong>o</strong> and <strong>d</strong> are given by</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mtext>o</m:mtext></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mo>,</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mn>3</m:mn><m:mo>)</m:mo><m:mo>,</m:mo></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:mtext>d</m:mtext></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:mo>(</m:mo><m:mn>7</m:mn><m:mo>,</m:mo><m:mn>2</m:mn><m:mo>,</m:mo><m:mo>−</m:mo><m:mn>5</m:mn><m:mo>)</m:mo><m:mn>.</m:mn></m:mrow></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>Note that this is very similar to the 2D case. The way to visualize this is to imagine that the line passes through <strong>o</strong> and is parallel to <strong>d</strong>. Given any value of <em>t</em>, you get some point <strong>p</strong>(<em>t</em>) on the line. For example, at <em>t</em> = 2, <em>p</em>(<em>t</em>) = (2, 1, 3) + 2(7, 2, <em>–</em>5) = (16, 5, <em>–</em>7) . This general concept is the same as for two dimensions (<a href="C07_chapter2.xhtml#f2_36">Figure 2.36</a>).</p>
<p>As in 2D, a <em>line segment</em> can be described by a 3D parametric line and an interval <em>t</em> ∈ [<em>t<sub>a</sub>,t<sub>b</sub></em>]. The line segment between two points <strong>a</strong> and <strong>b</strong> is given by <strong>p</strong>(<em>t</em>) = <strong>a</strong> + <em>t</em>(<strong>b</strong> <em>–</em> <strong>a</strong>) with <em>t</em> ∈ [0, 1]. Here, <strong>p</strong>(0) = <strong>a</strong>, <strong>p</strong>(1) = <strong>b</strong>, and <strong>p</strong>(0.5) = (<strong>a</strong> + <strong>b</strong>)<em>/</em>2, the midpoint between <strong>a</strong> and <strong>b</strong>.</p>
<p>A <em>ray</em>, or <em><a id="index_term513"/>half-line</em>, is a <a id="index_term1197"/>3D parametric line with a half-open interval, usually [0, ∞) . From now on, we will refer to all lines, <a id="index_term677"/>line segments, and rays as “rays.” This is sloppy, but corresponds to common usage and makes the discussion simpler.</p>
</section>
</section>
<section>
<h3 id="sec2_7_8"><a id="index_term1198"/><a id="term-217"/><a id="term-824"/><span aria-label="47" epub:type="pagebreak" id="pg_47" role="doc-pagebreak"/><span class="green">2.7.8 3D Parametric Surfaces</span></h3>
<p>The parametric approach can be used to define surfaces in 3D space in much the same way we define curves, except that there are two parameters to address the two-dimensional area of the surface. These surfaces have the form</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mi>x</m:mi><m:mo>=</m:mo><m:mi>f</m:mi><m:mrow><m:mo>(</m:mo><m:mi>u</m:mi><m:mo>,</m:mo><m:mi>v</m:mi><m:mo>)</m:mo><m:mo>,</m:mo></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mi>y</m:mi><m:mo>=</m:mo><m:mi>g</m:mi><m:mrow><m:mo>(</m:mo><m:mi>u</m:mi><m:mo>,</m:mo><m:mi>v</m:mi><m:mo>)</m:mo></m:mrow><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>z</m:mi><m:mo>=</m:mo><m:mi>h</m:mi><m:mrow><m:mo>(</m:mo><m:mi>u</m:mi><m:mo>,</m:mo><m:mi>v</m:mi><m:mo>)</m:mo><m:mo>,</m:mo></m:mrow></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>or, in vector form,</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mi>x</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>y</m:mi></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>z</m:mi></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mo>=</m:mo><m:mtext>p</m:mtext><m:mrow><m:mo>(</m:mo><m:mi>u</m:mi><m:mo>,</m:mo><m:mi>v</m:mi><m:mo>)</m:mo><m:mn>.</m:mn></m:mrow></m:mrow></m:mrow></m:math>
</div>
<aside class="boxed-text" epub:type="sidebar">
<p class="noindent">The parametric surface is the range of the function <strong>p</strong>: ℝ → ℝ<sup>3</sup>.</p>
</aside>
<aside class="boxed-text-e" epub:type="sidebar">
<p class="noindent1"><span class="blue">Example 1</span> For example, a point on the surface of the Earth can be described by the two parameters longitude and latitude. If we define the origin to be at the center of the Earth, and let <em>r</em> be the radius of the Earth, then a <a id="index_term1122"/>spherical <a id="index_term262"/>coordinate system centered at the origin (<a href="C07_chapter2.xhtml#f2_37">Figure 2.37</a>), lets us derive the parametric equations</p>
<div class="disp-formula" id="equ2_24">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mi>x</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mi>r</m:mi><m:mtext> cos </m:mtext><m:mi>ϕ</m:mi><m:mtext> sin </m:mtext><m:mi>θ</m:mi><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>y</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mi>r</m:mi><m:mtext> sin </m:mtext><m:mi>ϕ</m:mi><m:mtext> </m:mtext><m:mtext> sin </m:mtext><m:mi>θ</m:mi><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>z</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mi>r</m:mi><m:mtext> cos </m:mtext><m:mi>θ</m:mi><m:mn>.</m:mn></m:mtd></m:mtr></m:mtable></m:mrow><m:mspace width="3em"/><m:mo>(2.24)</m:mo></m:math>
</div>
<aside class="boxed-text" epub:type="sidebar">
<p class="noindent">Pretend for the sake of argument that the Earth is exactly spherical.</p>
</aside>
<aside class="boxed-text" epub:type="sidebar">
<p class="noindent">The θ and ϕ here may or may not seem reversed depending on your background; the use of these symbols varies across disciplines. In this book we will always assume the meaning of θ and ϕ used in Equation (2.24) and depicted in <a href="C07_chapter2.xhtml#f2_37">Figure 2.37</a>.</p>
</aside>
<p class="noindent">Ideally, we’d like to write this in vector form, but it isn’t feasible for this particular parametric form.</p>
<p>We would also like to be able to find the (<em>θ, ϕ</em>) for a given (<em>x, y, z</em>) . If we assume that ϕ ∈ (–π, π], this is easy to do using the <em>atan2</em> function from Equation (2.2):</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mi>θ</m:mi><m:mo>=</m:mo><m:mtext>acos</m:mtext><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>/</m:mo><m:msqrt><m:mrow><m:msup><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>+</m:mo><m:msup><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>+</m:mo><m:msup><m:mrow><m:mi>z</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup></m:mrow></m:msqrt><m:mo>)</m:mo><m:mo>,</m:mo></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>φ</m:mi><m:mo>=</m:mo><m:mtext>atan2</m:mtext><m:mrow><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>,</m:mo><m:mi>x</m:mi><m:mo>)</m:mo><m:mn>.</m:mn></m:mrow></m:mtd></m:mtr></m:mtable></m:mrow><m:mspace width="3em"/><m:mo>(2.25)</m:mo></m:math>
</div>
</aside>
<p class="indent">With implicit surfaces, the derivative of the function <em>f</em> gave us the surface normal. With <a id="index_term827"/>parametric surfaces, the derivatives of <strong>p</strong> also give information about the surface geometry.</p>
<p>Consider the function <strong>q</strong>(<em>t</em>) = <strong>p</strong>(<em>t, v</em><sub>0</sub>) . This function defines a parametric curve obtained by varying <em>u</em> while holding <em>v</em> fixed at the value <em>v</em><sub>0</sub>. This curve, called an <em><a id="index_term643"/>isoparametric curve</em> (or sometimes “isoparm” for short), lies in the surface. The derivative of <strong>q</strong> gives a vector <a id="index_term1154"/>tangent to the curve, and since the curve <span aria-label="48" epub:type="pagebreak" id="pg_48" role="doc-pagebreak"/>lies in the surface, the vector <strong>q</strong> also lies in the surface. Since it was obtained by varying one argument of <strong>p</strong>, the vector <strong>q</strong> is the partial derivative of <strong>p</strong> with respect to <em>u</em>, which we’ll denote <strong>p</strong><em><sub>u</sub></em>. A similar argument shows that the partial derivative <strong>p</strong><em><sub>v</sub></em> gives the tangent to the isoparametric curves for constant <em>u</em>, which is a second tangent vector to the surface.</p>
<figure id="f2_37" tabindex="0">
<img alt="" src="../images/fig2_37.jpg"/>
<figcaption><p><span class="blue">Figure 2.37.</span> The geometry for spherical coordinates.</p></figcaption>
</figure>
<p>The derivative of <strong>p</strong>, then, gives two tangent vectors at any point on the surface. The normal to the surface may be found by taking the cross product of these vectors: since both are tangent to the surface, their cross product, which is perpendicular to both tangents, is normal to the surface. The right-hand rule for cross products provides a way to decide which side is the front, or outside, of the surface; we will use the convention that the vector</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext>n</m:mtext><m:mo>=</m:mo><m:msub><m:mrow><m:mtext>p</m:mtext></m:mrow><m:mrow><m:mi>u</m:mi></m:mrow></m:msub><m:mo>×</m:mo><m:msub><m:mrow><m:mtext>p</m:mtext></m:mrow><m:mrow><m:mi>v</m:mi></m:mrow></m:msub></m:mrow></m:math>
</div>
<p>points toward the outside of the surface.</p>
</section>
<section>
<h3 id="sec2_7_9"><span class="green">2.7.9 Summary of Curves and Surfaces</span></h3>
<p>Implicit curves in 2D or surfaces in 3D are defined by scalar-valued functions of two or three variables, <em>f</em> : ℝ<sup>2</sup> → ℝ or <em>f</em> : ℝ<sup>3</sup> → ℝ, and the surface consists of all points where the function is zero:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mi>S</m:mi><m:mo>=</m:mo><m:mrow><m:mo>{</m:mo><m:mtext>p|f</m:mtext><m:mrow><m:mo>(</m:mo><m:mtext>p</m:mtext><m:mo>)</m:mo><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mo>}</m:mo><m:mn>.</m:mn></m:mrow></m:mrow></m:math>
</div>
<p>Parametric curves in 2D or 3D are defined by vector-valued functions of one variable, <strong>p</strong> : <em>D</em> ⊂ ℝ → ℝ<sup>2</sup> or <strong>p</strong> : <em>D</em> ⊂ ℝ → ℝ<sup>3</sup>, and the curve is swept out as <em>t</em> varies over all of <em>D</em>:</p>
<p>Parametric surfaces in 3D are defined by vector-valued functions of two variables, <strong>p</strong> : <em>D</em> ⊂ ℝ<sup>2</sup> → ℝ<sup>3</sup>, and the surface consists of the images of all points (<em>u, v</em>) in the domain:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mi>S</m:mi><m:mo>=</m:mo><m:mrow><m:mo>{</m:mo><m:mtext>p</m:mtext><m:mrow><m:mo>(</m:mo><m:mi>u</m:mi><m:mo>,</m:mo><m:mi>v</m:mi><m:mo>)</m:mo></m:mrow><m:mo>|</m:mo><m:mrow><m:mo>(</m:mo><m:mi>u</m:mi><m:mo>,</m:mo><m:mi>v</m:mi><m:mo>)</m:mo><m:mo>∈</m:mo><m:mi>D</m:mi></m:mrow><m:mo>}</m:mo><m:mn>.</m:mn></m:mrow></m:mrow></m:math>
</div>
<p>For implicit curves and surfaces, the normal vector is given by the derivative of <em>f</em> (the gradient), and the tangent vector (for a curve) or vectors (for a surface) can be derived from the normal by constructing a basis.</p>
<p>For parametric curves and surfaces, the derivative of <strong>p</strong> gives the tangent vector (for a curve) or vectors (for a surface), and the normal vector can be derived from the tangents by constructing a basis.</p>
</section>
</section>
<section>
<h2 id="sec2_8"><span aria-label="49" epub:type="pagebreak" id="pg_49" role="doc-pagebreak"/><a epub:type="backlink" href="C02a_toc.xhtml#rsec2_8" role="doc-backlink"><span class="green">2.8 Linear Interpolation</span></a></h2>
<p>Perhaps the most common mathematical operation in graphics is <em>linear interpolation</em>. We have already seen an example of linear interpolation of position to form line segments in 2D and 3D, where two points <strong>a</strong> and <strong>b</strong> are associated with a parameter <em>t</em> to form the line <strong>p</strong> = (1 <em>–</em> <em>t</em>)<strong>a</strong> + <em>t</em><strong>b</strong>. Thisis <em>interpolation</em> because <strong>p</strong> goes through <strong>a</strong> and <strong>b</strong> exactly at <em>t</em> = 0 and <em>t</em> = 1. Itis <em>linear</em> interpolation because the weighting terms <em>t</em> and 1 <em>–</em> <em>t</em> are linear polynomials of <em>t</em>.</p>
<p>Another common linear interpolation is among a set of positions on the <em>x-</em>axis: <em>x</em><sub>0</sub>, <em>x</em><sub>1</sub>, <em>...</em>, <em>x<sub>n</sub></em>, and for each <em>x<sub>i</sub></em>, we have an associated height, <em>y<sub>i</sub></em>. We want to create a continuous function <em>y</em> = <em>f</em> (<em>x</em>) that interpolates these positions, so that <em>f</em> goes through every data point, i.e., <em>f</em> (<em>x<sub>i</sub></em>) = <em>y<sub>i</sub></em>. For linear interpolation, the points (<em>x<sub>i</sub>,y<sub>i</sub></em>) are connected by straight line segments. It is natural to use parametric line equations for these segments. The parameter <em>t</em> is just the fractional distance between <em>x<sub>i</sub></em> and <em>x<sub>i</sub></em><sub>+1</sub>:</p>
<div class="disp-formula" id="equ2_26">
<m:math alttext=""><m:mrow><m:mi>f</m:mi><m:mrow><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>i</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:mfrac><m:mrow><m:mi>x</m:mi><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>i</m:mi></m:mrow></m:msub></m:mrow><m:mrow><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>i</m:mi></m:mrow></m:msub></m:mrow></m:mfrac></m:mrow><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>i</m:mi></m:mrow></m:msub><m:mo>)</m:mo><m:mn>.</m:mn></m:mrow></m:mrow><m:mspace width="3em"/><m:mo>(2.26)</m:mo></m:math>
</div>
<p>Because the weighting functions are linear polynomials of <em>x</em>, this is linear interpolation.</p>
<p>The two examples above have the common form of <a id="index_term691"/>linear interpolation. We create a variable <em>t</em> that varies from 0 to 1 as we move from data item <em>A</em> to data item <em>B</em>. Intermediate values are just the function (1 <em>–</em> <em>t</em>)<em>A</em> + <em>tB</em>. Notice that Equation (2.26) has this form with</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mi>t</m:mi><m:mo>=</m:mo><m:mfrac><m:mrow><m:mi>x</m:mi><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>i</m:mi></m:mrow></m:msub></m:mrow><m:mrow><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>i</m:mi></m:mrow></m:msub></m:mrow></m:mfrac><m:mn>.</m:mn></m:mrow></m:math>
</div>
</section>
<section>
<h2 id="sec2_9"><a id="index_term1281"/><a epub:type="backlink" href="C02a_toc.xhtml#rsec2_9" role="doc-backlink"><span class="green">2.9 Triangles</span></a></h2>
<p>Triangles in both 2D and 3D are the fundamental modeling primitive in many graphics programs. Often information such as color is tagged onto triangle vertices, and this information is interpolated across the triangle. The <a id="index_term263"/>coordinate system that makes such <a id="index_term630"/>interpolation straightforward is called <em><a id="index_term71"/>barycentric coordinates</em>; we will develop these from scratch. We will also discuss 2D triangles, which must be understood before we can draw their pictures on 2D screens.</p>
<section>
<h3 id="sec2_9_1"><a id="term-977"/><a id="term-978"/><a id="term-989"/><span aria-label="50" epub:type="pagebreak" id="pg_50" role="doc-pagebreak"/><span class="green">2.9.1 2D Triangles</span></h3>
<p>If we have a 2D triangle defined by 2D points <strong>a</strong>, <strong>b</strong>, and <strong>c</strong>, we can first find its area:</p>
<div class="disp-formula" id="equ2_27">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mtext>Area</m:mtext></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mfrac><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:mfrac><m:mrow><m:mo>|</m:mo><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mtd></m:mtr></m:mtable></m:mtd><m:mtd><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr></m:mtable><m:mo>|</m:mo></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mfrac><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>)</m:mo><m:mn>.</m:mn></m:mrow></m:mtd></m:mtr></m:mtable><m:mspace width="10.0em"/><m:mo>(2.27)</m:mo></m:mrow></m:math>
</div>
<p>The derivation of this formula can be found in <a href="C11_chapter6.xhtml#sec6_3">Section 6.3</a>. This area will have a positive sign if the points <strong>a</strong>, <strong>b</strong>,and <strong>c</strong> are in counterclockwise order and a negative sign, otherwise.</p>
<p>Often in graphics, we wish to assign a property, such as color, at each triangle vertex and smoothly interpolate the value of that property across the triangle. There are a variety of ways to do this, but the simplest is to use <em>barycentric</em> coordinates. One way to think of barycentric coordinates is as a nonorthogonal coordinate system as was discussed briefly in <a href="C07_chapter2.xhtml#sec2_4_2">Section 2.4.2</a>. Such a coordinate system is shown in <a href="C07_chapter2.xhtml#f2_38">Figure 2.38</a>, where the coordinate origin is <strong>a</strong> and the vectors from <strong>a</strong> to <strong>b</strong> and <strong>c</strong> are the basis vectors. With that origin and those basis vectors, any point <strong>p</strong> can be written as</p>
<div class="disp-formula" id="equ2_28">
<m:math alttext=""><m:mrow><m:mtext>p</m:mtext><m:mo>=</m:mo><m:mtext>a</m:mtext><m:mo>+</m:mo><m:mi>β</m:mi><m:mrow><m:mo>(</m:mo><m:mtext>b</m:mtext><m:mo>−</m:mo><m:mtext>a</m:mtext><m:mo>)</m:mo><m:mo>+</m:mo><m:mi>γ</m:mi><m:mrow><m:mo>(</m:mo><m:mtext>c</m:mtext><m:mo>−</m:mo><m:mtext>a</m:mtext><m:mo>)</m:mo><m:mn>.</m:mn></m:mrow></m:mrow></m:mrow><m:mspace width="3em"/><m:mo>(2.28)</m:mo></m:math>
</div>
<figure id="f2_38" tabindex="0">
<img alt="" src="../images/fig2_38.jpg"/>
<figcaption><p><span class="blue">Figure 2.38.</span> A <a id="index_term1298"/><a id="index_term1283"/>2D triangle with vertices <strong>a</strong>, <strong>b</strong>, <strong>c</strong> can be used to set up a nonorthogonal coordinate system with origin <strong>a</strong> and basis vectors (<strong>b</strong> – <strong>a</strong>) and (<strong>c</strong> – <strong>a</strong>). A point is then represented by an ordered pair (<em>β, γ</em>) . For example, the point <strong>p</strong> = (2.0, 0.5), i.e., <strong>p</strong> = <strong>a</strong> +2.0 (<strong>b</strong> – <strong>a</strong>)+0.5(<strong>c</strong> – <strong>a).</strong></p></figcaption>
</figure>
<p><span aria-label="51" epub:type="pagebreak" id="pg_51" role="doc-pagebreak"/>Note that we can reorder the terms in Equation (2.28) to get</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext>p</m:mtext><m:mo>=</m:mo><m:mrow><m:mo>(</m:mo><m:mn>1</m:mn><m:mo>−</m:mo><m:mi>β</m:mi><m:mo>−</m:mo><m:mi>γ</m:mi><m:mo>)</m:mo><m:mtext>a</m:mtext><m:mo>+</m:mo><m:mi>β</m:mi><m:mtext>b</m:mtext><m:mo>+</m:mo><m:mi>γ</m:mi><m:mtext>c.</m:mtext></m:mrow></m:mrow></m:math>
</div>
<p>Often people define a new variable α to improve the symmetry of the equations:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mi>α</m:mi><m:mo>≡</m:mo><m:mn>1</m:mn><m:mo>−</m:mo><m:mi>β</m:mi><m:mo>−</m:mo><m:mi>γ</m:mi><m:mo>,</m:mo></m:mrow></m:math>
</div>
<p>which yields the equation</p>
<div class="disp-formula" id="equ2_29">
<m:math alttext=""><m:mrow><m:mtext>p</m:mtext><m:mrow><m:mo>(</m:mo><m:mi>α</m:mi><m:mo>,</m:mo><m:mi>β</m:mi><m:mo>,</m:mo><m:mi>γ</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>α</m:mi><m:mtext>a</m:mtext><m:mo>+</m:mo><m:mi>β</m:mi><m:mtext>b</m:mtext><m:mo>+</m:mo><m:mi>γ</m:mi><m:mtext>c,</m:mtext></m:mrow></m:mrow><m:mspace width="3em"/><m:mo>(2.29)</m:mo></m:math>
</div>
<p>with the constraint that</p>
<div class="disp-formula" id="equ2_30">
<m:math alttext=""><m:mrow><m:mi>α</m:mi><m:mo>+</m:mo><m:mi>β</m:mi><m:mo>+</m:mo><m:mi>γ</m:mi><m:mo>=</m:mo><m:mn>1.</m:mn></m:mrow><m:mspace width="3em"/><m:mo>(2.30)</m:mo></m:math>
</div>
<p class="indent">Barycentric coordinates seem like an abstract and unintuitive construct at first, but they turn out to be powerful and convenient. You may find it useful to think of how street addresses would work in a city where there are two sets of parallel streets, but where those sets are not at right angles. The natural system would essentially be barycentric coordinates, and you would quickly get used to them. Barycentric coordinates are defined for all points on the plane. A particularly nice feature of barycentric coordinates is that a point <strong>p</strong> is inside the triangle formed by <strong>a</strong>, <strong>b</strong>,and <strong>c</strong> if and only if</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mn>0</m:mn><m:mo>&lt;</m:mo><m:mi>α</m:mi><m:mo>&lt;</m:mo><m:mn>1</m:mn><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0</m:mn><m:mo>&lt;</m:mo><m:mi>β</m:mi><m:mo>&lt;</m:mo><m:mn>1</m:mn><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mn>0</m:mn><m:mo>&lt;</m:mo><m:mi>γ</m:mi><m:mo>&lt;</m:mo><m:mn>1.</m:mn></m:mtd></m:mtr><m:mtr><m:mtd/></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd/></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>If one of the coordinates is zero and the other two are between zero and one, then you are on an edge. If two of the coordinates are zero, then the other is one, and you are at a vertex. Another nice property of barycentric coordinates is that Equation (2.29) in effect mixes the coordinates of the three vertices in a smooth way. The same mixing coefficients (<em>α, β, γ</em>) can be used to mix other properties, such as color, as we will see in the next chapter.</p>
<p>Given a point <strong>p</strong>, how do we compute its barycentric coordinates? One way is to write Equation (2.28) as a linear system with unknowns <em>β</em> and <em>γ</em>,solve,andset α = 1 <em>–</em> <em>β</em> <em>–</em> <em>γ</em> . That linear system is</p>
<div class="disp-formula" id="equ2_31">
<m:math alttext=""><m:mrow><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mtd></m:mtr></m:mtable></m:mtd><m:mtd><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mtd></m:mtr></m:mtable></m:mtd><m:mtd><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:mi>β</m:mi></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>γ</m:mi></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo></m:mrow></m:mrow><m:mo>=</m:mo><m:mrow><m:mo>[</m:mo><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>p</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>p</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mtd></m:mtr></m:mtable><m:mo>]</m:mo><m:mn>.</m:mn></m:mrow></m:mrow><m:mspace width="3em"/><m:mo>(2.31)</m:mo></m:math>
</div>
<p><a id="term-37"/><a id="term-966"/><span aria-label="52" epub:type="pagebreak" id="pg_52" role="doc-pagebreak"/>Although it is straightforward to solve Equation (2.31) algebraically, it is often fruitful to compute a direct geometric solution.</p>
<p>One geometric property of <a id="index_term72"/>barycentric coordinates is that they are the signed scaled distance from the lines through the triangle sides, as is shown for <em>β</em> in <a href="C07_chapter2.xhtml#f2_39">Figure 2.39</a>. Recall from <a href="C07_chapter2.xhtml#sec2_7_2">Section 2.7.2</a> that evaluating the equation <em>f</em> (<em>x, y</em>) for the line <em>f</em> (<em>x, y</em>) = 0 returns the scaled signed distance from (<em>x, y</em>) to the line. Also recall that if <em>f</em> (<em>x, y</em>) = 0 is the equation for a particular line, so is <em>kf</em> (<em>x, y</em>) = 0 for any nonzero <em>k</em>. Changing <em>k</em> scales the distance and controls which side of the line has positive signed distance, and which negative. We would like to choose <em>k</em> such that, for example, <em>kf</em> (<em>x, y</em>) = <em>β</em>. Since <em>k</em> is only one unknown, we can force this with one constraint, namely, that at point <strong>b</strong>, we know <em>β</em> = 1. So if the line <em>f<sub>ac</sub></em>(<em>x, y</em>) = 0 goes through both <strong>a</strong> and <strong>c</strong>, then we can compute <em>β</em> for a point (<em>x, y</em>) as follows:</p>
<div class="disp-formula" id="equ2_32">
<m:math alttext=""><m:mrow><m:mi>β</m:mi><m:mo>=</m:mo><m:mfrac><m:mrow><m:msub><m:mrow><m:mi>f</m:mi></m:mrow><m:mrow><m:mi>a</m:mi><m:mi>c</m:mi></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>,</m:mo><m:mi>y</m:mi><m:mo>)</m:mo></m:mrow></m:mrow><m:mrow><m:msub><m:mrow><m:mi>f</m:mi></m:mrow><m:mrow><m:mi>a</m:mi><m:mi>c</m:mi></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>,</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>)</m:mo></m:mrow></m:mrow></m:mfrac><m:mo>,</m:mo></m:mrow><m:mspace width="3em"/><m:mo>(2.32)</m:mo></m:math>
</div>
<p>and we can compute <em>γ</em> and α in a similar fashion. For efficiency, it is usually wise to compute only two of the barycentric coordinates directly and to compute the third using Equation (2.30).</p>
<p>To find this “ideal” form for the line through <strong>p</strong><sub>0</sub> and <strong>p</strong><sub>1</sub>, we can first use the technique of <a href="C07_chapter2.xhtml#sec2_7_2">Section 2.7.2</a> to find <em>some</em> valid implicit lines through the vertices. Equation (2.17) gives us</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:msub><m:mrow><m:mi>f</m:mi></m:mrow><m:mrow><m:mi>a</m:mi><m:mo>,</m:mo><m:mi>b</m:mi></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>,</m:mo><m:mi>y</m:mi><m:mo>)</m:mo><m:mo>≡</m:mo><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>)</m:mo><m:mi>x</m:mi><m:mo>+</m:mo><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mo>)</m:mo><m:mi>y</m:mi><m:mo>+</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mo>=</m:mo><m:mn>0.</m:mn></m:mrow></m:mrow></m:mrow></m:mrow></m:math>
</div>
<p>Note that <em>f<sub>ab</sub></em>(<em>x<sub>c</sub>,y<sub>c</sub></em>) probably does not equal one, so it is probably not the ideal form we seek. By dividing through by <em>f<sub>ab</sub></em>(<em>x<sub>c</sub>,y<sub>c</sub></em>) ,weget</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mi>γ</m:mi><m:mo>=</m:mo><m:mfrac><m:mrow><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>)</m:mo><m:mi>x</m:mi><m:mo>+</m:mo><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mo>)</m:mo><m:mi>y</m:mi><m:mo>+</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mrow></m:mrow></m:mrow><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>)</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:mo>(</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>)</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mrow></m:mfrac><m:mn>.</m:mn></m:mrow></m:math>
</div>
<figure id="f2_39" tabindex="0">
<img alt="" src="../images/fig2_39.jpg"/>
<figcaption><p><span class="blue">Figure 2.39.</span> The barycentric coordinate <em>β</em> is the signed scaled distance from the line through <strong>a</strong> and <strong>c</strong>.</p></figcaption>
</figure>
<p>The presence of the division might worry us because it introduces the possibility of divide-by-zero, but this cannot occur for triangles with areas that are not near zero. There are analogous formulas for α and <em>β</em>, but typically only one is needed:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mi>β</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mfrac><m:mrow><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mo>)</m:mo><m:mi>x</m:mi><m:mo>+</m:mo><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mo>)</m:mo><m:mi>y</m:mi><m:mo>+</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mrow></m:mrow></m:mrow><m:mrow><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mo>)</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:mrow><m:mo>(</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mo>)</m:mo><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>+</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mo>−</m:mo><m:msub><m:mrow><m:mi>x</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:msub><m:mrow><m:mi>y</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mrow></m:mrow></m:mrow></m:mfrac><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>α</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mn>1</m:mn><m:mo>−</m:mo><m:mi>β</m:mi><m:mo>−</m:mo><m:mi>γ</m:mi><m:mn>.</m:mn></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>Another way to compute barycentric coordinates is to compute the areas <em>A<sub>a</sub></em>, <em>A<sub>b</sub></em>, and <em>A<sub>c</sub></em>, of subtriangles as shown in <a href="C07_chapter2.xhtml#f2_40">Figure 2.40</a>. Barycentric coordinates obey</p>
<figure id="f2_40" tabindex="0">
<img alt="" src="../images/fig2_40.jpg"/>
<figcaption><p><span class="blue">Figure 2.40.</span> The barycentric coordinates are proportional to the areas of the three subtriangles shown.</p></figcaption>
</figure>
<p><a id="term-967"/><span aria-label="53" epub:type="pagebreak" id="pg_53" role="doc-pagebreak"/>the rule</p>
<div class="disp-formula" id="equ2_33">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mi>α</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:msub><m:mrow><m:mi>A</m:mi></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub><m:mo>/</m:mo><m:mi>A</m:mi><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>β</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:msub><m:mrow><m:mi>A</m:mi></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub><m:mo>/</m:mo><m:mi>A</m:mi><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>γ</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:msub><m:mrow><m:mi>A</m:mi></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub><m:mo>/</m:mo><m:mi>A</m:mi><m:mo>,</m:mo></m:mtd></m:mtr></m:mtable></m:mrow><m:mspace width="3em"/><m:mo>(2.33)</m:mo></m:math>
</div>
<p>where <em>A</em> is the area of the triangle. Note that <em>A</em> = <em>A<sub>a</sub></em> + <em>A<sub>b</sub></em> + <em>A<sub>c</sub></em>, so it can be computed with two additions rather than a full area formula. This rule still holds for points outside the triangle if the areas are allowed to be signed. The reason for this is shown in <a href="C07_chapter2.xhtml#f2_41">Figure 2.41</a>. Note that these are signed areas and will be computed correctly as long as the same signed area computation is used for both <em>A</em> and the subtriangles <em>A<sub>a</sub></em>, <em>A<sub>b</sub></em>,and <em>A<sub>c</sub></em>.</p>
<figure id="f2_41" tabindex="0">
<img alt="" src="../images/fig2_41.jpg"/>
<figcaption><p><span class="blue">Figure 2.41.</span> The area of the two triangles shown is half base times height and are thus the same, as is any triangle with a vertex on the β = 0.5 line. The height and thus the area is proportional to β.</p></figcaption>
</figure>
</section>
<section>
<h3 id="sec2_9_2"><a id="index_term1282"/><a id="index_term1205"/><span class="green">2.9.2 3D Triangles</span></h3>
<p>One wonderful thing about barycentric coordinates is that they extend almost transparently to 3D. If we assume the points <strong>a</strong>, <strong>b</strong>, and <strong>c</strong> are 3D, then we can still use the representation</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext>p</m:mtext><m:mo>=</m:mo><m:mrow><m:mo>(</m:mo><m:mn>1</m:mn><m:mo>−</m:mo><m:mi>β</m:mi><m:mo>−</m:mo><m:mi>γ</m:mi><m:mo>)</m:mo><m:mtext>a</m:mtext><m:mo>+</m:mo><m:mi>β</m:mi><m:mtext>b</m:mtext><m:mo>+</m:mo><m:mi>γ</m:mi><m:mtext>c.</m:mtext></m:mrow></m:mrow></m:math>
</div>
<p>Now, as we vary <em>β</em> and <em>γ</em>, we sweep out a plane.</p>
<p>The normal vector to a triangle can be found by taking the cross product of any two vectors in the plane of the triangle (<a href="C07_chapter2.xhtml#f2_42">Figure 2.42</a>). It is easiest to use two of the three edges as these vectors, for example,</p>
<div class="disp-formula" id="equ2_34">
<m:math alttext=""><m:mrow><m:mtext>n</m:mtext><m:mo>=</m:mo><m:mrow><m:mo>(</m:mo><m:mtext>b</m:mtext><m:mo>−</m:mo><m:mtext>a</m:mtext><m:mo>)</m:mo><m:mo>×</m:mo><m:mrow><m:mo>(</m:mo><m:mtext>c</m:mtext><m:mo>−</m:mo><m:mtext>a</m:mtext><m:mo>)</m:mo><m:mn>.</m:mn></m:mrow></m:mrow></m:mrow><m:mspace width="3em"/><m:mo>(2.34)</m:mo></m:math>
</div>
<p>Note that this normal vector is not necessarily of unit length, and it obeys the right-hand rule of cross products.</p>
<figure id="f2_42" tabindex="0">
<img alt="" src="../images/fig2_42.jpg"/>
<figcaption><p><span class="blue">Figure 2.42.</span> The normal vector of the triangle is perpendicular to all vectors in the plane of the triangle, and thus perpendicular to the edges of the triangle.</p></figcaption>
</figure>
<p>The area of the triangle can be found by taking the length of the cross product:</p>
<div class="disp-formula" id="equ2_35">
<m:math alttext=""><m:mrow><m:mtext>area</m:mtext><m:mo>=</m:mo><m:mfrac><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:mfrac><m:mrow><m:mo>‖</m:mo><m:mrow><m:mo>(</m:mo><m:mtext>b</m:mtext><m:mo>−</m:mo><m:mtext>a</m:mtext><m:mo>)</m:mo><m:mo>×</m:mo><m:mrow><m:mo>(</m:mo><m:mtext>c</m:mtext><m:mo>−</m:mo><m:mtext>a</m:mtext><m:mo>)</m:mo></m:mrow></m:mrow><m:mo>‖</m:mo><m:mn>.</m:mn></m:mrow></m:mrow><m:mspace width="3em"/><m:mo>(2.35)</m:mo></m:math>
</div>
<p>Note that this is <em>not</em> a signed area, so it cannot be used directly to evaluate barycentric coordinates. However, we can observe that a triangle with a “clockwise” vertex order will have a normal vector that points in the opposite direction to the normal of a triangle in the same plane with a “counterclockwise” vertex order. Recall that</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtext>a</m:mtext><m:mo>·</m:mo><m:mtext>b</m:mtext><m:mo>=</m:mo><m:mrow><m:mo>‖</m:mo><m:mtext>a</m:mtext><m:mo>‖</m:mo><m:mtext> </m:mtext><m:mrow><m:mo>‖</m:mo><m:mtext>b</m:mtext><m:mo>‖</m:mo><m:mtext> cos </m:mtext><m:mi>ϕ</m:mi></m:mrow></m:mrow><m:mo>,</m:mo></m:mrow></m:math>
</div>
<p><span aria-label="54" epub:type="pagebreak" id="pg_54" role="doc-pagebreak"/>where ϕ is the angle between the vectors. If <strong>a</strong> and <strong>b</strong> are parallel, then cos ϕ = ±1, and this gives a test of whether the vectors point in the same or opposite directions. This, along with Equations (2.33)–(2.35), suggest the formulas</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mtable><m:mtr><m:mtd><m:mi>α</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mfrac><m:mrow><m:mtext>n</m:mtext><m:mo>·</m:mo><m:msub><m:mrow><m:mtext>n</m:mtext></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mrow><m:mrow><m:msup><m:mrow><m:mo>‖</m:mo><m:mtext>n</m:mtext><m:mo>‖</m:mo></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup></m:mrow></m:mfrac><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>β</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mfrac><m:mrow><m:mtext>n</m:mtext><m:mo>·</m:mo><m:msub><m:mrow><m:mtext>n</m:mtext></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub></m:mrow><m:mrow><m:msup><m:mrow><m:mo>‖</m:mo><m:mtext>n</m:mtext><m:mo>‖</m:mo></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup></m:mrow></m:mfrac><m:mo>,</m:mo></m:mtd></m:mtr><m:mtr><m:mtd><m:mi>γ</m:mi></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mfrac><m:mrow><m:mtext>n</m:mtext><m:mo>·</m:mo><m:msub><m:mrow><m:mtext>n</m:mtext></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub></m:mrow><m:mrow><m:msup><m:mrow><m:mo>‖</m:mo><m:mtext>n</m:mtext><m:mo>‖</m:mo></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup></m:mrow></m:mfrac><m:mo>,</m:mo></m:mtd></m:mtr></m:mtable></m:mrow></m:math>
</div>
<p>where <strong>n</strong> is Equation (2.34) evaluated with vertices <strong>a</strong>, <strong>b</strong>, and <strong>c</strong>; <strong>n</strong><em><sub>a</sub></em> is Equation (2.34) evaluated with vertices <strong>b</strong>, <strong>c</strong>,and <strong>p</strong>, and so on, i.e.,</p>
<div class="disp-formula" id="equ2_36">
<m:math alttext=""><m:mrow><m:mtext> </m:mtext><m:mtable><m:mtr><m:mtd><m:msub><m:mrow><m:mtext>n</m:mtext></m:mrow><m:mrow><m:mi>a</m:mi></m:mrow></m:msub></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mrow><m:mo>(</m:mo><m:mtext>c</m:mtext><m:mo>−</m:mo><m:mtext>b</m:mtext><m:mo>)</m:mo><m:mo>×</m:mo><m:mrow><m:mo>(</m:mo><m:mtext>p</m:mtext><m:mo>−</m:mo><m:mtext>b</m:mtext><m:mo>)</m:mo><m:mo>,</m:mo></m:mrow></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mtext>n</m:mtext></m:mrow><m:mrow><m:mi>b</m:mi></m:mrow></m:msub></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mrow><m:mo>(</m:mo><m:mtext>a</m:mtext><m:mo>−</m:mo><m:mtext>c</m:mtext><m:mo>)</m:mo><m:mo>×</m:mo><m:mrow><m:mo>(</m:mo><m:mtext>p</m:mtext><m:mo>−</m:mo><m:mtext>c</m:mtext><m:mo>)</m:mo><m:mo>,</m:mo></m:mrow></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:msub><m:mrow><m:mtext>n</m:mtext></m:mrow><m:mrow><m:mi>c</m:mi></m:mrow></m:msub></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd><m:mrow><m:mo>(</m:mo><m:mtext>b</m:mtext><m:mo>−</m:mo><m:mtext>a</m:mtext><m:mo>)</m:mo><m:mo>×</m:mo><m:mrow><m:mo>(</m:mo><m:mtext>p</m:mtext><m:mo>−</m:mo><m:mtext>a</m:mtext><m:mo>)</m:mo><m:mn>.</m:mn></m:mrow></m:mrow></m:mtd></m:mtr></m:mtable></m:mrow><m:mspace width="3em"/><m:mo>(2.36)</m:mo></m:math>
</div>
</section>
</section>
<section>
<h2 id="sec2_10"><a id="index_term336"/><a id="index_term899"/><a epub:type="backlink" href="C02a_toc.xhtml#rsec2_10" role="doc-backlink"><span class="green">2.10 Discrete probability</span></a></h2>
<p>Probability studies things that include random outcomes and discrete probability refers to when there is a finite number of random outcomes. A classic example is a six-sided die, where the die takes on a random value from <em>{</em>1, 2, 3, 4, 5, 6<em>}</em>,where when you roll it, each outcome comes with equal probability. The probability of a certain outcome is the fraction of time that outcome happens. The fraction that something happens at all is 1. Each roll comes up one sixth of the time.</p>
<p>One of the more confusing things about randomness is distinguishing between a random outcome that either hasn’t happened (or happened and we don’t know the outcome) and a die after it has been rolled. A <em>random variable</em> is a single value that does not have a known value, but will on one from a known set of possibilities with a known likelihood. The term “variable” here comes from math and directly related to “variable” in programming. An example of a random variable is <em>X</em>, where “<em>X</em> = the eventual outcome of the die.” The variable could use any symbol; capital <em>X</em> is often used as a random variable symbol in math in the same way “i” and “j” are often used for loop variables in computer science. Computer programs have a pretty direct use of <a id="index_term932"/>random variables:</p>
<pre class="pre">int X = rand_from(1,6)</pre>
<p><span aria-label="55" epub:type="pagebreak" id="pg_55" role="doc-pagebreak"/>where <em>X</em> a variable where we don’t know the value, but we do know that when we run the program, we will get one of six values each with a probability of one sixth, and this corresponds directly to the case of a random variable “<em>X</em> = the eventual outcome of the die.” There are two properties of random variables that are used all the time: <em>expected value</em> and <em>variance</em>. Expected value, sometimes called <em>expectation</em>, of a random variable <em>X</em>, often denied <em>EX</em> or <em>E</em>(<em>X</em>) , might better be called “expected average value,” but it isn’t so don’t say that or it will confuse people who know the standard terminology. This is just the average value that <em>X</em> takes on under all parallel universes where “the die is rolled.” This can be computed by multiplying each outcome by its probability and adding:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mi>E</m:mi><m:mi>X</m:mi><m:mo>=</m:mo><m:mfrac><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>6</m:mn></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>1</m:mn><m:mo>)</m:mo><m:mo>+</m:mo><m:mfrac><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>6</m:mn></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mo>)</m:mo><m:mo>+</m:mo><m:mfrac><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>6</m:mn></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>3</m:mn><m:mo>)</m:mo><m:mo>+</m:mo><m:mfrac><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>6</m:mn></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>4</m:mn><m:mo>)</m:mo><m:mo>+</m:mo><m:mfrac><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>6</m:mn></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>5</m:mn><m:mo>)</m:mo><m:mo>+</m:mo><m:mfrac><m:mrow><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>6</m:mn></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>6</m:mn><m:mo>)</m:mo><m:mo>=</m:mo><m:mn>3.5</m:mn></m:mrow></m:mrow></m:mrow></m:mrow></m:mrow></m:mrow></m:mrow></m:math>
</div>
<p>So if we averaged a lot of dice rolls, we would “expect” a value around 3.5. This saying “I expect the die to come up 3.5” is not the nonsense it sounds when you know it can’t come up anything but a whole number, but the terminology is perhaps unfortunate. The terminology is quite standard across fields so despite its flaws, just try to internalize it and you will have no problems communicated with people from other fields about this topic.</p>
<p>Expected value tells us where a random variable will trend, but it doesn’t tell us how long that trend will take to occur nor how much it oscillates away from its average. For example, a die that had 3 ones and 3 sixes would still have an <a id="index_term353"/>expected value of 3.5, but the “deviation from the mean” would be larger than on a conventional die. So how do we measure the magnitude of variation? One would be to measure the average deviation form 3.5, but if we include signs that average deviation is zero because the <em>–</em>2.5 of rolling 1 cancels out the +2.5 deviation of rolling 6. We could take the absolute difference but that has practical problems (algebra including absolute values is challenging) and some theoretical issues. In practice people prefer average squared deviation and call it variance:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mi>V</m:mi><m:mrow><m:mo>(</m:mo><m:mi>X</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mrow><m:mtext>average</m:mtext><m:mrow><m:mo>(</m:mo><m:msup><m:mrow><m:mo>(</m:mo><m:mi>X</m:mi><m:mo>−</m:mo><m:mi>E</m:mi><m:mi>X</m:mi><m:mo>)</m:mo></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>)</m:mo></m:mrow></m:mrow></m:mrow></m:mrow></m:math>
</div>
<p>Because it is statistical, that average is an <a id="index_term352"/>expectation, so</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mi>V</m:mi><m:mrow><m:mo>(</m:mo><m:mi>X</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>E</m:mi><m:mrow><m:msup><m:mrow><m:mo>(</m:mo><m:mrow><m:mo>(</m:mo><m:mi>X</m:mi><m:mo>−</m:mo><m:mi>E</m:mi><m:mrow><m:mo>(</m:mo><m:mi>X</m:mi><m:mo>)</m:mo></m:mrow><m:mo>)</m:mo></m:mrow></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>)</m:mo></m:mrow></m:mrow></m:mrow></m:math>
</div>
<p>For the case of the die, <em>E</em>(<em>X</em>) = 3.5, and the values of <em>X</em> <em>–E</em>(<em>X</em>) are <em>–</em>2.5, <em>–</em>1.5, <em>–</em>.5, .5, 1.5, 2.5, and the values of (<em>X</em> <em>–</em> <em>E</em>(<em>X</em>))<sup>2</sup> are thus 6.25, 2.25, 0.25, 0.25, 2.25, 6.25, and thus, variance of X, often denoted, is 17.5/6.</p>
<p>An algebraic manipulation of the <a id="index_term1304"/>variance formula yields a sometimes more convenient form:</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mi>V</m:mi><m:mrow><m:mo>(</m:mo><m:mi>X</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>E</m:mi><m:mrow><m:mo>(</m:mo><m:msup><m:mrow><m:mi>X</m:mi></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup><m:mo>)</m:mo><m:mo>−</m:mo><m:msup><m:mrow><m:mi>E</m:mi><m:mrow><m:mo>(</m:mo><m:mi>X</m:mi><m:mo>)</m:mo></m:mrow></m:mrow><m:mrow><m:mn>2</m:mn></m:mrow></m:msup></m:mrow></m:mrow></m:mrow></m:math>
</div>
<p><span aria-label="56" epub:type="pagebreak" id="pg_56" role="doc-pagebreak"/>There are some algebraic niceties to expectation and variance that get used a lot. For example, suppose we have two random variables X and Y and define a variable <em>Z</em> = <em>X</em> + <em>Y</em> . What is E(<em>Z</em>)? It turns out</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mi>E</m:mi><m:mrow><m:mo>(</m:mo><m:mi>Z</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mi>E</m:mi><m:mrow><m:mo>(</m:mo><m:mi>X</m:mi><m:mo>+</m:mo><m:mi>Y</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mi>E</m:mi><m:mrow><m:mo>(</m:mo><m:mi>X</m:mi><m:mo>)</m:mo></m:mrow><m:mo>+</m:mo><m:mi>E</m:mi><m:mrow><m:mo>(</m:mo><m:mi>Y</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math>
</div>
<p>An amazing thing is that even if X and Y are not “statistically independent” (so for the case of our dice, they might influence each other somehow). In an extreme example, we can look at the first die and just set the second die to the same as the first. Still we would have the formula apply! This is very powerful and is often used as an unstated property in programs.</p>
<p>The variance has the same behavior but only if X and Y are independent.</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mi>V</m:mi><m:mrow><m:mo>(</m:mo><m:mi>Z</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mi>V</m:mi><m:mrow><m:mo>(</m:mo><m:mi>X</m:mi><m:mo>+</m:mo><m:mi>Y</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mi>V</m:mi><m:mrow><m:mo>(</m:mo><m:mi>X</m:mi><m:mo>)</m:mo></m:mrow><m:mo>+</m:mo><m:mi>V</m:mi><m:mrow><m:mo>(</m:mo><m:mi>Y</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math>
</div>
<p>A counterexample that shows this formula does not necessarily apply for dependent X and Y, assume you roll X and then just set Y to be the opposite side of that die, so for X = 1 choose Y = 6, and if X = 2 choose Y = 5, and for X = 3 choose Y = 4, etc. The value of Z will always be 7, and thus, the variance is zero. But the variance of X is 0 and clearly not 2(17.5 / 6) as the independent sum would yield.</p>
<p>One disadvantage of variance is that it is not very intuitive because of the squaring. So people often use the square root of the variance, called the standard deviation, usually denoted sigma(X). So</p>
<div class="disp-formula">
<m:math alttext=""><m:mrow><m:mi>σ</m:mi><m:mrow><m:mo>(</m:mo><m:mi>X</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:msqrt><m:mrow><m:mi>V</m:mi><m:mrow><m:mo>(</m:mo><m:mi>X</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:msqrt></m:mrow></m:mrow></m:math>
</div>
<p>There are no nice formulas for <em>σ</em>(<em>X</em> + <em>Y</em> ) , so the appeal of variance, where there are nice formulas, becomes more obvious. Note that for the die example, the standard deviation <span class="inline-formula"><m:math alttext=""><m:mrow><m:mo>=</m:mo><m:msqrt><m:mrow><m:mn>17.5</m:mn><m:mo>/</m:mo><m:mn>6</m:mn></m:mrow></m:msqrt><m:mo>≈</m:mo><m:mn>1.7</m:mn></m:mrow></m:math></span>. This is “around” the average distance from the mean of 3.5, but is slightly different as the actual mean absolute distance is 1.5. So while in practice it is almost always not dangerous intuition to think of standard deviation as average absolute deviation, it is good to keep at least in the back of your mind they are different.</p>
</section>
<section>
<h2 id="sec2_11"><a id="index_term898"/><a id="index_term237"/><a epub:type="backlink" href="C02a_toc.xhtml#rsec2_11" role="doc-backlink"><span class="green">2.11 Continuous probability</span></a></h2>
<p>In graphics, we often use random variables that can take on a range of values. These are usually called continuous random variables. The good news is almost everything about discrete random variables carries over: the terminology, the expected value definition and formulas, and variance definition and formulas. There <span aria-label="57" epub:type="pagebreak" id="pg_57" role="doc-pagebreak"/>is however, a big difference: the probability of a continuous random variable taking on any particular value is zero. Suppose you have a uniform random variable X that is between 0 and 10:</p>
<pre class="pre">X = continuous_random_from(-2.3, 10.9).</pre>
<p class="noindent">The probability of getting the value 1.7 or <em>π</em> or <em>e</em> is all equally likely. The trouble is getting exactly 1.7 has a probability of zero.</p>
<p>The good news is density functions solve this problem. Just like the case of joules per second, we can use probability per length for the 1D case. In the example above of <span class="monospace">X = continuous random from(-2.3, 10.9)</span>, the dimension over which we measure the probability is length. If the length is in some unspecified unit and we just know the zero to ten range, then we would say the probability is measured “per unit length.”</p>
</section>
<section>
<h2 id="sec2_12"><a id="index_term752"/><a epub:type="backlink" href="C02a_toc.xhtml#rsec2_12" role="doc-backlink"><span class="green">2.12 Monte Carlo Integration</span></a></h2>
<p><a href="C07_chapter2.xhtml#sec2_5">Section 2.5</a> discussed how to “read” an integral and abstracted it away as an “integrate()” function. But how do we actually implement that function? The most common way in graphics is to use <em>Monte Carlo Integration</em>. The algebra for Monte Carlo Integration is often ugly and intimidating. But if we look at this function:</p>
<pre class="pre">float shade = average(f(), hemisphere)</pre>
<p>Our intuition would find the right answer. Pick a bunch on random points <em>v<sub>i</sub></em> on the hemisphere and evaluate <em>f</em> (<em>v<sub>i</sub></em>) and average them, for example:</p>
<pre class="pre">float sum = 0.0<br/>N = 10000; // or some other big number the user sets<br/>For (int i = 1 to N)<br/>    vec3 v = random_point_on_hemisphere()<br/>    sum = sum + f(v)<br/>Average = sum / N </pre>
<p>It really is that easy! Now you need a function to pick random points on the unit hemisphere. The simplest method is a “rejection method” that first picks points uniformly in the unit ball by repeatedly picking three random numbers uniformly in a unit cube:</p>
<pre class="pre">do<br/>  X = random_from(-1,1)<span aria-label="58" epub:type="pagebreak" id="pg_58" role="doc-pagebreak"/><br/>  Y = random_from(-1,1)<br/>  Z = random_from(-1,1)<br/>while (x^2 + y^2 + z^2 &gt; 1)</pre>
<p>And then flip the <em>Z</em> if needed to be in the half-ball:</p>
<pre class="pre">If (Z &lt; 0) Z = -Z</pre>
<p class="noindent">Then, project the point onto the unit hemisphere</p>
<pre class="pre">v = unit_vector(X, Y, Z).</pre>
<p class="noindent">That is a way to handle an average. But what about a general integral? Recall that</p>
<pre class="pre">average(f(), domain) = integrate(f(), domain) /<br/>                        integrate(1, domain)</pre>
<p class="noindent">So</p>
<pre class="pre">integrate(f(), domain)) = average(f(), domain)*<br/>                          integrate(1, domain)</pre>
<p class="noindent">In the case of a hemisphere, integrate(1, domain) is just the area, which is 2<em>π</em>.</p>
<p>So Monte Carlo integration often is an average of random points times a constant (the size of the domain– length, area, etc.).</p>
<section>
<h3 id="sec2_12_1"><a id="index_term613"/><span class="green">2.12.1 Importance Sampling</span></h3>
<p>When a function we want to take a random average of has a wide variation in its high and low values, it can be to our advantage to concentrate samples in some areas and then correct for the nonuniformity with weights. The probability density functions give us the right tool for that: if we know the PDF of a sample, that is a direct measure of how “oversampled” that region is. If we use nonuniform samples, then we can get thus</p>
<pre class="pre">integrate = average_of_nonuniform_samples(f()/p(),<br/>            domain).</pre>
<p class="noindent">A neat thing about this formula is it also works for uniform random samples. In that case, the PDF <span class="monospace">p() = 1/ integrate(1, domain)</span> so the “size” of the domain is encoded in the PDF.</p>
<p>For any given Monte Carlo importance sampling problem, there is a pretty formulaic approach we follow, at least to get started:</p>
<ol class="list-order">
<li>
<p class="list"><span aria-label="59" epub:type="pagebreak" id="pg_59" role="doc-pagebreak"/>Identify what is the function <em>f</em> () and the domain of integration (e.g., points on the unit sphere or points on a triangle).</p>
</li>
<li>
<p class="list">Pick a method for generating random samples <em>x<sub>i</sub></em> on that domain, and make sure there is a way to evaluate the PDF <em>p</em>(<em>x<sub>i</sub></em>) for each sample.</p>
</li>
<li>
<p class="list">Average the ratio <em>f</em> (<em>x<sub>i</sub></em>)<em>/p</em>(<em>x<sub>i</sub></em>) for many <em>x<sub>i</sub></em>. This is our estimate of the integral.</p>
</li>
</ol>
<p>A neat thing is that <em>any</em> <em>p</em>() can be used and you will converge to the right answer (with the caveat that where <em>f</em> () is nonzero <em>p</em>() must be nonzero). Which <em>p</em>() you use merely influences how fast your estimate converges. So we usually start with a constant <em>p</em>() for debugging our code.</p>
</section>
</section>
<section>
<h2 id="sec15"><span class="green">Frequently Asked Questions</span></h2>
<ul class="list-bullet">
<li>
<p class="list"><span class="green">Why isn’t there vector division?</span></p>
<p class="noindent1b">It turns out that there is no “nice” analogy of division for vectors. However, it is possible to motivate the quaternions by examining this question in detail (see Hoffmann’s book referenced in the chapter notes).</p>
</li>
<li>
<p class="list"><span class="green">Is there something as clean as barycentric coordinates for polygons with more than three sides?</span></p>
<p class="noindent1b">Unfortunately, there is not. Even convex quadrilaterals are much more complicated. This is one reason triangles are such a common geometric primitive in graphics.</p>
</li>
<li>
<p class="list"><span class="green">Is there an implicit form for 3D lines?</span></p>
<p class="noindent1b">No. However, the intersection of two 3D planes defines a 3D line, so a 3D line can be described by two simultaneous implicit 3D equations.</p>
</li>
<li>
<p class="list"><span class="green">How is quasi–Monte Carlo (QMC) or blue noise sampling related to Monte Carlo sampling?</span></p>
<p class="noindent1b">The core idea of Monte Carlo is you can average a bunch of “fair” samples to estimate a true average. Here, fair can be framed in a statistical sense. But some sample sets can also be shown to be “fair” even if they are not random. One such set are quasi–Monte Carlo and have obvious deterministic structure which <span aria-label="60" epub:type="pagebreak" id="pg_60" role="doc-pagebreak"/>is not random, but is uniform in a formal sense that is not statistical, and these sets often improve convergence over random ones. Blue noise sample sets add constraints on the samples to avoid clumping, and like QMC sets can improve convergence without being fully random. In practice, most techniques are developed using Monte Carlo formalisms because the math is more tractable, and then, QMC or blue noise points are inserted in the code with the empirical confidence that uniformity is all that is needed in practice.</p>
</li>
</ul>
</section>
<section>
<h2 id="sec16"><span class="green">Notes</span></h2>
<p>The history of vector analysis is particularly interesting. It was largely invented by Grassmann in the mid-1800s but was ignored and reinvented later (Crowe, 1994). Grassman now has a following in the graphics field of researchers who are developing <em>Geometric Algebra</em> based on some of his ideas (Doran &amp; Lasenby, 2003). Readers interested in why the particular scalar and vector products are in some sense the right ones, and why we do not have a commonly used vector division, will find enlightenment in the concise <em>About Vectors</em> (Hoffmann, 1975). Another important geometric tool is the <em>quaternion</em> invented by Hamilton in the mid-1800s. Quaternions are useful in many situations, but especially where orientations are concerned (Hanson, 2005).</p>
</section>
<section>
<h2 id="sec17"><span class="green">Exercises</span></h2>
<p class="qpara"><span class="green">1.</span> The <em>cardinality</em> of a set is the number of elements it contains. Under IEEE floating-point representation (<a href="C06_chapter1.xhtml#sec1_5">Section 1.5</a>), what is the cardinality of the <em>floats</em>?</p>
<p class="qpara"><span class="green">2.</span> Is it possible to implement a function that maps 32-bit integers to 64-bit integers that has a well-defined inverse? Do all functions from 32-bit integers to 64-bit integers have well-defined inverses?</p>
<p class="qpara"><span class="green">3.</span> Specify the unit cube (<em>x</em>-, <em>y</em>-, and <em>z</em>-coordinates all between 0 and 1 inclusive) in terms of the Cartesian product of three intervals.</p>
<p class="qpara"><span class="green">4.</span> If you have access to the natural log function ln(<em>x</em>) , specify how you could use it to implement a log(<em>b, x</em>) function where <em>b</em> is the base of the log. What should the function do for negative <em>b</em> values? Assume an IEEE floating-point implementation.</p>
<p class="qpara"><span class="green">5.</span> <span aria-label="61" epub:type="pagebreak" id="pg_61" role="doc-pagebreak"/>Solve the quadratic equation 2<em>x</em><sup>2</sup> +6<em>x</em> +4 = 0.</p>
<p class="qpara"><span class="green">6.</span> Implement a function that takes in coefficients <em>A</em>, <em>B</em>,and <em>C</em> for the quadratic equation <em>Ax</em><sup>2</sup> + <em>Bx</em> + <em>C</em> = 0 and computes the two solutions. Have the function return the number of valid (not NaN) solutions and fill in the return arguments so the smaller of the two solutions is first.</p>
<p class="qpara"><span class="green">7.</span> Show that the two forms of the quadratic formula on page 17 are equivalent (assuming exact arithmetic) and explain how to choose one for each root in order to avoid subtracting nearly equal floating-point numbers, which leads to loss of precision.</p>
<p class="qpara"><span class="green">8.</span> Show by counterexample that it is not always true that for 3D vectors <strong>a</strong>, <strong>b</strong>, and <strong>c</strong>, <strong>a</strong> × (<strong>b</strong> × <strong>c</strong>) = (<strong>a</strong> × <strong>b</strong>) × <strong>c</strong>.</p>
<p class="qpara"><span class="green">9.</span> Given the nonparallel 3D vectors <strong>a</strong> and <strong>b</strong>, compute a right-handed orthonormal basis such that <strong>u</strong> is parallel to <strong>a</strong> and <strong>v</strong> is in the plane defined by <strong>a</strong> and <strong>b</strong>.</p>
<p class="qpara1"><span class="green">10.</span> What is the gradient of <em>f</em> (<em>x, y, z</em>) = <em>x</em><sup>2</sup> + <em>y</em> <em>–</em> 3<em>z</em><sup>3</sup>?</p>
<p class="qpara1"><span class="green">11.</span> What is a parametric form for the axis-aligned 2D ellipse?</p>
<p class="qpara1"><span class="green">12.</span> What is the implicit equation of the plane through 3D points (1, 0, 0) , (0, 1, 0) , and (0, 0, 1) ? What is the parametric equation? What is the normal vector to this plane?</p>
<p class="qpara1"><span class="green">13.</span> Given four 2D points <strong>a</strong><sub>0</sub>, <strong>a</strong><sub>1</sub>, <strong>b</strong><sub>0</sub>, and <strong>b</strong><sub>1</sub>, design a robust procedure to determine whether the line segments <strong>a</strong><sub>0</sub><strong>a</strong><sub>1</sub> and <strong>b</strong><sub>0</sub><strong>b</strong><sub>1</sub> intersect.</p>
<p class="qpara1"><span class="green">14.</span> Design a robust procedure to compute the barycentric coordinates of a 2D point with respect to three 2D non-collinear points.</p>
<p class="qpara1"><span class="green">15.</span> Calculate the various 1D integrals from introductory calculus, and vary the number of samples. How quickly do the answer converge as the number of samples is increased?</p>
</section>
</section>
</body>
</html>