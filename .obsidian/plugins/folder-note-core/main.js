/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source visit the plugins github repository
*/

var Pe=Object.create;var S=Object.defineProperty;var ye=Object.getOwnPropertyDescriptor;var ke=Object.getOwnPropertyNames,ie=Object.getOwnPropertySymbols,Ae=Object.getPrototypeOf,le=Object.prototype.hasOwnProperty,Ee=Object.prototype.propertyIsEnumerable;var se=(i,e,t)=>e in i?S(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,M=(i,e)=>{for(var t in e||(e={}))le.call(e,t)&&se(i,t,e[t]);if(ie)for(var t of ie(e))Ee.call(e,t)&&se(i,t,e[t]);return i};var ae=i=>S(i,"__esModule",{value:!0});var q=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),xe=(i,e)=>{ae(i);for(var t in e)S(i,t,{get:e[t],enumerable:!0})},Ie=(i,e,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of ke(e))!le.call(i,r)&&r!=="default"&&S(i,r,{get:()=>e[r],enumerable:!(t=ye(e,r))||t.enumerable});return i},T=i=>Ie(ae(S(i!=null?Pe(Ae(i)):{},"default",i&&i.__esModule&&"default"in i?{get:()=>i.default,enumerable:!0}:{value:i,enumerable:!0})),i);var w=(i,e,t)=>new Promise((r,n)=>{var l=a=>{try{s(t.next(a))}catch(c){n(c)}},o=a=>{try{s(t.throw(a))}catch(c){n(c)}},s=a=>a.done?r(a.value):Promise.resolve(a.value).then(l,o);s((t=t.apply(i,e)).next())});var X=q(W=>{"use strict";Object.defineProperty(W,"__esModule",{value:!0});function de(i,e){if(e)return i;throw new Error("Unhandled discriminated union member: "+JSON.stringify(i))}W.assertNever=de;W.default=de});var R=q((fe,B)=>{(function(i,e){"use strict";typeof define=="function"&&define.amd?define(e):typeof B=="object"&&B.exports?B.exports=e():i.log=e()})(fe,function(){"use strict";var i=function(){},e="undefined",t=typeof window!==e&&typeof window.navigator!==e&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"];function n(f,g){var v=f[g];if(typeof v.bind=="function")return v.bind(f);try{return Function.prototype.bind.call(v,f)}catch(m){return function(){return Function.prototype.apply.apply(v,[f,arguments])}}}function l(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function o(f){return f==="debug"&&(f="log"),typeof console===e?!1:f==="trace"&&t?l:console[f]!==void 0?n(console,f):console.log!==void 0?n(console,"log"):i}function s(f,g){for(var v=0;v<r.length;v++){var m=r[v];this[m]=v<f?i:this.methodFactory(m,f,g)}this.log=this.debug}function a(f,g,v){return function(){typeof console!==e&&(s.call(this,g,v),this[f].apply(this,arguments))}}function c(f,g,v){return o(f)||a.apply(this,arguments)}function F(f,g,v){var m=this,ne,E="loglevel";typeof f=="string"?E+=":"+f:typeof f=="symbol"&&(E=void 0);function Ce(h){var I=(r[h]||"silent").toUpperCase();if(!(typeof window===e||!E)){try{window.localStorage[E]=I;return}catch(_){}try{window.document.cookie=encodeURIComponent(E)+"="+I+";"}catch(_){}}}function oe(){var h;if(!(typeof window===e||!E)){try{h=window.localStorage[E]}catch(Le){}if(typeof h===e)try{var I=window.document.cookie,_=I.indexOf(encodeURIComponent(E)+"=");_!==-1&&(h=/^([^;]+)/.exec(I.slice(_))[1])}catch(Le){}return m.levels[h]===void 0&&(h=void 0),h}}m.name=f,m.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},m.methodFactory=v||c,m.getLevel=function(){return ne},m.setLevel=function(h,I){if(typeof h=="string"&&m.levels[h.toUpperCase()]!==void 0&&(h=m.levels[h.toUpperCase()]),typeof h=="number"&&h>=0&&h<=m.levels.SILENT){if(ne=h,I!==!1&&Ce(h),s.call(m,h,f),typeof console===e&&h<m.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+h},m.setDefaultLevel=function(h){oe()||m.setLevel(h,!1)},m.enableAll=function(h){m.setLevel(m.levels.TRACE,h)},m.disableAll=function(h){m.setLevel(m.levels.SILENT,h)};var Y=oe();Y==null&&(Y=g??"WARN"),m.setLevel(Y,!1)}var d=new F,N={};d.getLogger=function(g){if(typeof g!="symbol"&&typeof g!="string"||g==="")throw new TypeError("You must supply a name when creating a logger.");var v=N[g];return v||(v=N[g]=new F(g,d.getLevel(),d.methodFactory)),v};var C=typeof window!==e?window.log:void 0;return d.noConflict=function(){return typeof window!==e&&window.log===d&&(window.log=C),d},d.getLoggers=function(){return N},d.default=d,d})});var H=q((Ue,pe)=>{"use strict";function k(i){if(typeof i!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(i))}function he(i,e){for(var t="",r=0,n=-1,l=0,o,s=0;s<=i.length;++s){if(s<i.length)o=i.charCodeAt(s);else{if(o===47)break;o=47}if(o===47){if(!(n===s-1||l===1))if(n!==s-1&&l===2){if(t.length<2||r!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){var a=t.lastIndexOf("/");if(a!==t.length-1){a===-1?(t="",r=0):(t=t.slice(0,a),r=t.length-1-t.lastIndexOf("/")),n=s,l=0;continue}}else if(t.length===2||t.length===1){t="",r=0,n=s,l=0;continue}}e&&(t.length>0?t+="/..":t="..",r=2)}else t.length>0?t+="/"+i.slice(n+1,s):t=i.slice(n+1,s),r=s-n-1;n=s,l=0}else o===46&&l!==-1?++l:l=-1}return t}function Oe(i,e){var t=e.dir||e.root,r=e.base||(e.name||"")+(e.ext||"");return t?t===e.root?t+r:t+i+r:r}var O={resolve:function(){for(var e="",t=!1,r,n=arguments.length-1;n>=-1&&!t;n--){var l;n>=0?l=arguments[n]:(r===void 0&&(r=process.cwd()),l=r),k(l),l.length!==0&&(e=l+"/"+e,t=l.charCodeAt(0)===47)}return e=he(e,!t),t?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(k(e),e.length===0)return".";var t=e.charCodeAt(0)===47,r=e.charCodeAt(e.length-1)===47;return e=he(e,!t),e.length===0&&!t&&(e="."),e.length>0&&r&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return k(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,t=0;t<arguments.length;++t){var r=arguments[t];k(r),r.length>0&&(e===void 0?e=r:e+="/"+r)}return e===void 0?".":O.normalize(e)},relative:function(e,t){if(k(e),k(t),e===t||(e=O.resolve(e),t=O.resolve(t),e===t))return"";for(var r=1;r<e.length&&e.charCodeAt(r)===47;++r);for(var n=e.length,l=n-r,o=1;o<t.length&&t.charCodeAt(o)===47;++o);for(var s=t.length,a=s-o,c=l<a?l:a,F=-1,d=0;d<=c;++d){if(d===c){if(a>c){if(t.charCodeAt(o+d)===47)return t.slice(o+d+1);if(d===0)return t.slice(o+d)}else l>c&&(e.charCodeAt(r+d)===47?F=d:d===0&&(F=0));break}var N=e.charCodeAt(r+d),C=t.charCodeAt(o+d);if(N!==C)break;N===47&&(F=d)}var f="";for(d=r+F+1;d<=n;++d)(d===n||e.charCodeAt(d)===47)&&(f.length===0?f+="..":f+="/..");return f.length>0?f+t.slice(o+F):(o+=F,t.charCodeAt(o)===47&&++o,t.slice(o))},_makeLong:function(e){return e},dirname:function(e){if(k(e),e.length===0)return".";for(var t=e.charCodeAt(0),r=t===47,n=-1,l=!0,o=e.length-1;o>=1;--o)if(t=e.charCodeAt(o),t===47){if(!l){n=o;break}}else l=!1;return n===-1?r?"/":".":r&&n===1?"//":e.slice(0,n)},basename:function(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');k(e);var r=0,n=-1,l=!0,o;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var s=t.length-1,a=-1;for(o=e.length-1;o>=0;--o){var c=e.charCodeAt(o);if(c===47){if(!l){r=o+1;break}}else a===-1&&(l=!1,a=o+1),s>=0&&(c===t.charCodeAt(s)?--s==-1&&(n=o):(s=-1,n=a))}return r===n?n=a:n===-1&&(n=e.length),e.slice(r,n)}else{for(o=e.length-1;o>=0;--o)if(e.charCodeAt(o)===47){if(!l){r=o+1;break}}else n===-1&&(l=!1,n=o+1);return n===-1?"":e.slice(r,n)}},extname:function(e){k(e);for(var t=-1,r=0,n=-1,l=!0,o=0,s=e.length-1;s>=0;--s){var a=e.charCodeAt(s);if(a===47){if(!l){r=s+1;break}continue}n===-1&&(l=!1,n=s+1),a===46?t===-1?t=s:o!==1&&(o=1):t!==-1&&(o=-1)}return t===-1||n===-1||o===0||o===1&&t===n-1&&t===r+1?"":e.slice(t,n)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return Oe("/",e)},parse:function(e){k(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;var r=e.charCodeAt(0),n=r===47,l;n?(t.root="/",l=1):l=0;for(var o=-1,s=0,a=-1,c=!0,F=e.length-1,d=0;F>=l;--F){if(r=e.charCodeAt(F),r===47){if(!c){s=F+1;break}continue}a===-1&&(c=!1,a=F+1),r===46?o===-1?o=F:d!==1&&(d=1):o!==-1&&(d=-1)}return o===-1||a===-1||d===0||d===1&&o===a-1&&o===s+1?a!==-1&&(s===0&&n?t.base=t.name=e.slice(1,a):t.base=t.name=e.slice(s,a)):(s===0&&n?(t.name=e.slice(1,o),t.base=e.slice(1,a)):(t.name=e.slice(s,o),t.base=e.slice(s,a)),t.ext=e.slice(o,a)),s>0?t.dir=e.slice(0,s-1):n&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};O.posix=O;pe.exports=O});xe(exports,{default:()=>re});var Te=T(X()),ee=T(R());function ue(i,e){let t=Object.keys(e).map(r=>De(i,r,e[r]));return t.length===1?t[0]:function(){t.forEach(r=>r())}}function De(i,e,t){let r=i[e],n=i.hasOwnProperty(e),l=t(r);return r&&Object.setPrototypeOf(l,r),Object.setPrototypeOf(o,l),i[e]=o,s;function o(...a){return l===r&&i[e]===o&&s(),l.apply(this,a)}function s(){i[e]===o&&(n?i[e]=r:delete i[e]),l!==r&&(l=r,Object.setPrototypeOf(o,r||Function))}}var be=T(require("obsidian"));var x=T(require("obsidian"));var u;(function(r){r[r.Index=0]="Index",r[r.Inside=1]="Inside",r[r.Outside=2]="Outside"})(u||(u={}));var ge=i=>{let{createFolderForNote:e,LinkToParentFolder:t,DeleteLinkedFolder:r,DeleteNoteAndLinkedFolder:n}=i.resolver;i.addCommand({id:"make-doc-folder-note",name:"Make current document folder note",checkCallback:l=>{var s;let o=(s=i.app.workspace.activeLeaf)==null?void 0:s.view;if(l)return o instanceof x.MarkdownView;e(o.file)},hotkeys:[]}),i.addCommand({id:"link-to-parent-folder",name:"Link to Parent Folder",checkCallback:l=>{var s;let o=(s=i.app.workspace.activeLeaf)==null?void 0:s.view;return t(o.file,l)},hotkeys:[]}),i.addCommand({id:"delete-linked-folder",name:"Delete linked folder",checkCallback:l=>{var s;let o=(s=i.app.workspace.activeLeaf)==null?void 0:s.view;return o instanceof x.MarkdownView?r(o.file,l):!1},hotkeys:[]}),i.addCommand({id:"delete-with-linked-folder",name:"Delete note and linked folder",checkCallback:l=>{var s;let o=(s=i.app.workspace.activeLeaf)==null?void 0:s.view;return o instanceof x.MarkdownView?n(o.file,l):!1},hotkeys:[]}),i.registerEvent(i.app.workspace.on("file-menu",(l,o,s)=>w(void 0,null,function*(){o instanceof x.TFile&&o.extension==="md"&&(t(o,!0)&&l.addItem(a=>a.setIcon("link").setTitle("Link to Parent Folder").onClick(()=>t(o))),(yield e(o,!0))&&l.addItem(a=>a.setIcon("create-new").setTitle("Make Doc Folder Note").onClick(()=>{e(o),i.app.workspace.openLinkText(o.path,"",!1)})),s!=="link-context-menu"&&n(o,!0)&&l.addItem(a=>a.setIcon("trash").setTitle("Delete Note and Linked Folder").onClick(()=>n(o))))})))},ce=i=>{let{DeleteFolderNote:e,CreateFolderNote:t,DeleteNoteAndLinkedFolder:r}=i.resolver;i.registerEvent(i.app.workspace.on("file-menu",(n,l,o)=>{l instanceof x.TFolder&&(e(l,!0)&&n.addItem(s=>s.setIcon("trash").setTitle("Delete Folder Note").onClick(()=>e(l))),i.settings.folderNotePref===u.Outside&&i.settings.deleteOutsideNoteWithFolder===!1&&r(l,!0)&&n.addItem(s=>s.setIcon("trash").setTitle("Delete Folder and Folder Note").onClick(()=>r(l))),t(l,!0)&&n.addItem(s=>s.setIcon("create-new").setTitle("Create Folder Note").onClick(()=>t(l))))}))};var j=T(X()),A=T(R()),P=T(require("obsidian")),y=T(H());var Fe=T(R()),U=T(require("obsidian")),z=T(H()),L=i=>typeof i=="string"?i.endsWith(".md"):i.extension==="md",me=(i,e)=>{let t=V(i.path);return t&&(0,z.join)(t,e)},V=i=>{if(i==="/")return null;let e=(0,z.dirname)(i);return e==="."?"/":e},$=(i,e,t)=>{if(i instanceof U.TFile)e(i);else if(i instanceof U.TFolder)t(i);else throw Fe.default.error("unexpected TAbstractFile type",i),new Error("unexpected TAbstractFile type")};var G=class{constructor(e){this.getFolderFromNote=(e,t)=>{if(!L(e))return null;let r=this.getFolderPath(e,!1,t);if(!r)return null;let n=this.vault.getAbstractFileByPath(r);return n&&n instanceof P.TFolder?n:null};this.getFolderPath=(e,t=!1,r)=>{var s,a;if(r===void 0&&(r=this.settings.folderNotePref),!L(e))return A.default.info("getFolderPath(%o): given file not markdown",e),null;let n,l;if(e instanceof P.TFile?(l=e.basename,n=(s=V(e.path))!=null?s:""):(l=(0,y.basename)(e).slice(0,-3),n=(a=V(e))!=null?a:""),!n)return A.default.info("getFolderPath(%o): no folder note for root dir",e),null;let o=()=>n==="/"?l:(0,y.join)(n,l);switch(r){case u.Index:return t?o():l===this.settings.indexName?n:(A.default.info("getFolderPath(%o): note name invaild",e),null);case u.Inside:return t?o():l===(0,y.basename)(n)?n:(A.default.info("getFolderPath(%o): note name invaild",e),null);case u.Outside:{let c=o();return t||l===(0,y.basename)(c)?c:(A.default.info("getFolderPath(%o): note name invaild",e),null)}default:(0,j.default)(r)}};this.getFolderNote=(e,t)=>this.findFolderNote(this.getFolderNotePath(e,t));this.findFolderNote=e=>{if(!e)return null;let t=this.vault.getAbstractFileByPath(e.path);return t&&t instanceof P.TFile?t:null};this.getFolderNotePath=(e,t)=>{t===void 0&&(t=this.settings.folderNotePref);let r=typeof e=="string"?e:e.path,n=V(r);if(!n)return null;let{indexName:l}=this.settings,o,s;switch(t){case u.Index:s=l,o=r;break;case u.Inside:s=(0,y.basename)(r),o=r;break;case u.Outside:s=(0,y.basename)(r),o=n;break;default:(0,j.default)(t)}return{dir:o,name:s+".md",path:o==="/"?s+".md":(0,y.join)(o,s+".md")}};this.DeleteLinkedFolder=(e,t=!1)=>{if(!L(e))return!1;let r=this.getFolderFromNote(e);return r&&!t&&this.vault.delete(r,!0),!!r};this.LinkToParentFolder=(e,t=!1)=>{if(!L(e))return!1;if(e.parent){let r=this.getFolderNotePath(e.parent),n=r&&!this.getFolderNote(e.parent);if(n&&!t){let{path:l}=r;this.vault.rename(e,l)}return!!n}else return!1};this.DeleteNoteAndLinkedFolder=(e,t=!1)=>{let r,n;if(e instanceof P.TFile){if(!L(e))return!1;r=e,n=this.getFolderFromNote(e)}else r=this.getFolderNote(e),n=e;return r&&n&&!t&&new ve(this.plugin,r,n).open(),!!(r&&n)};this.createFolderForNote=(e,t=!1)=>w(this,null,function*(){if(!L(e))return!1;let r=this.getFolderPath(e,!1);if(r&&(yield this.vault.exists(r)))return A.default.info("createFolderForNote(%o): already folder note",e,e.path),t||new P.Notice("Already folder note"),!1;let n=this.getFolderPath(e,!1),l=n&&(yield this.vault.exists(n));if(l)return A.default.info("createFolderForNote(%o): target folder to create already exists",e,e.path),t||new P.Notice("Target folder to create already exists"),!1;if(!n)A.default.info("createFolderForNote(%o): no vaild linked folder path for %s",e,e.path),t||new P.Notice("No vaild linked folder path for: "+e.path);else if(!t){yield this.vault.createFolder(n);let o;switch(this.settings.folderNotePref){case u.Index:o=(0,y.join)(n,this.settings.indexName+".md");break;case u.Inside:o=(0,y.join)(n,e.name);break;case u.Outside:o=null;break;default:(0,j.default)(this.settings.folderNotePref)}o&&this.vault.rename(e,o)}return!!(!l&&n)});this.DeleteFolderNote=(e,t=!1)=>{let r=this.getFolderNote(e);return r&&!t&&this.vault.delete(r),!!r};this.CreateFolderNote=(e,t=!1)=>{let r,n;return(r=!this.getFolderNote(e)&&(n=this.getFolderNotePath(e)))&&!t&&this.vault.create(n.path,this.plugin.getNewFolderNote(e)),!!r};this.plugin=e}get settings(){return this.plugin.settings}get vault(){return this.plugin.app.vault}},ve=class extends P.Modal{constructor(e,t,r){super(e.app);this.plugin=e,this.target=t,this.targetFolder=r}get settings(){return this.plugin.settings}deleteFolder(){let{contentEl:e}=this;e.createEl("p",{text:"Warning: the entire folder and its content will be removed",cls:"mod-warning"});let t=this.targetFolder.children.map(n=>n.name);e.createEl("p",{text:t.length>5?t.slice(0,5).join(", ")+"...":t.join(", ")}),e.createEl("p",{text:"Continue?",cls:"mod-warning"});let r=e.createDiv({cls:"modal-button-container"});r.createEl("button",{text:"Yes",cls:"mod-warning"},n=>n.onClickEvent(()=>{this.app.vault.delete(this.targetFolder,!0),this.app.vault.delete(this.target),this.close()})),r.createEl("button",{text:"No"},n=>n.onClickEvent(()=>{this.close()}))}onOpen(){this.containerEl.addClass("warn"),this.deleteFolder()}onClose(){let{contentEl:e}=this;e.empty()}};var b=T(require("obsidian")),D=T(H());var J=class{constructor(e){this.on=(...e)=>this.plugin.app.vault.on(...e);this.delete=(...e)=>this.plugin.app.vault.delete(...e);this.rename=(...e)=>this.plugin.app.fileManager.renameFile(...e);this.registerEvent=()=>{this.plugin.registerEvent(this.on("create",this.onChange)),this.plugin.registerEvent(this.on("rename",this.onChange)),this.plugin.registerEvent(this.on("delete",this.onDelete))};this.onChange=(e,t)=>{var a,c,F;let{getFolderNote:r,getFolderFromNote:n,getFolderNotePath:l}=this.finder;function o(d){return d instanceof b.TFolder?t?r(t):null:d instanceof b.TFile&&t&&L(t)?n(t):null}function s(d){return d instanceof b.TFolder?r(d):d instanceof b.TFile?n(d):null}if(t&&e instanceof b.TFile&&L(t)!==L(e)){let d=o(e);if(d)this.plugin.trigger("folder-note:delete",e,d);else{let N=n(e);N&&this.plugin.trigger("folder-note:create",e,N)}}else{let d=!1,N;$(e,g=>{N=s(g),N&&(d=!0,this.plugin.trigger("folder-note:create",g,N))},g=>{N=s(g),N&&(d=!0,this.plugin.trigger("folder-note:create",N,g))});let C=o(e);if(!C)return;let f=e instanceof b.TFolder?(c=(a=l(e))==null?void 0:a.path)!=null?c:"":e instanceof b.TFile&&(F=me(C,e.basename))!=null?F:"";if(this.shouldRename(e,t))if(!d&&f){this.rename(C,f),$(e,g=>this.plugin.trigger("folder-note:rename",[g,t],[C,f]),g=>this.plugin.trigger("folder-note:rename",[C,f],[g,t]));return}else{let g=C instanceof b.TFile?"folder note":"linked folder",v=`Failed to sync name of ${g}: `,m=d?`${g} ${(0,D.basename)(f)} already exists`:"check console for more details";new b.Notice(v+m)}$(e,g=>this.plugin.trigger("folder-note:delete",g,C),g=>this.plugin.trigger("folder-note:delete",C,g))}};this.onDelete=e=>{let{getFolderNote:t,getFolderFromNote:r}=this.finder;if(e instanceof b.TFolder){let n=t(e);if(!(this.settings.folderNotePref===u.Outside&&n))return;this.settings.deleteOutsideNoteWithFolder?this.delete(n):this.plugin.trigger("folder-note:delete",n,e)}else if(e instanceof b.TFile&&L(e)){let n=r(e);n&&this.plugin.trigger("folder-note:delete",e,n)}};this.plugin=e}get settings(){return this.plugin.settings}get finder(){return this.plugin.resolver}shouldRename(e,t){if(!this.settings.autoRename||!t)return!1;let r=this.settings.folderNotePref!==u.Index&&(0,D.dirname)(e.path)===(0,D.dirname)(t),n=e instanceof b.TFolder&&this.settings.folderNotePref===u.Outside&&(0,D.dirname)(e.path)!==(0,D.dirname)(t);return r||n}};var K=T(R()),p=T(require("obsidian"));var Ne={folderNotePref:u.Inside,deleteOutsideNoteWithFolder:!1,indexName:"_about_",autoRename:!0,folderNoteTemplate:"# {{FOLDER_NAME}}",logLevel:4},Q={[u.Index]:"Inside Folder, Index File",[u.Inside]:"Inside Folder, With Same Name",[u.Outside]:"Outside Folder, With Same Name"},Z=class extends p.PluginSettingTab{constructor(e){super(e.app,e);this.plugin=e;this.renderCoreSettings=e=>{this.setStrategy(e),this.plugin.settings.folderNotePref===u.Index?this.setIndexName(e):this.plugin.settings.folderNotePref===u.Outside&&this.setDeleteWithFolder(e),this.setTemplate(e),this.plugin.settings.folderNotePref!==u.Index&&this.setAutoRename(e)};this.setLogLevel=e=>{new p.Setting(e).setName("Log Level of folder-note-core").setDesc("Change this options if debug is required").addDropdown(t=>t.then(r=>Object.entries(K.default.levels).forEach(([n,l])=>r.addOption(l.toString(),n))).setValue(K.default.getLevel().toString()).onChange(r=>w(this,null,function*(){let n=+r;K.default.setLevel(n),this.plugin.settings.logLevel=n,yield this.plugin.saveSettings()})))};this.setDeleteWithFolder=e=>{new p.Setting(e).setName("Delete Outside Note with Folder").setDesc(createFragment(t=>{t.appendText("Delete folder note outside when folder is deleted"),t.createDiv({text:"Warning: The note will be deleted when the folder is moved outside of vault",cls:"mod-warning"})})).addToggle(t=>t.setValue(this.plugin.settings.deleteOutsideNoteWithFolder).onChange(r=>w(this,null,function*(){this.plugin.settings.deleteOutsideNoteWithFolder=r,yield this.plugin.saveSettings()})))};this.setStrategy=e=>{new p.Setting(e).setName("Note File Storage Strategy").setDesc(createFragment(t=>{t.appendText("Select how you would like the folder note to be stored"),t.createEl("br"),t.createEl("a",{href:"https://github.com/aidenlx/alx-folder-note/wiki/folder-note-pref",text:"Check here"}),t.appendText(" for more detail for pros and cons for different strategies")})).addDropdown(t=>{t.addOptions(Q).setValue(this.plugin.settings.folderNotePref.toString()).onChange(r=>w(this,null,function*(){this.plugin.settings.folderNotePref=+r,this.plugin.trigger("folder-note:cfg-changed"),yield this.plugin.saveSettings()}))}),new p.Setting(e).setName("Switch Strategy").setDesc(createFragment(t=>{t.appendText("Batch convert existing folder notes to use new storage strategy"),t.createDiv({text:"Warning: This function is experimental and dangerous, make sure to fully backup the vault before the conversion",cls:"mod-warning"})})).addButton(t=>t.setTooltip("Open Dialog").setIcon("popup-open").setCta().onClick(()=>new we(this.plugin).open()))};this.setIndexName=e=>{new p.Setting(e).setName("Name for Index File").setDesc("Set the note name to be recognized as index file for folders").addText(t=>{let r=n=>w(this,null,function*(){this.plugin.settings.indexName=n,this.plugin.trigger("folder-note:cfg-changed"),yield this.plugin.saveSettings()});t.setValue(this.plugin.settings.indexName).onChange((0,p.debounce)(r,500,!0))})};this.setTemplate=e=>{new p.Setting(e).setName("Folder Note Template").setDesc(createFragment(t=>{t.appendText("The template used to generate new folder note."),t.appendChild(document.createElement("br")),t.appendText("Supported placeholders:"),t.appendChild(document.createElement("br")),t.appendText("{{FOLDER_NAME}} {{FOLDER_PATH}}")})).addTextArea(t=>{let r=n=>w(this,null,function*(){this.plugin.settings.folderNoteTemplate=n,yield this.plugin.saveSettings()});t.setValue(this.plugin.settings.folderNoteTemplate).onChange((0,p.debounce)(r,500,!0)),t.inputEl.rows=8,t.inputEl.cols=30})};this.setAutoRename=e=>{new p.Setting(e).setName("Auto Sync").setDesc("Keep name and location of folder note and folder in sync").addToggle(t=>{t.setValue(this.plugin.settings.autoRename),t.onChange(r=>w(this,null,function*(){this.plugin.settings.autoRename=r,yield this.plugin.saveSettings()}))})}}display(){let{containerEl:e}=this;e.empty(),this.renderCoreSettings(e),this.setLogLevel(e)}},we=class extends p.Modal{constructor(e){super(e.app);this.plugin=e;this.Convert=(e=!1)=>w(this,null,function*(){let{From:t,To:r}=this;if(this.clear(),t===null||r===null)new p.Notice("Please select the strategies to convert from/to first");else if(t===r)new p.Notice("Convert between same strategy, skipping...");else{let{getFolderNote:n,getFolderNotePath:l}=this.plugin.resolver,o=this.app.vault.getAllLoadedFiles().filter(a=>a instanceof p.TFolder&&!a.isRoot()).map(a=>{let c=n(a,t),F=c?l(a,r):null;return c&&F?[c,F]:null}),s=!1;for(let a of o){if(!a)continue;let[c,F]=a;(yield this.app.vault.exists(F.path))?(s||(s=!0),this.log(`Unable to move file ${c.path}: file exist in ${F.path}`)):e||this.app.fileManager.renameFile(c,F.path)}s||(e?this.log("Check complete, no conflict found"):this.log("Batch convert complete"))}});this.fromOptsEl=new p.DropdownComponent(this.titleEl.createDiv({text:"From:  "})).addOptions(Q),this.toOptsEl=new p.DropdownComponent(this.titleEl.createDiv({text:"To:  "})).addOptions(Q),this.outputEl=new p.TextAreaComponent(this.contentEl).setValue("Hello world").setDisabled(!0).then(t=>{t.inputEl.style.width="100%",t.inputEl.rows=10}),this.buttonContainerEl=this.modalEl.createDiv({cls:"modal-button-container"}),this.addButton(t=>t.setButtonText("Check Conflicts").onClick(()=>this.Convert(!0))),this.addButton(t=>t.setButtonText("Convert").setWarning().onClick(()=>this.Convert())),this.addButton(t=>t.setButtonText("Cancel").onClick(this.close.bind(this)))}addButton(e){let t=new p.ButtonComponent(this.buttonContainerEl);return e(t),t}log(e){this.outputEl.setValue(this.outputEl.getValue()+`
`+e)}clear(){this.outputEl.setValue("")}get From(){let e=this.fromOptsEl.getValue();return e&&u[+e]?+e:null}get To(){let e=this.toOptsEl.getValue();return e&&u[+e]?+e:null}onOpen(){this.clear();let e=this.plugin.settings.folderNotePref.toString();this.fromOptsEl.setValue(e),this.toOptsEl.setValue(e)}};var Se="alx-folder-note",te="FolderNoteAPIv0",re=class extends be.Plugin{constructor(e,t){super(e,t);this.settings=Ne;this.vaultHandler=new J(this);this.settingTab=new Z(this);this.getNewFolderNote=e=>this.settings.folderNoteTemplate.replace(/{{FOLDER_NAME}}/g,e.name).replace(/{{FOLDER_PATH}}/g,e.path);ee.default.setDefaultLevel("ERROR");let r=new G(this);this.resolver=r;let n=this;this.api={get renderCoreSettings(){return n.settingTab.renderCoreSettings},get renderLogLevel(){return n.settingTab.setLogLevel},importSettings:l=>{if(l.folderNotePref!==void 0){switch(l.folderNotePref){case 0:l.folderNotePref=u.Index;break;case 1:l.folderNotePref=u.Inside;break;case 2:l.folderNotePref=u.Outside;break;default:break}let o=Object.fromEntries(Object.entries(l).filter(([s,a])=>a!==void 0));this.settings=M(M({},this.settings),o),this.saveSettings()}},get getNewFolderNote(){return n.getNewFolderNote},get getFolderFromNote(){return r.getFolderFromNote},get getFolderPath(){return r.getFolderPath},get getFolderNote(){return r.getFolderNote},get getFolderNotePath(){return r.getFolderNotePath},get DeleteLinkedFolder(){return r.DeleteLinkedFolder},get LinkToParentFolder(){return r.LinkToParentFolder},get DeleteNoteAndLinkedFolder(){return r.DeleteNoteAndLinkedFolder},get createFolderForNote(){return r.createFolderForNote},get DeleteFolderNote(){return r.DeleteFolderNote},get CreateFolderNote(){return r.CreateFolderNote}},(window[te]=this.api)&&this.register(()=>window[te]=void 0),this.trigger("folder-note:api-ready",this.api),this.register(ue(e.fileManager,{getNewFileParent(l){return function(o){if(e.vault.getConfig("newFileLocation")==="current"){let s=n.settings.folderNotePref;switch(s){case u.Index:case u.Inside:break;case u.Outside:{let a=n.resolver.getFolderFromNote(o);if(a)return a;break}default:(0,Te.default)(s)}}return l.call(e.fileManager,o)}}}))}onload(){return w(this,null,function*(){ee.default.info("loading folder-note-core"),yield this.loadSettings(),this.app.plugins.enabledPlugins.has(Se)||this.addSettingTab(this.settingTab),ge(this),ce(this),this.vaultHandler.registerEvent()})}trigger(...e){let[t,...r]=e;this.app.vault.trigger(t,...r)}loadSettings(){return w(this,null,function*(){this.settings=M(M({},this.settings),yield this.loadData())})}saveSettings(){return w(this,null,function*(){yield this.saveData(this.settings)})}};
